System.register("chunks:///_virtual/AnimationUtils.ts",["cc"],(function(t){var e,o,i,n,a,s,l,r,d,c,y;return{setters:[function(t){e=t.cclegacy,o=t.instantiate,i=t.Layers,n=t.v3,a=t.tween,s=t.Node,l=t.UIOpacity,r=t.Sprite,d=t.assetManager,c=t.SpriteFrame,y=t.Vec3}],execute:function(){e._RF.push({},"a1b2cPU5fZ4kBI0VniQq83v","AnimationUtils",void 0);t("AnimationUtils",class{static playParticle(t,e,s,l,r){let d=o(t);d.active=!0,l.addChild(d),d.layer=i.Enum.UI_2D;let c=e.getWorldPosition(),y=s.getWorldPosition(),p=n(c.x,c.y+200,c.z);d.setWorldPosition(c),a(d).to(.5,{worldPosition:y},{onUpdate:(t,e)=>{let o=n(),i=(n(),e),a=c,s=p,l=y;o.x=(1-i)*(1-i)*a.x+2*i*(1-i)*s.x+i*i*l.x,o.y=(1-i)*(1-i)*a.y+2*i*(1-i)*s.y+i*i*l.y,d.setWorldPosition(o)}}).call((()=>{d.destroy(),r&&r()})).start()}static playImage(t,e,o,p,m,g="up"){var _;Log.d(`[AnimationUtils] playImage called with: fromNode=${e.name}, toNode=${o.name}, parentNode=${p.name}, curveType=${g}`);let f=new s("FlyEffectNode");f.layer=i.Enum.UI_2D;let x=f.addComponent(l),u=f.addComponent(r);const v=null==(_=d.getBundle(t))?void 0:_.get("cocos_lizi/fly/sybres_eft_str_02/spriteFrame",c);if(!v)return void Log.e("[AnimationUtils] Failed to get spriteFrame: cocos_lizi/fly/sybres_eft_str_02/spriteFrame");u.spriteFrame=v,f.active=!0,p.addChild(f),Log.d(`[AnimationUtils] Image node "${f.name}" added to parent "${p.name}"`);let P,U=e.getWorldPosition(),$=o.getWorldPosition();if("down"===g){const t=.3*($.x-U.x),e=-200;P=n(U.x+t,U.y+e,U.z)}else P=n(U.x,U.y+500,U.z);f.setWorldPosition(U),f.setScale(2,2,1),Log.d(`[AnimationUtils] Node properties: name=${f.name}, active=${f.active}, position=${f.position.toString()}, worldPosition=${f.getWorldPosition().toString()}, scale=${f.scale.toString()}, opacity=${x.opacity}, layer=${f.layer}, controlPosition=${P.toString()}`),a(f).to(1,{worldPosition:$},{onUpdate:(t,e)=>{let o=n(),i=e,a=U,s=P,l=$;o.x=(1-i)*(1-i)*a.x+2*i*(1-i)*s.x+i*i*l.x,o.y=(1-i)*(1-i)*a.y+2*i*(1-i)*s.y+i*i*l.y,f.setWorldPosition(o)}}).call((()=>{var e;Log.d(`[AnimationUtils] Tween completed for node "${f.name}". Starting explosion effect.`);const o=null==(e=d.getBundle(t))?void 0:e.get("cocos_lizi/fly/sybres_eft_exp_04/spriteFrame",c);o?(u.spriteFrame=o,a(f).to(.3,{scale:new y(8,8,1)}).start(),a(x).to(.1,{opacity:0}).call((()=>{f.destroy()})).start(),m&&m()):(Log.e("[AnimationUtils] Failed to get explosion spriteFrame: cocos_lizi/fly/sybres_eft_exp_04/spriteFrame"),f.destroy(),m&&m())})).start()}}),e._RF.pop()}}}));

System.register("chunks:///_virtual/AutoSpinManager.ts",["cc","./MoneyComingConfig.ts"],(function(t){var i,n;return{setters:[function(t){i=t.cclegacy},function(t){n=t.MoneyComingConfig}],execute:function(){i._RF.push({},"8ce07uPsxlJb7xsHPD9+61r","AutoSpinManager",void 0);t("AutoSpinManager",class{constructor(t,i,n){this.view=void 0,this.uiManager=void 0,this._isAutoSpin=!1,this._autoSpinRemaining=0,this._onSpinCallback=void 0,this.view=t,this.uiManager=i,this._onSpinCallback=n}get isAutoSpin(){return this._isAutoSpin}start(){this._isAutoSpin||(this._isAutoSpin=!0,this._autoSpinRemaining=n.autoSpin.totalSpins,this.updateButtonLabel(),this.setControlsInteractive(!1),this._onSpinCallback())}stop(){this._isAutoSpin&&(this._isAutoSpin=!1,this._autoSpinRemaining=0,this.view.unschedule(this._onSpinCallback),this.updateButtonLabel(),this.setControlsInteractive(!0))}onSpinCycleComplete(){return this._isAutoSpin&&this._autoSpinRemaining>0?(this._autoSpinRemaining--,this.updateButtonLabel(),this._autoSpinRemaining>0||(this.stop(),!1)):(this._isAutoSpin&&this.stop(),!1)}scheduleNextSpin(t){if(!this._isAutoSpin)return;let i=n.autoSpin.intervals.normal;1===t?i=n.autoSpin.intervals.turbo:2===t&&(i=n.autoSpin.intervals.superTurbo),this.view.scheduleOnce((()=>{this._isAutoSpin&&this._onSpinCallback()}),i)}updateButtonLabel(){this._isAutoSpin&&this._autoSpinRemaining>0?this.uiManager.updateAutoButtonLabel(`${this._autoSpinRemaining}`):this.uiManager.updateAutoButtonLabel("AUTO")}setControlsInteractive(t){this.uiManager.setSpinButtonState(t),this.uiManager.setBetButtonState(t)}}),i._RF.pop()}}}));

System.register("chunks:///_virtual/BetManager.ts",["cc","./MoneyComingConfig.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.MoneyComingConfig}],execute:function(){e._RF.push({},"08f637T7F1JRbcWjnOG2i9+","BetManager",void 0);t("BetManager",class{constructor(t){this._betAmount=10,this.wheels=void 0,this.wheels=t}get betAmount(){return this._betAmount}set betAmount(t){this._betAmount=t}generateSpinResults(){const t=[n.constants.elementPrefix+"0",n.constants.elementPrefix+"00",n.constants.elementPrefix+"1",n.constants.elementPrefix+"5",n.constants.elementPrefix+"10"],e=[],s=1===this._betAmount?2:3;for(let a=0;a<s;a++)e.push(Math.random()<n.gameplay.symbolProbability?t[Math.floor(Math.random()*t.length)]:"");1===this._betAmount&&e.push("");const a=this.getAvailableFeatureElements();return e.push(Math.random()<n.gameplay.symbolProbability?a[Math.floor(Math.random()*a.length)]:""),e}getAvailableFeatureElements(){const t=[n.constants.featureMultiplierPrefix+"2",n.constants.featureMultiplierPrefix+"5",n.constants.featureAllRespinKeyword];return 1===this._betAmount?t:5===this._betAmount?t.concat([n.constants.featureScatterKeyword]):10===this._betAmount?t.concat([n.constants.featureMultiplierPrefix+"10",n.constants.featureScatterKeyword]):50===this._betAmount||100===this._betAmount?t.concat([n.constants.featureScatterKeyword+"_50_100"]):t}updateFeatureWheelVisibility(){if(this.wheels.length>=4){const t=this.wheels[3],e=this.getAvailableFeatureElements();t.setVisibleElements(e)}}}),e._RF.pop()}}}));

System.register("chunks:///_virtual/BetSelectionView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameView.ts","./Decorators.ts"],(function(t){var e,o,n,i,c,r,l,s,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.initializerDefineProperty},function(t){n=t.cclegacy,i=t._decorator,c=t.Button,r=t.Node,l=t.Color},function(t){s=t.default},function(t){u=t.inject}],execute:function(){var a,p,h,d,f;n._RF.push({},"367428IvKVKupn8TZwbZ72S","BetSelectionView",void 0);const{ccclass:g,property:y}=i;t("default",(a=g("BetSelectionView"),p=u({type:"moneyComing",name:"logic"}),a((f=e((d=class extends s{constructor(...t){super(...t),o(this,"logic",f,this)}onLoad(){const t=[100,50,10,5,1];for(const e of t){const t=this.node.getChildByPath(`hLayout/betOptionLayout/betOption${e}`);if(t){const o=t.getComponentInChildren(c);o&&this.onN(o.node,r.EventType.TOUCH_END,(()=>this.onBetAmountClick(e)))}}}highlightBet(t){const e=[100,50,10,5,1];for(const o of e){const e=this.node.getChildByPath(`hLayout/betOptionLayout/betOption${o}`);if(e){const n=e.getComponentInChildren(c);n&&(n.normalColor=o===t?new l(150,150,150,255):new l(50,50,50,255))}}}onBetAmountClick(t){this.logic&&this.logic.onBetAmountSelected(t)}}).prototype,"logic",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=d))||h));n._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelManager.ts",["cc","./MoneyComingConfig.ts","./LuckyWheelRotator.ts"],(function(e){var t,n,o,i,l,s,r;return{setters:[function(e){t=e.cclegacy,n=e.tween,o=e.Vec3,i=e.Tween,l=e.sp},function(e){s=e.MoneyComingConfig},function(e){r=e.LuckyWheelRotator}],execute:function(){t._RF.push({},"a9b8cfW5fQyEP7cuph2VDIR","LuckyWheelManager",void 0);e("LuckyWheelManager",class{constructor(e,t){this.view=void 0,this.luckyWheels=void 0,this._isSpinning=!1,this._onCompleteCallback=null,this._currentMoneyNode=null,this._currentMoneyBgNode=null,this._currentWheelNode=null,this._currentBetAmount=1,this.view=e,this.luckyWheels=t}setCurrentBetAmount(e){this._currentBetAmount=e}spin(e,t){if(this._isSpinning)return void Log.w("[LuckyWheelManager] 幸运轮盘正在转动中");this._isSpinning=!0,this._onCompleteCallback=t;const n=this.getPrizesForBet(e);if(!n||0===n.length)return Log.e(`[LuckyWheelManager] 找不到 bet${e} 对应的奖金列表`),void(this._isSpinning=!1);const o=Math.floor(Math.random()*n.length),i=n[o];Log.d(`[LuckyWheelManager] Bet${e}, 奖金数组: [${n.join(", ")}]`),Log.d(`[LuckyWheelManager] 选中奖金索引: ${o}, 金额: ${i}`);const l=this.getWheelNodeForBet(e);if(!l)return Log.e(`[LuckyWheelManager] 找不到 bet${e} 对应的轮盘节点`),void(this._isSpinning=!1);const s=this.getMoneyNodeForBet(e,l),r=this.getMoneyBgNodeForBet(e,l);if(!s||!r)return Log.e(`[LuckyWheelManager] 找不到 money 或 money_bg 节点, betAmount=${e}, moneyNode=${!!s}, moneyBgNode=${!!r}`),void(this._isSpinning=!1);this._currentMoneyNode=s,this._currentMoneyBgNode=r,this._currentWheelNode=l,this.stopAutoRotation(s),this.stopAutoRotation(r);const h=s.eulerAngles.z;r.setRotationFromEuler(0,0,h),Log.d(`[LuckyWheelManager] 同步角度：moneyNode=${h.toFixed(2)}°, moneyBgNode已同步`),this.playChildAnimation(l,"wheel","common_run_start",!1),this.spinToTarget(s,r,o,i)}getPrizesForBet(e){return s.luckyWheelPrizes[e]}getWheelNodeForBet(e){return 1===e||5===e||10===e?this.luckyWheels.getChildByPath("wheel1_5_10"):50===e||100===e?this.luckyWheels.getChildByPath("wheel50_100"):null}getMoneyNodeForBet(e,t){return 1===e||5===e||50===e?t.getChildByName("money"):10===e||100===e?t.getChildByName("money_upgrade"):null}getMoneyBgNodeForBet(e,t){return t.getChildByName("money_bg")}stopAutoRotation(e){const t=e.getComponent(r);t&&t.stopRotation()}resumeAutoRotation(e){const t=e.getComponent(r);t&&t.startRotation()}spinToTarget(e,t,n,o){const i=s.luckyWheel,l=(8-n)%8,r=-l*i.anglePerPrize,h=e.eulerAngles.z;let a=r-h;a>0&&(a-=360);const u=h-9e3+a;Log.d(`[LuckyWheelManager] prizeIndex: ${n}, prize: ${o}, reversedIndex: ${l}`),Log.d(`[LuckyWheelManager] 当前角度: ${h.toFixed(2)}, 目标角度: ${r}, angleDiff: ${a.toFixed(2)}, 最终角度: ${u.toFixed(2)}`);let c=!1,g=!1;const y=()=>{if(!c||!g)return;this._isSpinning=!1,this._currentWheelNode&&(this.playChildAnimation(this._currentWheelNode,"wheel","common_run_cycle",!0),this._currentMoneyNode&&this.playChildAnimation(this._currentWheelNode,"target_coin","common_run_cycle",!0));const t=e.eulerAngles.z,i=(t%360+360)%360;Log.d(`[LuckyWheelManager] 转动完成！目标索引: ${n}, 目标金额: ${o}, 最终角度: ${t.toFixed(2)}°, 归一化角度: ${i.toFixed(2)}°`),this._onCompleteCallback&&this._onCompleteCallback(o),this.reset()};this.animateRotation(e,u,i.spinDuration,(()=>{c=!0,y()})),this.animateRotation(t,u,i.spinDuration,(()=>{g=!0,y()}))}animateRotation(e,t,i,l){const r=s.luckyWheel;n(e).to(i,{eulerAngles:new o(0,0,t)},{easing:r.easing}).call((()=>{l&&l()})).start()}stop(){Log.d("[LuckyWheelManager] 停止幸运轮盘转动");[this.luckyWheels.getChildByPath("wheel1_5_10"),this.luckyWheels.getChildByPath("wheel50_100")].forEach((e=>{if(e){this.stopChildAnimation(e,"wheel"),this.stopChildAnimation(e,"target_coin");const t=e.getChildByName("money"),n=e.getChildByName("money_upgrade"),o=e.getChildByName("money_bg");if([t,n,o].forEach((e=>{e&&i.stopAllByTarget(e)})),t){const e=t.eulerAngles.z;o&&o.setRotationFromEuler(0,0,e),this.resumeAutoRotation(t)}n&&this.resumeAutoRotation(n),o&&this.resumeAutoRotation(o)}})),this.reset()}reset(){this._isSpinning=!1,this._onCompleteCallback=null,this._currentMoneyNode=null,this._currentMoneyBgNode=null,this._currentWheelNode=null}stopChildAnimation(e,t){const n=e.getChildByName(t);if(n){const e=n.getComponent(l.Skeleton);e&&(e.clearTracks(),Log.d(`[LuckyWheelManager] 停止子节点动画: ${n.name}`))}}playChildAnimation(e,t,n,o){const i=e.getChildByName(t);if(i){const e=i.getComponent(l.Skeleton);e?(e.setAnimation(0,n,o),Log.d(`[LuckyWheelManager] 播放子节点动画: ${i.name}, 动画名: ${n}`)):Log.d(`[LuckyWheelManager] 子节点 ${t} 上没有 Spine 组件`)}else Log.d(`[LuckyWheelManager] 找不到子节点 ${t}`)}stopWheelAnimation(e){const t=e.getComponent(l.Skeleton);t&&(t.clearTracks(),Log.d(`[LuckyWheelManager] 停止轮盘动画: ${e.name}`))}}),t._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelRotator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MoneyComingConfig.ts","./MoneyComingGameData.ts"],(function(t){var e,o,i,r,n,a,s,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.initializerDefineProperty},function(t){i=t.cclegacy,r=t.Node,n=t._decorator,a=t.Component},function(t){s=t.MoneyComingConfig},function(t){u=t.MoneyComingGameData}],execute:function(){var h,l,c,g,p,d,R,_,f;i._RF.push({},"9a9154b6oJHUq5m4p0dFXLV","LuckyWheelRotator",void 0);const{ccclass:y,property:m}=n;t("LuckyWheelRotator",(h=y("LuckyWheelRotator"),l=m({tooltip:"旋转速度（度/秒）"}),c=m({tooltip:"是否自动开始旋转"}),g=m({type:r,tooltip:"旋转的目标节点，默认为当前节点"}),h((R=e((d=class extends a{constructor(...t){super(...t),o(this,"rotationSpeed",R,this),o(this,"autoStart",_,this),o(this,"targetNode",f,this),this._isRotating=!1,this._currentRotation=0,this._logTimer=0}get data(){return App.dataCenter.get(u)}onLoad(){this.targetNode||(this.targetNode=this.node),this._currentRotation=this.targetNode.eulerAngles.z,this.autoStart&&this.startRotation()}update(t){if(!this._isRotating||!this.targetNode||this.data.betAmount<=1)return;const e=this.rotationSpeed*t;this._currentRotation+=e,this._currentRotation>=360?this._currentRotation-=360:this._currentRotation<0&&(this._currentRotation+=360),this.targetNode.setRotationFromEuler(0,0,this._currentRotation)}logCurrentPrizePosition(){const t=this._currentRotation;let e=10,o=[],i=this.node.parent;for(;i;){if("wheel1_5_10"===i.name){e=10,o=s.luckyWheelPrizes[10]||[];break}if("wheel_50_100"===i.name){e=50,o=s.luckyWheelPrizes[50]||[];break}i=i.parent}if(0===o.length)return;const r=t-s.luckyWheel.startAngleOffset,n=(Math.floor(-r/45)%8+8)%8,a=(8-n)%8,u=o[a];Log.d(`[LuckyWheelRotator] 节点: ${this.node.name}, betAmount: ${e}, 当前角度: ${t.toFixed(2)}°, reversedIndex: ${n}, 12点位置索引: ${a}, 12点位置金额: ${u}`)}startRotation(){this._isRotating=!0}stopRotation(){this._isRotating=!1}setRotationSpeed(t){this.rotationSpeed=t}toggleRotation(){this._isRotating=!this._isRotating}resetRotation(){this._currentRotation=0,this.targetNode&&this.targetNode.setRotationFromEuler(0,0,0)}}).prototype,"rotationSpeed",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),_=e(d.prototype,"autoStart",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=e(d.prototype,"targetNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=d))||p));i._RF.pop()}}}));

System.register("chunks:///_virtual/moneyComing",["./MoneyComingEntry.ts","./MoneyComingAudio.ts","./MoneyComingConfig.ts","./MoneyComingGameData.ts","./MoneyComingLanguage.ts","./LuckyWheelRotator.ts","./MoneyComingAnimationController.ts","./MoneyComingLogic.ts","./Wheel.ts","./AutoSpinManager.ts","./BetManager.ts","./LuckyWheelManager.ts","./RespinManager.ts","./SpinManager.ts","./WinManager.ts","./MoneyComingHandler.ts","./AnimationUtils.ts","./SymbolAnimator.ts","./nodeUtils.ts","./BetSelectionView.ts","./MoneyComingUIManager.ts","./MoneyComingView.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MoneyComingAnimationController.ts",["cc","./MoneyComingConfig.ts"],(function(e){var t,n,o,i,a,l,s,h,d,c;return{setters:[function(e){t=e.cclegacy,n=e.Node,o=e.UITransform,i=e.sp,a=e.assetManager,l=e.Graphics,s=e.Color,h=e.tween,d=e._decorator},function(e){c=e.MoneyComingConfig}],execute:function(){var r;t._RF.push({},"af99dToBmdPkbOKbVM9Tpmx","MoneyComingAnimationController",void 0);const{ccclass:m}=d;e("MoneyComingAnimationController",m("MoneyComingAnimationController")(r=class{constructor(e,t,n,o){this.view=void 0,this.wheels=void 0,this.audioManager=void 0,this.luckyWheels=void 0,this._wheel3LockSpine=null,this._wheel3ShadowMask=null,this._wheel1510LockSpine=null,this.view=e,this.wheels=t,this.audioManager=n,this.luckyWheels=o}playExpectAnimation(e){const t=c.constants.expectAnimNodeName,l=e.parent;if(!l)return void Log.e("[MoneyComingAnimationController] wheelNode 没有父节点");const s=l.parent;if(!s)return void Log.e("[MoneyComingAnimationController] wheels 容器没有父节点");const h=`${t}_${l.children.indexOf(e)}`;if(s.getChildByName(h))return;const d=new n(h);s.addChild(d);const r=e.getWorldPosition();d.setWorldPosition(r),d.setScale(1,.95);const m=s.getChildByName("mask");if(m){const e=m.getSiblingIndex();d.setSiblingIndex(e+1)}else d.setSiblingIndex(s.children.length-1);d.layer=e.layer;const w=d.addComponent(o),p=e.getComponent(o);p&&w.setContentSize(p.contentSize);const g=d.addComponent(i.Skeleton);g.premultipliedAlpha=!0;const k=a.getBundle(c.constants.bundleName);if(!k)return Log.e(`[MoneyComingAnimationController] 无法获取 bundle: ${c.constants.bundleName}`),void d.destroy();k.load(c.animations.expect.path,i.SkeletonData,((e,t)=>{if(e||!g.isValid)return Log.e("[MoneyComingAnimationController] 加载 expect spine 资源失败",e),void d.destroy();g.skeletonData=t,g.setAnimation(0,c.animations.expect.name,!0)}))}stopExpectAnimation(e){const t=e.parent;if(!t)return;const n=t.parent;if(!n)return;const o=t.children.indexOf(e),i=`${c.constants.expectAnimNodeName}_${o}`,a=n.getChildByName(i);a&&a.destroy()}initializeWheel3LockState(){Log.d("[MoneyComingAnimationController] 初始化第三个轮子锁定状态");const e=a.getBundle(c.constants.bundleName);e?e.load(c.animations.wheelLock.path,i.SkeletonData,((e,t)=>{if(e)return void Log.e("[MoneyComingAnimationController] 加载 wheel_lock spine 资源失败",e);const n=this.getOrCreateWheel3LockSpine();n&&(n.skeletonData=t,n.node.active=!0,n.setAnimation(0,c.animations.wheelLock.stand,!0),this.showWheel3ShadowMask())})):Log.e(`[MoneyComingAnimationController] 无法获取 bundle: ${c.constants.bundleName}`)}playWheel3LockAnimation(){Log.d("[MoneyComingAnimationController] 播放第三个轮子锁定动画");const e=a.getBundle(c.constants.bundleName);e&&e.load(c.animations.wheelLock.path,i.SkeletonData,((e,t)=>{if(e)return;const n=this.getOrCreateWheel3LockSpine();if(!n)return;n.skeletonData=t,n.node.active=!0;const o=n.setAnimation(0,c.animations.wheelLock.lock,!1);o&&(this.audioManager.playEffect(c.audio.wheelLock),this.showWheel3ShadowMask(),o.listener={complete:()=>{n.setAnimation(0,c.animations.wheelLock.stand,!0),o.listener=null}})}))}playWheel3UnlockAnimation(){Log.d("[MoneyComingAnimationController] 播放第三个轮子解锁动画");const e=this._wheel3LockSpine;if(!e||!e.isValid)return;const t=e.setAnimation(0,c.animations.wheelLock.unlock,!1);t?(this.hideWheel3ShadowMask(),t.listener={complete:()=>{const n=e.node;n&&n.isValid&&n.destroy(),this._wheel3LockSpine=null,t.listener=null}}):e.node.active=!1}initializeWheel1510LockState(){const e=this.luckyWheels.getChildByPath("wheel1_5_10");if(!e)return;const t=a.getBundle(c.constants.bundleName);t&&t.load(c.animations.wheel1510Lock.path,i.SkeletonData,((t,n)=>{if(t)return;const o=this.getOrCreateWheel1510LockSpine(e);o&&(o.skeletonData=n,o.node.active=!0,o.setAnimation(0,c.animations.wheel1510Lock.stand,!0))}))}playWheel1510LockAnimation(){const e=this.luckyWheels.getChildByPath("wheel1_5_10");if(!e)return;const t=a.getBundle(c.constants.bundleName);t&&t.load(c.animations.wheel1510Lock.path,i.SkeletonData,((t,n)=>{if(t)return;const o=this.getOrCreateWheel1510LockSpine(e);if(!o)return;o.skeletonData=n,o.node.active=!0;const i=o.setAnimation(0,c.animations.wheel1510Lock.lock,!1);i&&(this.audioManager.playEffect(c.audio.wheelLock),i.listener={complete:()=>{o.setAnimation(0,c.animations.wheel1510Lock.stand,!0),i.listener=null}})}))}playWheel1510UnlockAnimation(){const e=this._wheel1510LockSpine;if(!e||!e.isValid)return;const t=e.setAnimation(0,c.animations.wheel1510Lock.unlock,!1);t?t.listener={complete:()=>{const n=e.node;n&&n.isValid&&n.destroy(),this._wheel1510LockSpine=null,t.listener=null}}:e.node.active=!1}getOrCreateWheel3LockSpine(){if(this._wheel3LockSpine&&this._wheel3LockSpine.isValid)return this._wheel3LockSpine;if(this.wheels.length<3)return null;const e=this.wheels[2].node;let t=e.getChildByName(c.constants.wheelLockNodeName);t||(t=new n(c.constants.wheelLockNodeName),e.addChild(t),t.setPosition(0,0,0),t.setSiblingIndex(e.children.length-1)),t.layer=e.layer,t.active=!0;let a=t.getComponent(o)||t.addComponent(o);const l=e.getComponent(o);return l&&a.setContentSize(l.width,l.height),this._wheel3LockSpine=t.getComponent(i.Skeleton)||t.addComponent(i.Skeleton),this._wheel3LockSpine}getOrCreateWheel3ShadowMask(){var e;if(this._wheel3ShadowMask&&this._wheel3ShadowMask.isValid)return this._wheel3ShadowMask;if(this.wheels.length<3)return null;const t=this.wheels[2],i=t.node;let a=i.getChildByName(c.constants.wheelShadowMaskNodeName);a||(a=new n(c.constants.wheelShadowMaskNodeName),i.addChild(a)),a.setPosition(-7,0,0),a.layer=i.layer;let h=a.getComponent(o)||a.addComponent(o);const d=null==(e=t.symbolContainer)?void 0:e.getComponent(o),r=d?d.width:200,m=t.containerHeight>0?t.containerHeight:400;h.setAnchorPoint(.5,.5),h.setContentSize(r,m);let w=a.getComponent(l)||a.addComponent(l);w.clear();const p=c.gameplay.wheel3Shadow.targetOpacity;return w.fillColor=new s(0,0,0,p),w.rect(.5*-r,.5*-m,r,m),w.fill(),a.active=!1,this._wheel3ShadowMask=a,this.updateShadowMaskSiblingIndex(),a}updateShadowMaskSiblingIndex(){if(!this._wheel3ShadowMask||!this._wheel3ShadowMask.isValid)return;const e=this.wheels[2].node,t=this.wheels[2].symbolContainer,n=e.getChildByName(c.constants.wheelLockNodeName);let o=e.children.length-1;n&&(o=Math.max(0,n.getSiblingIndex()-1)),t&&(o=Math.max(t.getSiblingIndex()+1,o)),this._wheel3ShadowMask.setSiblingIndex(o)}showWheel3ShadowMask(){const e=this.getOrCreateWheel3ShadowMask();if(!e)return;e.active=!0,this.updateShadowMaskSiblingIndex();const t=e.getComponent(l);if(t){var n;const e=c.gameplay.wheel3Shadow.targetOpacity,i=null==(n=this.wheels[2].symbolContainer)?void 0:n.getComponent(o),a=i?i.width:200,l=this.wheels[2].containerHeight>0?this.wheels[2].containerHeight:400,d={alpha:0};h(d).to(c.gameplay.wheel3Shadow.fadeInDuration,{alpha:e},{onUpdate:()=>{t.clear(),t.fillColor=new s(0,0,0,d.alpha),t.rect(.5*-a,.5*-l,a,l),t.fill()}}).start()}}hideWheel3ShadowMask(){if(!this._wheel3ShadowMask||!this._wheel3ShadowMask.isValid)return;const e=this._wheel3ShadowMask.getComponent(l);if(e){var t;const n=null==(t=this.wheels[2].symbolContainer)?void 0:t.getComponent(o),i=n?n.width:200,a=this.wheels[2].containerHeight>0?this.wheels[2].containerHeight:400,l={alpha:c.gameplay.wheel3Shadow.targetOpacity};h(l).to(c.gameplay.wheel3Shadow.fadeOutDuration,{alpha:0},{onUpdate:()=>{e.clear(),e.fillColor=new s(0,0,0,l.alpha),e.rect(.5*-i,.5*-a,i,a),e.fill()}}).call((()=>{this._wheel3ShadowMask&&(this._wheel3ShadowMask.active=!1)})).start()}else this._wheel3ShadowMask.active=!1}stopScatterWinAnimationImmediately(e){const t=this.getWheelNodeForBet(e);if(t){const e=t.getChildByName("scatter_win_anim_1");e&&e.destroy();const n=t.getChildByName("scatter_win_anim_2");n&&n.destroy()}}getWheelNodeForBet(e){return 5===e||10===e?this.luckyWheels.getChildByPath("wheel1_5_10"):50===e||100===e?this.luckyWheels.getChildByPath("wheel_50_100"):null}playScatterWinAnimation(e){const t=this.getWheelNodeForBet(e);if(t){const e=c.animations.scatterWinStart;this._playSpineAnimation(t,"scatter_win_anim_1",e.path,e.name,!1)}}stopScatterWinAnimation(e){const t=this.getWheelNodeForBet(e);if(t){const e=c.animations.scatterWinStop;this._playSpineAnimation(t,"scatter_win_anim_1",e.path1,e.cycle1,!0),this._playSpineAnimation(t,"scatter_win_anim_2",e.path2,e.cycle2,!0)}}_playSpineAnimation(e,t,o,l,s){const h=a.getBundle(c.constants.bundleName);h?h.load(o,i.SkeletonData,((a,h)=>{if(a)return void Log.e(`[MoneyComingAnimationController] 加载 spine 资源失败: ${o}`,a);let d=e.getChildByName(t);d||(d=new n(t),e.addChild(d),d.layer=e.layer);let c=d.getComponent(i.Skeleton);c||(c=d.addComponent(i.Skeleton)),c.skeletonData=h,c.premultipliedAlpha=!0,c.setAnimation(0,l,s)})):Log.e(`[MoneyComingAnimationController] 无法获取 bundle: ${c.constants.bundleName}`)}getOrCreateWheel1510LockSpine(e){if(this._wheel1510LockSpine&&this._wheel1510LockSpine.isValid)return this._wheel1510LockSpine;let t=e.getChildByName(c.constants.wheel1510LockNodeName);t||(t=new n(c.constants.wheel1510LockNodeName),e.addChild(t),t.setPosition(0,0,0)),t.layer=e.layer,t.active=!0,t.setSiblingIndex(e.children.length-1);let a=t.getComponent(o)||t.addComponent(o);const l=e.getComponent(o);return l&&a.setContentSize(l.width,l.height),this._wheel1510LockSpine=t.getComponent(i.Skeleton)||t.addComponent(i.Skeleton),this._wheel1510LockSpine.premultipliedAlpha=!0,this._wheel1510LockSpine}})||r);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingAudio.ts",["cc","./MoneyComingConfig.ts"],(function(i){var o,e,n;return{setters:[function(i){o=i.cclegacy,e=i._decorator},function(i){n=i.MoneyComingConfig}],execute:function(){var u;o._RF.push({},"713c3njqOxKq4G7Hm/764M3","MoneyComingAudio",void 0);const{ccclass:t,property:s}=e;i("MoneyComingAudio",t("MoneyComingAudio")(u=class{constructor(i,o){this.audioHelper=void 0,this.bundle=void 0,this.audioHelper=i,this.bundle=o}setAudioHelper(i){this.audioHelper=i}playBgMusic(){this.audioHelper.playMusic("audio/music/bg",!0,this.bundle)}stopBgMusic(){this.audioHelper.stopMusic()}playSpinSound(){}playWinSound(){}playBigWinSound(){this.audioHelper.playEffect(n.audio.bigWin,!1,this.bundle)}playEffect(i){this.audioHelper.playEffect(i,!1,this.bundle)}})||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingConfig.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"5338exe84pD9q1pENATp8vT","MoneyComingConfig",void 0);e("MoneyComingConfig",{autoSpin:{totalSpins:50,intervals:{normal:1,turbo:.5,superTurbo:.2}},sequentialStop:{initialStopDelay:4.5,wheelStopInterval:.2},simultaneousStop:{normal:{scrollDuration:5,stopDuration:.1},turbo:{scrollDuration:3,stopDuration:.1},superTurbo:{scrollDuration:1,stopDuration:.1}},luckyWheelPrizes:{5:[1e3,250,50,150,75,500,25,100],10:[2e3,500,100,300,150,1e3,50,200],50:[5e4,1e4,1e3,5e3,1500,25e3,500,2500],100:[1e5,2e4,2e3,1e4,3e3,5e4,1e3,5e3]},luckyWheel:{spinDuration:6,accelerationDuration:.5,decelerationDuration:1,maxRotationSpeed:720,easing:"cubicOut",anglePerPrize:45,startAngleOffset:0},animations:{wheelLock:{lock:"lock",unlock:"unlock",stand:"stand",path:"spine/lock/wheel_lock"},wheel1510Lock:{lock:"start",unlock:"end",stand:"stand",path:"spine/lock/unlock"},expect:{name:"light01",path:"spine/expect/expect"}},audio:{luckyWheel:"audio/sound/lucky_wheel",activeFeature:"audio/sound/active_feature",wheelLock:"audio/sound/wheel_lock",spinOver:"audio/sound/spin_over",feature:"audio/sound/feature",allRespin:"audio/sound/all_respin",number:"audio/sound/number",bigWin:"audio/sound/big_win",scatterOver:"audio/sound/scatter_over",allRespinScatter:"audio/sound/all_respin_scatter"},gameplay:{winDisplayDuration:.1,symbolProbability:.8,wheel3Shadow:{fadeInDuration:.3,fadeOutDuration:.3,targetOpacity:128},bigWin:{big:1500,mega:3e3,super:5e3}},constants:{elementPrefix:"element_",featureMultiplierPrefix:"feature_x",featureScatterKeyword:"feature_scatter",featureAllRespinKeyword:"feature_all_respin",bundleName:"moneyComing",wheelLockNodeName:"wheel_lock_anim",wheelShadowMaskNodeName:"wheel_shadow_mask",wheel1510LockNodeName:"wheel1510_lock_anim",expectAnimNodeName:"expect_anim"}});o._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingEntry.ts",["cc","./MoneyComingView.ts","./MoneyComingLanguage.ts","./Entry.ts","./MoneyComingHandler.ts","./Decorators.ts","./LobbyService.ts","./Resource.ts","./MoneyComingGameData.ts"],(function(){var e,t,n,o,r,s,a,i,u,c;return{setters:[function(n){e=n.cclegacy,t=n.SpriteFrame},function(e){n=e.default},function(e){o=e.MoneyComingLanguage},function(e){r=e.Entry},function(e){s=e.default},function(e){a=e.registerEntry},function(e){i=e.LobbyService},function(e){u=e.Resource},function(e){c=e.MoneyComingGameData}],execute:function(){var d;e._RF.push({},"23073LxbfZFU6V6j9dCrqdZ","MoneyComingEntry",void 0);a("MoneyComingEntry","moneyComing",n)(d=class extends r{constructor(...e){super(...e),this.language=new o}addNetHandler(){App.handlerManager.get(s)}removeNetHandler(){}loadResources(e){this.loader.getLoadResources=()=>[{dir:"texture/symbol",bundle:this.bundle,type:t},{url:"cocos_lizi/fly/sybres_eft_str_02/spriteFrame",bundle:this.bundle,type:t},{url:"cocos_lizi/fly/sybres_eft_exp_04/spriteFrame",bundle:this.bundle,type:t}],this.loader.onLoadComplete=t=>{t!=u.LoaderError.LOADING&&(t!=u.LoaderError.NO_FOUND_LOAD_RESOURCE?e():App.tips.show("资源加载失败，请重试"))},this.loader.loadResources()}initData(){App.serviceManager.get(i,!0),App.dataCenter.get(c)}pauseMessageQueue(){}resumeMessageQueue(){}});e._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingGameData.ts",["cc","./GameData.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.GameData}],execute:function(){e._RF.push({},"859b3xfCiBMPZ0tNdwU1CN5","MoneyComingGameData",void 0);class a extends n{constructor(...t){super(...t),this._balance=2e3,this._winAmount=0,this._betAmount=1}get balance(){return this._balance}set balance(t){this._balance=t}get winAmount(){return this._winAmount}set winAmount(t){this._winAmount=t}get betAmount(){return this._betAmount}set betAmount(t){this._betAmount=t}clear(){super.clear(),this._balance=2e3,this._winAmount=0,this._betAmount=1}}t("MoneyComingGameData",a),a.module="moneyComing",e._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Handler.ts","./LobbyService.ts","./Decorators.ts"],(function(e){var n,o,t,i,r,c;return{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.initializerDefineProperty},function(e){t=e.cclegacy},function(e){i=e.Handler},function(e){r=e.LobbyService},function(e){c=e.inject}],execute:function(){var a,s,u,l;t._RF.push({},"2095b1rGSNN2YTS+NBrTsdI","MoneyComingHandler",void 0);e("default",(a=c({type:r,name:"service"}),(l=class extends i{constructor(...e){super(...e),o(this,"service",u,this)}onLoad(){super.onLoad()}onSpinResult(e){Log.d("收到转动结果:",e),App.dispatcher.emit("moneyComing:spin_result",e)}onBalanceUpdate(e){Log.d("余额更新:",e),App.dispatcher.emit("moneyComing:balance_update",e)}onJackpot(e){Log.d("中大奖了！",e)}}).module="MoneyComing",u=n((s=l).prototype,"service",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s));t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingLanguage.ts",["cc","./LanguageDelegate.ts"],(function(a){var e,n,g,t;return{setters:[function(a){e=a.cclegacy,n=a.sys},function(a){g=a.injectLanguageData,t=a.LanguageDelegate}],execute:function(){var u,i;e._RF.push({},"ceb21FdALBP27ArgA4rnpyJ","MoneyComingLanguage",void 0);const s={language:n.Language.ENGLISH,data:{spin:"SPIN",balance:"Balance",bet:"Bet",win:"WIN"}},c={language:n.Language.SPANISH,data:{spin:"GIRAR",balance:"Saldo",bet:"Apuesta",win:"GANAR"}},o={language:n.Language.CHINESE,data:{spin:"旋转",balance:"余额",bet:"下注",win:"获胜"}};a("MoneyComingLanguage",g(((i=class extends t{constructor(...a){super(...a),this.bundle="moneyComing"}init(){this.add(s),this.add(c),this.add(o)}}).module="MoneyComing",u=i))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingLogic.ts",["cc","./Logic.ts","./MoneyComingConfig.ts","./MoneyComingAnimationController.ts","./BetManager.ts","./WinManager.ts","./AutoSpinManager.ts","./SpinManager.ts","./RespinManager.ts","./LuckyWheelManager.ts","./AnimationUtils.ts","./MoneyComingGameData.ts"],(function(t){var e,n,i,a,o,s,h,l,u,r,g,p,M,c;return{setters:[function(t){e=t.cclegacy,n=t.find,i=t._decorator},function(t){a=t.Logic},function(t){o=t.MoneyComingConfig},function(t){s=t.MoneyComingAnimationController},function(t){h=t.BetManager},function(t){l=t.WinManager},function(t){u=t.AutoSpinManager},function(t){r=t.SpinManager},function(t){g=t.RespinManager},function(t){p=t.LuckyWheelManager},function(t){M=t.AnimationUtils},function(t){c=t.MoneyComingGameData}],execute:function(){var m;e._RF.push({},"8a6ecDHTtNJiKb83KLCxU+E","MoneyComingLogic",void 0);const{ccclass:S,property:d}=i;t("MoneyComingLogic",S("MoneyComingLogic")(m=class extends a{constructor(...t){super(...t),this._view=null,this.wheels=[],this.uiManager=null,this.audioManager=null,this.luckyWheels=null,this._animationController=null,this.betManager=null,this.winManager=null,this.autoSpinManager=null,this.spinManager=null,this.respinManager=null,this.luckyWheelManager=null}get view(){return this._view}onLoad(t){super.onLoad(t),this.wheels=this.view.getWheels(),this.uiManager=this.view.getUIManager(),this.audioManager=this.view.getAudioManager(),this.luckyWheels=this.view.luckyWheelsNode,this._animationController=new s(this.view,this.wheels,this.audioManager,this.luckyWheels),this.betManager=new h(this.wheels),this.luckyWheelManager=new p(this.view,this.luckyWheels),this.betAmount=1,this.winManager=new l(this.wheels,this.audioManager),this.autoSpinManager=new u(this.view,this.uiManager,(()=>this.onSpinClick())),this.spinManager=new r(this.view,this.wheels,this.audioManager,this.betManager),this.respinManager=new g(this.view,this.wheels,this.audioManager,this.uiManager,this._animationController,this.betManager),this.spinManager.setOnAllWheelsStoppedCallback((t=>this.onAllWheelsStopped(t))),this.respinManager.setOnRespinCompleteCallback(((t,e)=>this.onRespinComplete(t,e))),this.respinManager.setTurboModeStateGetter((()=>this.spinManager.turboModeState)),this.betManager.updateFeatureWheelVisibility(),this.uiManager.updateUnlockLevels(this.betAmount,!1),this.uiManager.highlightSelectedBet(this.betAmount),this._animationController.initializeWheel3LockState(),this._animationController.initializeWheel1510LockState(),Log.d("[MoneyComingLogic] onLoad 完成，初始 betAmount:",this.betAmount)}onBetBtnClick(){this.spinManager.isSpinning||this.uiManager.toggleBetSelection(this.betAmount)}onBetAmountSelected(t){this.winManager.stopWinningAnimations();const e=this.betAmount,n=t;n>e&&this.audioManager.playEffect(o.audio.activeFeature),1!==e&&1===n?(Log.d(`[MoneyComingLogic] 从 bet${e} 切换到 bet1，播放锁定动画`),this._animationController.playWheel3LockAnimation(),this._animationController.playWheel1510LockAnimation()):1===e&&1!==n&&(Log.d(`[MoneyComingLogic] 从 bet1 切换到 bet${n}，播放解锁动画`),this._animationController.playWheel3UnlockAnimation(),this._animationController.playWheel1510UnlockAnimation()),this.betAmount=t,this.uiManager.highlightSelectedBet(t),this.uiManager.hideBetSelection(),this.uiManager.updateUnlockLevels(t),this.betManager.updateFeatureWheelVisibility()}get data(){return App.dataCenter.get(c)}get balance(){return this.data.balance}set balance(t){this.data.balance=t,this.uiManager.updateBalance(t)}get betAmount(){return this.data.betAmount}set betAmount(t){this.data.betAmount=t,this.betManager.betAmount=t,this.uiManager.updateBetAmount(t),this.luckyWheelManager.setCurrentBetAmount(t)}get winAmount(){return this.data.winAmount}set winAmount(t){this.data.winAmount=t,this.uiManager.updateWinAmount(t)}onSpinClick(){this.spinManager.isSpinning||(this.winManager.stopWinningAnimations(),this.luckyWheelManager.stop(),this.uiManager.hideFeaturePanel(),this.uiManager.hideBetSelection(),this.audioManager.playSpinSound(),this.balance<this.betAmount?App.tips.show("余额不足"):this.spinManager.turboModeState>0?this.doTurboSpin():(this.uiManager.setSpinButtonState(!1),this.uiManager.setBetButtonState(!1),this.autoSpinManager.isAutoSpin||this.uiManager.setAutoButtonState(!1),this.balance-=this.betAmount,this.spinManager.startSpin()))}doTurboSpin(){this.uiManager.setSpinButtonState(!1),this.uiManager.setBetButtonState(!1),this.autoSpinManager.isAutoSpin||this.uiManager.setAutoButtonState(!1),this.balance-=this.betAmount,this.spinManager.startTurboSpin()}onAllWheelsStopped(t){var e;if(Log.d(`[MoneyComingLogic] onAllWheelsStopped: 轮盘全部停止，结果: [${t.join(", ")}]`),!this.respinManager.isRespin)if(t[3]===o.constants.featureAllRespinKeyword)this.respinManager.handleAllRespin(t);else if(null!=(e=t[3])&&e.includes(o.constants.featureScatterKeyword)){Log.d("[MoneyComingLogic] onAllWheelsStopped: 触发 Scatter"),this.uiManager.setSpinButtonState(!1),this.uiManager.setBetButtonState(!1),this.autoSpinManager.isAutoSpin||this.uiManager.setAutoButtonState(!1);const e=this.winManager.calculateWinAmount(t,this.betAmount);e>0?this.winManager.playWinningAnimations(t,this.betAmount,this.spinManager.turboModeState):this.winManager.playFeatureAnimation(t[3]),this.uiManager.showFeaturePanel(e,"scatter",this.betAmount),this.playScatterFlyAnimation(this.betAmount,(()=>{Log.d(`[MoneyComingLogic] Scatter 飞行动画完成，准备启动幸运轮盘，betAmount=${this.betAmount}`),this.audioManager.playEffect(o.audio.luckyWheel),this.luckyWheelManager?this.luckyWheelManager.spin(this.betAmount,(t=>{Log.d(`[MoneyComingLogic] onAllWheelsStopped: 幸运轮盘回调，prize=${t}`),this.audioManager.playEffect(o.audio.scatterOver),this.uiManager.updateFeatureBonus(t),this.spinManager.resetSpinState();const n=e+t;n>0?this.onWin(n,void 0,!0):this.onSpinCycleComplete()})):Log.e("[MoneyComingLogic] luckyWheelManager 为 null！无法启动幸运轮盘")}))}else{const e=this.winManager.calculateWinAmount(t,this.betAmount);e>0?this.onWin(e):this.onSpinCycleComplete()}}onRespinComplete(t,e){this.autoSpinManager.isAutoSpin&&this.autoSpinManager.stop(),this.spinManager.resetSpinState(),t>0?this.onWin(t,e):this.onSpinCycleComplete()}onAutoClick(){this.spinManager.isSpinning||(this.autoSpinManager.isAutoSpin?this.autoSpinManager.stop():this.autoSpinManager.start())}onTurboClick(){const t=(this.spinManager.turboModeState+1)%3;this.spinManager.turboModeState=t;let e="OFF";1===t?e="ON":2===t&&(e="SUPER"),App.tips.show(`Turbo Mode: ${e}`),this.uiManager.updateTurboButtonState(t)}onSpinCycleComplete(){Log.d("[MoneyComingLogic] onSpinCycleComplete: 周期完成, isSpinning 将被设为 false"),this.spinManager.resetSpinState(),this.autoSpinManager.onSpinCycleComplete()?this.autoSpinManager.scheduleNextSpin(this.spinManager.turboModeState):(this.uiManager.setSpinButtonState(!0),this.uiManager.setBetButtonState(!0),this.uiManager.setAutoButtonState(!0))}onBalanceUpdate(t){void 0!==t.balance&&(this.balance=t.balance)}onWin(t,e,n=!1){Log.d(`[MoneyComingLogic] onWin: 进入 onWin，金额: ${t}, skipAnimation: ${n}`),this.balance+=t,this.winAmount=t;const i=e||this.spinManager.spinResults;n||this.winManager.playWinningAnimations(i,this.betAmount,this.spinManager.turboModeState);const a=t/this.betAmount,s=o.gameplay.bigWin;let h=null;a>=s.super?h="super":a>=s.mega?h="mega":a>=s.big&&(h="big"),h?(Log.d(`[MoneyComingLogic] onWin: 判断为大奖: ${h}`),this.audioManager.playBigWinSound(),this.uiManager.setSpinButtonState(!1),this.uiManager.setBetButtonState(!1),this.autoSpinManager.isAutoSpin||this.uiManager.setAutoButtonState(!1),this.view.playWinEffect(h,t,(()=>{Log.d("[MoneyComingLogic] onWin: 大奖动画回调触发"),this.onSpinCycleComplete()}))):(Log.d("[MoneyComingLogic] onWin: 判断为普通奖"),this.view.scheduleOnce((()=>{Log.d("[MoneyComingLogic] onWin: 普通奖展示时间结束"),this.onSpinCycleComplete()}),o.gameplay.winDisplayDuration))}playScatterFlyAnimation(t,e){Log.d(`[MoneyComingLogic] playScatterFlyAnimation: betAmount=${t}`);const i=this.wheels[3].node;let a="";1===t||5===t||10===t?a="wheel1_5_10/center":50!==t&&100!==t||(a="wheel50_100/center");const s=this.luckyWheels.getChildByPath(a);if(!s)return Log.e(`[MoneyComingLogic] 找不到目标节点: ${a}`),void(e&&e());let h=this.view.node;const l=n("Canvas");l&&(h=l),Log.d(`[MoneyComingLogic] Scatter fly animation: startNode=${i.name}, endNode=${s.name}, parentNode=${h.name}`),this.audioManager.playEffect(o.audio.allRespinScatter),M.playImage(o.constants.bundleName,i,s,h,(()=>{Log.d("[MoneyComingLogic] Scatter fly animation completed"),e&&e()}),"down")}})||m);e._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingUIManager.ts",["cc","./BetSelectionView.ts","./nodeUtils.ts"],(function(e){var t,o,i,n,a,s,d,l,c,h,r,u;return{setters:[function(e){t=e.cclegacy,o=e.Label,i=e.Node,n=e.UITransform,a=e.sp,s=e.assetManager,d=e.Color,l=e.SpriteFrame,c=e.Sprite,h=e._decorator},function(e){r=e.default},function(e){u=e.NodeUtils}],execute:function(){var b;t._RF.push({},"f88dfHUJjhAA49cK35GzwaK","MoneyComingUIManager",void 0);const{ccclass:g,property:N}=h;e("MoneyComingUIManager",g("MoneyComingUIManager")(b=class{constructor(e,t,o,i,n,a,s,d,l,c,h,r,u,b,g){this.balanceLabel=void 0,this.betAmountLabel=void 0,this.winAmountLabel=void 0,this.spinBtn=void 0,this.autoBtn=void 0,this.fastBtn=void 0,this.betBtn=void 0,this.betSelectionNode=void 0,this.bet1UnlockNode=void 0,this.bet5UnlockNode=void 0,this.bet10UnlockNode=void 0,this.bet50UnlockNode=void 0,this.luckyWheels=void 0,this.brandTextAnimNode=void 0,this.featureNode=void 0,this.balanceLabel=e,this.betAmountLabel=t,this.winAmountLabel=o,this.spinBtn=i,this.autoBtn=n,this.fastBtn=a,this.betBtn=s,this.betSelectionNode=d,this.bet1UnlockNode=l,this.bet5UnlockNode=c,this.bet10UnlockNode=h,this.bet50UnlockNode=r,this.luckyWheels=u,this.brandTextAnimNode=b,this.featureNode=g}updateUnlockLevels(e){this.hideFeaturePanel(),[1,5,10].includes(e)?this.playBrandTextAnimation("down_start","down_cycle"):this.playBrandTextAnimation("up_start","up_cycle"),this.bet1UnlockNode.active=!1,this.bet5UnlockNode.active=!1,this.bet10UnlockNode.active=!1,this.bet50UnlockNode.active=!1;const t=this.luckyWheels.getChildByPath("wheel1_5_10"),o=this.luckyWheels.getChildByPath("wheel50_100"),i=null==t?void 0:t.getChildByName("money"),n=null==t?void 0:t.getChildByName("money_upgrade"),a=null==o?void 0:o.getChildByName("money"),s=null==o?void 0:o.getChildByName("money_upgrade");switch(e){case 1:this.bet1UnlockNode.active=!0,t.active=!0,o.active=!1,u.setNodeOpacity(i,255),u.setNodeOpacity(n,0),this.bet1UnlockNode.setPosition(this.bet1UnlockNode.position.x,-30,this.bet1UnlockNode.position.z),this.bet5UnlockNode.active=!0,this.bet5UnlockNode.setPosition(this.bet5UnlockNode.position.x,30,this.bet5UnlockNode.position.z),Log.d(`[MoneyComingUIManager] Bet1: bet1UnlockNode.active=${this.bet1UnlockNode.active}, bet5UnlockNode.active=${this.bet5UnlockNode.active}`);break;case 5:this.bet5UnlockNode.active=!0,t.active=!0,o.active=!1,u.setNodeOpacity(i,255),u.setNodeOpacity(n,0),this.bet5UnlockNode.setPosition(this.bet5UnlockNode.position.x,-30,this.bet5UnlockNode.position.z),this.bet10UnlockNode.active=!0,this.bet10UnlockNode.setPosition(this.bet10UnlockNode.position.x,30,this.bet10UnlockNode.position.z);break;case 10:this.bet10UnlockNode.active=!0,t.active=!0,o.active=!1,u.setNodeOpacity(i,0),u.setNodeOpacity(n,255),this.bet10UnlockNode.setPosition(this.bet10UnlockNode.position.x,-30,this.bet10UnlockNode.position.z),this.bet50UnlockNode.active=!0,this.bet50UnlockNode.setPosition(this.bet50UnlockNode.position.x,30,this.bet50UnlockNode.position.z);break;case 50:t.active=!1,o.active=!0,u.setNodeOpacity(a,255),u.setNodeOpacity(s,0),this.bet10UnlockNode.active=!0,this.bet10UnlockNode.setPosition(this.bet10UnlockNode.position.x,-30,this.bet10UnlockNode.position.z),this.bet50UnlockNode.active=!0,this.bet50UnlockNode.setPosition(this.bet50UnlockNode.position.x,30,this.bet50UnlockNode.position.z);break;case 100:t.active=!1,o.active=!0,u.setNodeOpacity(a,0),u.setNodeOpacity(s,255),this.bet10UnlockNode.active=!0,this.bet10UnlockNode.setPosition(this.bet10UnlockNode.position.x,-30,this.bet10UnlockNode.position.z),this.bet50UnlockNode.active=!0,this.bet50UnlockNode.setPosition(this.bet50UnlockNode.position.x,30,this.bet50UnlockNode.position.z)}}showFeaturePanel(e,t="all_respin",i=1){var n,a;if(!this.brandTextAnimNode||!this.featureNode)return;Log.d(`[MoneyComingUIManager] showFeaturePanel called. featureType: ${t}, betAmount: ${i}`),Log.d(`[MoneyComingUIManager] Before: text.active=${this.brandTextAnimNode.active}, feature.active=${this.featureNode.active}`),this.brandTextAnimNode.active=!1,this.featureNode.active=!0;const s=this.featureNode.getChildByPath("right");if(s){const e=s.getChildByName("all_respin"),o=s.getChildByName("scatter"),n=s.getChildByName("scatter_50_100");e&&(e.active=!1),o&&(o.active=!1),n&&(n.active=!1),"all_respin"===t&&e?(e.active=!0,Log.d("[MoneyComingUIManager] 激活 all_respin 节点")):"scatter"===t&&([50,100].includes(i)&&n?(n.active=!0,Log.d("[MoneyComingUIManager] 激活 scatter_50_100 节点")):o&&(o.active=!0,Log.d("[MoneyComingUIManager] 激活 scatter 节点")))}const d=null==(n=this.featureNode.getChildByPath("base_value"))?void 0:n.getComponent(o);d&&(d.string=e.toString());const l=null==(a=this.featureNode.getChildByPath("bonus_value"))?void 0:a.getComponent(o);l&&(l.string="0"),Log.d(`[MoneyComingUIManager] After: text.active=${this.brandTextAnimNode.active}, feature.active=${this.featureNode.active}`)}updateFeatureBonus(e){var t;if(!this.featureNode||!this.featureNode.active)return void Log.w("[MoneyComingUIManager] updateFeatureBonus called but featureNode is not active.");const i=null==(t=this.featureNode.getChildByPath("bonus_value"))?void 0:t.getComponent(o);i?(Log.d(`[MoneyComingUIManager] bonusValueLabel found. Current string: "${i.string}", updating to: "${e}"`),i.string=e.toString()):Log.e("[MoneyComingUIManager] Label component not found on node with path 'bonus_value'!")}hideFeaturePanel(){this.brandTextAnimNode&&this.featureNode&&this.featureNode.active&&(Log.d("[MoneyComingUIManager] hideFeaturePanel called."),Log.d(`[MoneyComingUIManager] Before: text.active=${this.brandTextAnimNode.active}, feature.active=${this.featureNode.active}`),this.brandTextAnimNode.active=!0,this.featureNode.active=!1,Log.d(`[MoneyComingUIManager] After: text.active=${this.brandTextAnimNode.active}, feature.active=${this.featureNode.active}`))}playBrandTextAnimation(e,t){if(!this.brandTextAnimNode)return void Log.w("[MoneyComingUIManager] brandTextAnimNode is not available.");let o=this.brandTextAnimNode.getChildByName("payboard_light_anim");o||(o=new i("payboard_light_anim"),this.brandTextAnimNode.addChild(o));o.setSiblingIndex(2),o.layer=this.brandTextAnimNode.layer;let d=o.getComponent(n);d||(d=o.addComponent(n));const l=this.brandTextAnimNode.getComponent(n);l&&d.setContentSize(l.contentSize);let c=o.getComponent(a.Skeleton);c||(c=o.addComponent(a.Skeleton)),c.premultipliedAlpha=!0;const h="spine/payboard_Light/payboard_Light",r=s.getBundle("moneyComing");r?r.load(h,a.SkeletonData,((o,i)=>{if(o||!c||!c.isValid)return void Log.e(`[MoneyComingUIManager] Failed to load skeleton data for ${h}`,o);c.skeletonData=i;c.setAnimation(0,e,!1)?c.setCompleteListener((()=>{c.setAnimation(0,t,!0),c.setCompleteListener(null)})):(Log.w(`[MoneyComingUIManager] Failed to play start animation: ${e}`),c.setAnimation(0,t,!0))})):Log.e("[MoneyComingUIManager] Cannot find bundle: moneyComing")}toggleBetSelection(e){if(this.betSelectionNode&&(this.betSelectionNode.active=!this.betSelectionNode.active,this.betSelectionNode.active)){const t=this.betSelectionNode.getComponent(r);t&&t.highlightBet(e)}}hideBetSelection(){this.betSelectionNode&&(this.betSelectionNode.active=!1)}updateBalance(e){this.balanceLabel&&(this.balanceLabel.string=`${e.toFixed(2)}`)}updateBetAmount(e){this.betAmountLabel&&(this.betAmountLabel.string=`${e}`)}updateWinAmount(e){this.winAmountLabel&&(this.winAmountLabel.string=`${e.toFixed(2)}`)}setSpinButtonState(e){this.spinBtn&&(Log.d(`[MoneyComingUIManager] setSpinButtonState: 设置Spin按钮interactable -> ${e}`),this.spinBtn.interactable=e)}setBetButtonState(e){this.betBtn&&(this.betBtn.interactable=e)}setAutoButtonState(e){this.autoBtn&&(this.autoBtn.interactable=e)}updateAutoButtonLabel(e){if(!this.autoBtn)return;const t=this.autoBtn.node.getChildByName("Label");if(!t)return;const i=t.getComponent(o);if(!i)return;if(/^\d+$/.test(e)){i.string=e,i.fontSize=40,i.lineHeight=40,i.color=new d(0,0,0,255);const o=this.autoBtn.node.getChildByName("icon")||this.autoBtn.node.getChildByName("Sprite");o&&(o.active=!1),t.setPosition(0,0,0)}else{i.string=e,i.fontSize=20,i.lineHeight=20,i.color=new d(255,255,255,255);const o=this.autoBtn.node.getChildByName("icon")||this.autoBtn.node.getChildByName("Sprite");o&&(o.active=!0),t.setPosition(0,-35,0)}}updateTurboButtonState(e){if(!this.fastBtn)return;let t="";if(0===e?t="texture/ui/controls/normal":1===e?t="texture/ui/controls/turbo":2===e&&(t="texture/ui/controls/super_turbo"),!t)return;const o=s.getBundle("moneyComing");o?o.load(`${t}/spriteFrame`,l,((e,o)=>{if(e||!o)return void Log.e(`[MoneyComingUIManager] Failed to load turbo button image: ${t}`,e);const i=this.fastBtn.node.getComponent(c);i?i.spriteFrame=o:Log.w("[MoneyComingUIManager] Sprite component not found on turbo button")})):Log.e("[MoneyComingUIManager] Cannot find moneyComing bundle")}highlightSelectedBet(e){if(this.betSelectionNode){const t=this.betSelectionNode.getComponent(r);t&&t.highlightBet(e)}}})||b);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComingView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MoneyComingLogic.ts","./MoneyComingUIManager.ts","./MoneyComingAudio.ts","./GameView.ts","./Decorators.ts","./Macros.ts","./Wheel.ts","./LuckyWheelRotator.ts","./MoneyComingGameData.ts"],(function(e){var t,n,i,o,l,a,r,s,u,h,c,g,w,b,d,p,y,m,f,C,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty},function(e){i=e.cclegacy,o=e.Label,l=e.Button,a=e.Node,r=e.Sprite,s=e.sp,u=e._decorator,h=e.tween,c=e.UITransform,g=e.Widget},function(e){w=e.MoneyComingLogic},function(e){b=e.MoneyComingUIManager},function(e){d=e.MoneyComingAudio},function(e){p=e.default},function(e){y=e.inject},function(e){m=e.Macro},function(e){f=e.Wheel},function(e){C=e.LuckyWheelRotator},function(e){_=e.MoneyComingGameData}],execute:function(){var k,B,N,M,L,A,S,v,z,U,V,E,T,W,D,H,x,F,O,$,P,R,I,G,j,Q,X,Y,q,J,K,Z,ee,te,ne,ie,oe,le,ae,re,se,ue,he,ce,ge,we,be,de,pe,ye,me,fe,Ce,_e,ke,Be,Ne,Me,Le,Ae;i._RF.push({},"df59bbXLYdNfL78MrQS21r3","MoneyComingView",void 0);const{ccclass:Se}=u;e("default",(k=Se("MoneyComingView"),B=y({type:_.module,name:"logic"}),N=y("control_panel/controls/layout/balance/value",o),M=y("control_panel/controls/layout/bet/value",o),L=y("control_panel/controls/layout/win/value",o),A=y("control_panel/controls/layout/spin",l),S=y("control_panel/controls/layout/auto",l),v=y("control_panel/controls/layout/turbo",l),z=y("control_panel/controls/layout/bet/btn",l),U=y("control_panel/controls/layout/setting",l),V=y("back",a),E=y("wheelsContainer",a),T=y("wheels_container/wheels_layout/wheel_frame/wheels/wheel1",a),W=y("wheels_container/wheels_layout/wheel_frame/wheels/wheel2",a),D=y("wheels_container/wheels_layout/wheel_frame/wheels/wheel3",a),H=y("wheels_container/wheels_layout/wheel_frame/wheels/wheel_feature",a),x=y("control_panel/controls/betSelection",a),F=y("lucky_wheel/wheels",a),O=y("lucky_wheel/brand/board/text/bet1unlock",a),$=y("lucky_wheel/brand/board/text/bet5unlock",a),P=y("lucky_wheel/brand/board/text/bet10unlock",a),R=y("lucky_wheel/brand/board/text/bet50unlock",a),I=y("lucky_wheel/brand/board/text",a),G=y("lucky_wheel/brand/board/feature",a),j=y("bg_sprite",r),Q=y("win_effect",a),X=y("win_effect/win_back",s.Skeleton),Y=y("win_effect/point",s.Skeleton),q=y("win_effect/win_front",s.Skeleton),k(((Ae=class extends p{constructor(...e){super(...e),n(this,"logic",Z,this),n(this,"balanceLabel",ee,this),n(this,"betAmountLabel",te,this),n(this,"winAmountLabel",ne,this),n(this,"spinBtn",ie,this),n(this,"autoBtn",oe,this),n(this,"fastBtn",le,this),n(this,"betBtn",ae,this),n(this,"settingBtn",re,this),n(this,"goBackBtn",se,this),n(this,"wheelsContainer",ue,this),n(this,"wheel1Node",he,this),n(this,"wheel2Node",ce,this),n(this,"wheel3Node",ge,this),n(this,"wheelFeatureNode",we,this),n(this,"betSelectionNode",be,this),n(this,"luckyWheels",de,this),n(this,"bet1UnlockNode",pe,this),n(this,"bet5UnlockNode",ye,this),n(this,"bet10UnlockNode",me,this),n(this,"bet50UnlockNode",fe,this),n(this,"brandTextAnimNode",Ce,this),n(this,"featureNode",_e,this),n(this,"bgSprite",ke,this),n(this,"winEffect",Be,this),n(this,"winBack",Ne,this),n(this,"point",Me,this),n(this,"winFront",Le,this),this.wheels=[],this.uiManager=null,this.audioManager=null}static getPrefabUrl(){return"prefabs/MoneyComingView"}getWheels(){return this.wheels}getUIManager(){return this.uiManager}getAudioManager(){return this.audioManager}get luckyWheelsNode(){return this.luckyWheels}onLoad(){this.initWheels(),this.uiManager=new b(this.balanceLabel,this.betAmountLabel,this.winAmountLabel,this.spinBtn,this.autoBtn,this.fastBtn,this.betBtn,this.betSelectionNode,this.bet1UnlockNode,this.bet5UnlockNode,this.bet10UnlockNode,this.bet50UnlockNode,this.luckyWheels,this.brandTextAnimNode,this.featureNode),this.audioManager=new d(this.audioHelper,this.bundle),super.onLoad(),this.audioManager.setAudioHelper(this.audioHelper),this.uiManager.updateUnlockLevels(this.logic.betAmount),this.betSelectionNode.active=!1,this.audioManager.playBgMusic(),this.setupBackground(),this.bindEvents(),this.initLuckyWheelRotation(),this.uiManager.updateBalance(this.logic.balance),this.uiManager.updateBetAmount(this.logic.betAmount),this.uiManager.updateWinAmount(this.logic.winAmount)}onDestroy(){super.onDestroy()}playWinEffect(e,t,n){if(!this.winEffect)return console.error("MoneyComingView: winEffect node is not assigned or not found."),void(n&&n());this.winEffect.active=!0;const i=this.point.getComponentInChildren(o);if(i){const e={value:1},n=5.5;h(e).to(n,{value:t},{easing:"cubicOut",onUpdate:()=>{i&&i.isValid&&(i.string=e.value.toFixed(2))}}).start()}else console.warn("MoneyComingView: winAmountLabelInPoint (Label) is not assigned. Cannot display win amount in big win effect.");if(!this.winBack||!this.point||!this.winFront)return console.error("MoneyComingView: One or more spine animations (winBack, point, winFront) are not assigned."),void(n&&n());const l=`${e}win_start`,a=`${e}win_cycle`;"mega"!==e&&"super"!==e||this.playChildAnimation(this.winEffect,"win_back",l,!1),this.playChildAnimation(this.winEffect,"point","win_start",!1),this.playChildAnimation(this.winEffect,"win_front",l,!1),this.winBack.setCompleteListener((()=>{this.winBack.setCompleteListener(null),this.playChildAnimation(this.winEffect,"win_back",a,!0),this.playChildAnimation(this.winEffect,"point","win_cycle",!0),this.scheduleOnce((()=>{this.winEffect.active=!1,n&&n()}),5)}))}playChildAnimation(e,t,n,i){const o=e.getChildByName(t);if(!o)return void Log.e(`[MoneyComingView] playChildAnimation: 找不到子节点 ${t}`);const l=o.getComponent(s.Skeleton);l&&l.skeletonData?(l.setAnimation(0,n,i),Log.d(`[MoneyComingView] 正在播放动画: 节点='${t}', 动画='${n}'`)):Log.e(`[MoneyComingView] playChildAnimation: 子节点 ${t} 上没有 Spine 组件或 skeletonData`)}bindEvents(){this.spinBtn&&this.onN(this.spinBtn.node,a.EventType.TOUCH_END,this.onSpinClick),this.autoBtn&&this.onN(this.autoBtn.node,a.EventType.TOUCH_END,this.onAutoClick),this.fastBtn&&this.onN(this.fastBtn.node,a.EventType.TOUCH_END,this.onTurboClick),this.betBtn&&this.onN(this.betBtn.node,a.EventType.TOUCH_END,this.onBetBtnClick),this.settingBtn&&this.onN(this.settingBtn.node,a.EventType.TOUCH_END,this.onSettingClick),this.goBackBtn&&this.onN(this.goBackBtn,a.EventType.TOUCH_END,this.onGoBack),this.onD("moneyComing:balance_update",this.onBalanceUpdate)}initWheels(){this.wheels=[];[this.wheel1Node||this.findNode("wheels_layout/wheels/wheel1"),this.wheel2Node||this.findNode("wheels_layout/wheels/wheel2"),this.wheel3Node||this.findNode("wheels_layout/wheels/wheel3"),this.wheelFeatureNode||this.findNode("wheels_layout/wheels/wheel_feature")].forEach(((e,t)=>{if(e){let n=e.getComponent(f);n||(n=e.addComponent(f));const i=e.getChildByName("symbol_container");if(i&&(n.symbolContainer=i,i.children.length>0)){const e=i.children[0].getComponent(c);e&&e.height>0&&(n.symbolHeight=e.height)}n.wheelType=t<3?"coin":"feature",n.bundle=this.bundle,this.wheels.push(n)}else Log.w(`[MoneyComingView] 未找到滚轮 ${t+1} 节点`)})),4!==this.wheels.length&&Log.e(`[MoneyComingView] 滚轮初始化失败，期望4个，实际${this.wheels.length}个`)}findNode(e){return this.wheelsContainer&&this.wheelsContainer.getChildByPath(e)||null}onSpinClick(){this.logic.onSpinClick()}onAutoClick(){this.logic.onAutoClick()}onTurboClick(){this.logic.onTurboClick()}onBetBtnClick(){this.logic.onBetBtnClick()}onSettingClick(){App.tips.show("设置功能待实现")}onGoBack(){this.enterBundle(m.BUNDLE_HALL)}onBalanceUpdate(e){this.logic.onBalanceUpdate(e)}setupBackground(){if(!this.bgSprite||!this.bgSprite.node)return;let e=this.bgSprite.node.getComponent(g);e||(e=this.bgSprite.node.addComponent(g),e.isAlignTop=!0,e.isAlignBottom=!0,e.isAlignLeft=!0,e.isAlignRight=!0,e.top=0,e.bottom=0,e.left=0,e.right=0,e.updateAlignment())}initLuckyWheelRotation(){if(!this.luckyWheels)return void Log.w("[MoneyComingView] luckyWheels 节点未找到");const e=this.luckyWheels.getChildByPath("wheel1_5_10"),t=this.luckyWheels.getChildByPath("wheel50_100");if(e){const t=e.getChildByName("money");if(t){t.active=!0;let e=t.getComponent(C);e||(e=t.addComponent(C),e.rotationSpeed=-10,e.autoStart=!0),Log.d("[MoneyComingView] wheel1_5_10 的 money 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel1_5_10 下未找到 money 节点");const n=e.getChildByName("money_upgrade");if(n){n.active=!0;let e=n.getComponent(C);e||(e=n.addComponent(C),e.rotationSpeed=-10,e.autoStart=!0),Log.d("[MoneyComingView] wheel1_5_10 的 money_upgrade 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel1_5_10 下未找到 money_upgrade 节点");const i=e.getChildByName("money_bg");if(i){i.active=!0;let e=i.getComponent(C);e||(e=i.addComponent(C),e.rotationSpeed=-10,e.autoStart=!0),Log.d("[MoneyComingView] wheel1_5_10 的 money_bg 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel1_5_10 下未找到 money_bg 节点")}else Log.w("[MoneyComingView] wheel1_5_10 节点未找到");if(t){const e=t.getChildByName("money");if(e){e.active=!0;let t=e.getComponent(C);t||(t=e.addComponent(C),t.rotationSpeed=-10,t.autoStart=!0),Log.d("[MoneyComingView] wheel50_100 的 money 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel50_100 下未找到 money 节点");const n=t.getChildByName("money_upgrade");if(n){n.active=!0;let e=n.getComponent(C);e||(e=n.addComponent(C),e.rotationSpeed=-10,e.autoStart=!0),Log.d("[MoneyComingView] wheel50_100 的 money_upgrade 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel50_100 下未找到 money_upgrade 节点");const i=t.getChildByName("money_bg");if(i){i.active=!0;let e=i.getComponent(C);e||(e=i.addComponent(C),e.rotationSpeed=-10,e.autoStart=!0),Log.d("[MoneyComingView] wheel50_100 的 money_bg 节点已添加旋转组件")}else Log.w("[MoneyComingView] wheel50_100 下未找到 money_bg 节点")}else Log.w("[MoneyComingView] wheel50_100 节点未找到")}}).logicType=w,Z=t((K=Ae).prototype,"logic",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(K.prototype,"balanceLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(K.prototype,"betAmountLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(K.prototype,"winAmountLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(K.prototype,"spinBtn",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(K.prototype,"autoBtn",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(K.prototype,"fastBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(K.prototype,"betBtn",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(K.prototype,"settingBtn",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(K.prototype,"goBackBtn",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(K.prototype,"wheelsContainer",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=t(K.prototype,"wheel1Node",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(K.prototype,"wheel2Node",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(K.prototype,"wheel3Node",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(K.prototype,"wheelFeatureNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=t(K.prototype,"betSelectionNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(K.prototype,"luckyWheels",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(K.prototype,"bet1UnlockNode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(K.prototype,"bet5UnlockNode",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=t(K.prototype,"bet10UnlockNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(K.prototype,"bet50UnlockNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(K.prototype,"brandTextAnimNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(K.prototype,"featureNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=t(K.prototype,"bgSprite",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(K.prototype,"winEffect",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(K.prototype,"winBack",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(K.prototype,"point",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=t(K.prototype,"winFront",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=K))||J));i._RF.pop()}}}));

System.register("chunks:///_virtual/nodeUtils.ts",["cc"],(function(t){var e,c;return{setters:[function(t){e=t.cclegacy,c=t.UIOpacity}],execute:function(){e._RF.push({},"f1e2dPEtaaXgP7cuph2VDIQ","nodeUtils",void 0);t("NodeUtils",class{static setNodeOpacity(t,e){if(!t)return;let n=t.getComponent(c);n||(n=t.addComponent(c)),n.opacity=e}}),e._RF.pop()}}}));

System.register("chunks:///_virtual/RespinManager.ts",["cc","./MoneyComingConfig.ts","./SymbolAnimator.ts","./AnimationUtils.ts"],(function(e){var t,n,s,i,a;return{setters:[function(e){t=e.cclegacy,n=e.find},function(e){s=e.MoneyComingConfig},function(e){i=e.SymbolAnimator},function(e){a=e.AnimationUtils}],execute:function(){t._RF.push({},"bc611ZD+pVNIb9Xv4FcAUTv","RespinManager",void 0);e("RespinManager",class{constructor(e,t,n,s,i,a){this.view=void 0,this.wheels=void 0,this.audioManager=void 0,this.uiManager=void 0,this.animationController=void 0,this.betManager=void 0,this._isRespin=!1,this._initialBaseWin=0,this._completedWheels=0,this._respinResults=[],this._onRespinCompleteCallback=null,this.view=e,this.wheels=t,this.audioManager=n,this.uiManager=s,this.animationController=i,this.betManager=a}get isRespin(){return this._isRespin}setOnRespinCompleteCallback(e){this._onRespinCompleteCallback=e}handleAllRespin(e){Log.d(`[RespinManager] handleAllRespin called with results: [${e.join(", ")}]`),this._isRespin=!0;let t="";const i=1===this.betManager.betAmount?2:3;for(let n=0;n<i;n++){const i=e[n];i&&i.startsWith(s.constants.elementPrefix)&&(t+=i.replace(s.constants.elementPrefix,""))}this._initialBaseWin=""===t||isNaN(parseInt(t,10))?0:parseInt(t,10),Log.d(`[RespinManager] All Respin 触发，初始基础奖励: ${this._initialBaseWin}`),this.uiManager.showFeaturePanel(this._initialBaseWin),this.prepareRespin();const o=this.wheels[3].node,l=1===this.betManager.betAmount?2:3,r=[];for(let e=0;e<l;e++)r.push(this.wheels[e].node);let h=this.view.node;const p=n("Canvas");p&&(h=p),Log.d(`[RespinManager] Animation setup: startNode=${o.name}, parentNode=${h.name}, activeWheelCount=${l}`),this.audioManager.playEffect(s.audio.allRespin),this.audioManager.playEffect(s.audio.allRespinScatter);let u=0;const c=r.length;for(let e=0;e<r.length;e++)Log.d(`[RespinManager] Playing animation from ${o.name} to ${r[e].name}`),a.playImage(s.constants.bundleName,o,r[e],h,(()=>{this.wheels[e].startSpin(),this.animationController.playExpectAnimation(this.wheels[e].node),u++,u===c&&this.scheduleStopRespin()}))}startWheelSpin(e){this.wheels[e].startSpin(),this.animationController.playExpectAnimation(this.wheels[e].node)}prepareRespin(){const e=[s.constants.elementPrefix+"0",s.constants.elementPrefix+"00",s.constants.elementPrefix+"1",s.constants.elementPrefix+"5",s.constants.elementPrefix+"10"],t=[],n=1===this.betManager.betAmount?2:3;for(let i=0;i<n;i++)t.push(Math.random()<s.gameplay.symbolProbability?e[Math.floor(Math.random()*e.length)]:"");1===this.betManager.betAmount&&t.push(""),this._respinResults=[...t,s.constants.featureAllRespinKeyword],Log.d(`[RespinManager] All Respin 重转结果: [${t.join(", ")}]`)}startWheelSpin(e){this.wheels[e].startSpin(),this.animationController.playExpectAnimation(this.wheels[e].node)}scheduleStopRespin(){this._completedWheels=0;const e=this.wheels[3],t=e.getDisplayedElement();if(t){const n=t.getWorldPosition();i.playAnimationAt(e.node,n,s.constants.featureAllRespinKeyword,s.constants.bundleName,!0,1)}let n,a;switch(this.getTurboModeState()){case 1:n=s.simultaneousStop.turbo.scrollDuration,a=s.simultaneousStop.turbo.stopDuration;break;case 2:n=s.simultaneousStop.superTurbo.scrollDuration,a=s.simultaneousStop.superTurbo.stopDuration;break;default:n=s.simultaneousStop.normal.scrollDuration,a=s.simultaneousStop.normal.stopDuration}this.view.scheduleOnce((()=>{const e=1===this.betManager.betAmount?2:3;for(let t=0;t<e;t++){this.audioManager.playEffect(s.audio.spinOver);const n=this.wheels[t];n.stop(this._respinResults[t],(()=>{this.animationController.stopExpectAnimation(n.node),this._completedWheels++,this._completedWheels>=e&&this.onRespinWheelsStopped()}),a)}}),n)}onRespinWheelsStopped(){this._isRespin=!1;let e="";const t=1===this.betManager.betAmount?2:3;for(let n=0;n<t;n++){const t=this._respinResults[n];t&&t.startsWith(s.constants.elementPrefix)&&(e+=t.replace(s.constants.elementPrefix,""))}const n=""===e||isNaN(parseInt(e,10))?0:parseInt(e,10);Log.d(`[RespinManager] All Respin 重转基础奖励: ${n}`),this.uiManager.updateFeatureBonus(n);const i=this._initialBaseWin+n;Log.d(`[RespinManager] All Respin 总奖励: ${i}`),this._initialBaseWin=0,this._onRespinCompleteCallback&&this._onRespinCompleteCallback(i,this._respinResults)}getTurboModeState(){return 0}setTurboModeStateGetter(e){this.getTurboModeState=e}}),t._RF.pop()}}}));

System.register("chunks:///_virtual/SpinManager.ts",["cc","./MoneyComingConfig.ts"],(function(e){var t,i;return{setters:[function(e){t=e.cclegacy},function(e){i=e.MoneyComingConfig}],execute:function(){t._RF.push({},"45316zlt5RJe6mfQ7Raa7FV","SpinManager",void 0);e("SpinManager",class{constructor(e,t,i,s){this.view=void 0,this.wheels=void 0,this.audioManager=void 0,this.betManager=void 0,this._isSpinning=!1,this._completedWheels=0,this._spinResults=[],this._turboModeState=0,this._onAllWheelsStoppedCallback=null,this.view=e,this.wheels=t,this.audioManager=i,this.betManager=s}get isSpinning(){return this._isSpinning}get turboModeState(){return this._turboModeState}set turboModeState(e){this._turboModeState=e}get spinResults(){return this._spinResults}setOnAllWheelsStoppedCallback(e){this._onAllWheelsStoppedCallback=e}startSpin(){if(4!==this.wheels.length)return Log.e("[SpinManager] 滚轮数量不正确，无法开始滚动"),Log.d(`[SpinManager] isSpinning 状态改变: ${this._isSpinning} -> false`),void(this._isSpinning=!1);Log.d(`[SpinManager] isSpinning 状态改变: ${this._isSpinning} -> true`),this._isSpinning=!0,this._completedWheels=0,this._spinResults=this.betManager.generateSpinResults(),Log.d(`[SpinManager] 生成随机结果: [${this._spinResults.join(", ")}]`),Log.d("[SpinManager] 普通模式，开始滚动动画"),this.wheels.forEach(((e,t)=>{1===this.betManager.betAmount&&2===t||e.startSpin()}));const e=i.sequentialStop.initialStopDelay;this.view.scheduleOnce((()=>{this.stopWheel(3)}),e)}startTurboSpin(){Log.d("[SpinManager] Turbo 模式，快速共同停止"),Log.d(`[SpinManager] isSpinning 状态改变: ${this._isSpinning} -> true`),this._isSpinning=!0,this._completedWheels=0,this._spinResults=this.betManager.generateSpinResults(),Log.d(`[SpinManager] 生成随机结果: [${this._spinResults.join(", ")}]`),this.wheels.forEach(((e,t)=>{1===this.betManager.betAmount&&2===t||e.startSpin()}));let e=0,t=0;1===this._turboModeState?(e=i.simultaneousStop.turbo.scrollDuration,t=i.simultaneousStop.turbo.stopDuration):2===this._turboModeState&&(e=i.simultaneousStop.superTurbo.scrollDuration,t=i.simultaneousStop.superTurbo.stopDuration),this.view.scheduleOnce((()=>{this.wheels.forEach(((e,i)=>{if(1===this.betManager.betAmount&&2===i)return void this._completedWheels++;const s=this._spinResults[i];e.stop(s,(()=>{this._completedWheels++,this._completedWheels>=this.wheels.length&&this.onAllWheelsStopped()}),t)}))}),e)}stopWheel(e){if(e<0)return void this.onAllWheelsStopped();if(1===this.betManager.betAmount&&2===e){this._completedWheels++;const t=i.sequentialStop.wheelStopInterval;return void this.view.scheduleOnce((()=>{this.stopWheel(e-1)}),t)}const t=this.wheels[e],s=this._spinResults[e];0===this._turboModeState&&(3===e&&s?this.audioManager.playEffect(i.audio.feature):this.audioManager.playEffect(i.audio.spinOver));const n=i.sequentialStop.wheelStopInterval;t.stop(s,(()=>{this._completedWheels++,this.view.scheduleOnce((()=>{this.stopWheel(e-1)}),n)}))}onAllWheelsStopped(){Log.d(`[SpinManager] 所有转轮停止，最终结果: [${this._spinResults.join(", ")}]`),this._onAllWheelsStoppedCallback&&this._onAllWheelsStoppedCallback(this._spinResults)}resetSpinState(){Log.d(`[SpinManager] isSpinning 状态改变: ${this._isSpinning} -> false`),this._isSpinning=!1}}),t._RF.pop()}}}));

System.register("chunks:///_virtual/SymbolAnimator.ts",["cc"],(function(e){var o,t,n,s,i,a,l;return{setters:[function(e){o=e.cclegacy,t=e._decorator,n=e.Component,s=e.assetManager,i=e.sp,a=e.Node,l=e.UITransform}],execute:function(){var m,r;o._RF.push({},"eb878R4x4ZG0qZof5+H1zFH","SymbolAnimator",void 0);const{ccclass:y}=t;e("SymbolAnimator",y("SymbolAnimator")(((r=class extends n{static playAnimationAt(e,o,t,n,m=!1,r=1){Log.d(`[SymbolAnimator] playAnimationAt for ${t}`);const y=this.SPINE_PATH_MAP.get(t);if(!y)return void Log.w(`[SymbolAnimator] 元素 ${t} 没有对应的 spine 动画`);const _=s.getBundle(n);_?_.load(y,i.SkeletonData,((n,s)=>{if(n||!e||!e.isValid)return void Log.e(`[SymbolAnimator] 加载 spine 资源失败或父节点已销毁: ${y}`,n);const _=new a(`spine_anim_${t}_${Date.now()}`);e.addChild(_);const b=e.getComponent(l).convertToNodeSpaceAR(o);_.setPosition(b),_.layer=e.layer;const c=_.addComponent(i.Skeleton);c.skeletonData=s,c.premultipliedAlpha=!0,c.timeScale=r;const p="animation";c.findAnimation(p)?(c.setAnimation(0,p,m),m||c.setCompleteListener((()=>{_&&_.isValid&&_.destroy()}))):(Log.w(`[SymbolAnimator] spine 资源 ${y} 中未找到名为 'animation' 的动画`),_.destroy())})):Log.e(`[SymbolAnimator] 无法获取 bundle: ${n}`)}static stopAllAnimations(e){if(!e||!e.isValid)return;const o=[...e.children];for(const e of o)e.name.startsWith("spine_anim_")&&e.destroy();Log.d(`[SymbolAnimator] 停止并销毁了 ${e.name} 下的所有符号动画节点`)}}).SPINE_PATH_MAP=new Map([["element_0","spine/symbol/symbol_0"],["element_00","spine/symbol/symbol_00"],["element_1","spine/symbol/symbol_1"],["element_5","spine/symbol/symbol_5"],["element_10","spine/symbol/symbol_10"],["feature_x2","spine/symbol/symbol_2x"],["feature_x5","spine/symbol/symbol_5x"],["feature_x10","spine/symbol/symbol_10x"],["feature_all_respin","spine/symbol/symbol_all"],["feature_scatter","spine/symbol/symbol_scatter"],["feature_scatter_50_100","spine/symbol/symbol_scatter_red"]]),m=r))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/Wheel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SymbolAnimator.ts"],(function(t){var i,e,n,o,s,l,r,h,a,m,p,c;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.initializerDefineProperty},function(t){n=t.cclegacy,o=t.Node,s=t._decorator,l=t.Component,r=t.instantiate,h=t.Layout,a=t.UITransform,m=t.Vec3,p=t.tween},function(t){c=t.SymbolAnimator}],execute:function(){var b,g,y,u,d,C,_,f,S,E,L,$,W,w,N,I,Y,D,P,H,v;n._RF.push({},"f9671e21kFBg73VXVIiaDhO","Wheel",void 0);const{ccclass:x,property:z}=s;var T=function(t){return t[t.IDLE=0]="IDLE",t[t.SPINNING=1]="SPINNING",t[t.DECELERATING=2]="DECELERATING",t[t.BOUNCING=3]="BOUNCING",t}(T||{});t("Wheel",(b=x("Wheel"),g=z(o),y=z({group:"Physics",tooltip:"最大速度（像素/秒）"}),u=z({group:"Physics",tooltip:"加速度（像素/秒²）"}),d=z({group:"Physics",tooltip:"减速时使用的缓动函数"}),C=z({group:"Physics",tooltip:"减速到停止的总时长"}),_=z({group:"Physics",tooltip:"回弹效果的缓动函数"}),f=z({group:"Physics",tooltip:"回弹效果的时长"}),b((L=i((E=class extends l{constructor(...t){super(...t),e(this,"symbolContainer",L,this),e(this,"symbolHeight",$,this),e(this,"wheelType",W,this),e(this,"containerHeight",w,this),e(this,"elementSpacing",N,this),this.bundle=null,e(this,"maxSpeed",I,this),e(this,"acceleration",Y,this),e(this,"decelerationEasing",D,this),e(this,"decelerationDuration",P,this),e(this,"bounceEasing",H,this),e(this,"bounceDuration",v,this),this._isSpinning=!1,this._onSpinComplete=null,this._targetElementName="",this._symbolCount=0,this._elementMap=new Map,this._originalSymbolCount=0,this._currentVisibleElements=[],this._spinState=T.IDLE,this._currentSpeed=0,this._targetY=0,this._stopCallback=null,this._loopHeight=0,this._startY=0}onLoad(){if(this.symbolContainer||(this.symbolContainer=this.node.getChildByName("symbol_container")||this.node),this.symbolContainer){const t=[...this.symbolContainer.children];if(this._originalSymbolCount=t.length,this._elementMap.clear(),t.forEach((t=>{this._elementMap.set(t.name,r(t))})),this._originalSymbolCount>1){const i=Math.min(3,this._originalSymbolCount);for(let e=0;e<i;e++){const i=t[this._originalSymbolCount-1-e],n=r(i);this.symbolContainer.insertChild(n,0)}for(let e=0;e<i;e++){const i=t[e],n=r(i);this.symbolContainer.addChild(n)}}const i=this.symbolContainer.getComponent(h);i&&(i.updateLayout(),i.enabled=!1),this._symbolCount=this.symbolContainer.children.length,this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),Log.d(`[Wheel] 初始化完成，元素数量: ${this._symbolCount}, 原始元素数量: ${this._originalSymbolCount}, 模板数量: ${this._elementMap.size}`)}if(this.symbolHeight<=0&&this.symbolContainer&&this.symbolContainer.children.length>0){const t=this.symbolContainer.children[0].getComponent(a);t&&(this.symbolHeight=t.height)}this.resetToInitialPosition()}resetToInitialPosition(){if(!this.symbolContainer||0===this.symbolContainer.children.length)return;const t=(this._symbolCount-this._originalSymbolCount)/2,i=this.symbolContainer.children[t];if(!i){const t=this.symbolContainer.children[0].position.y;return this.symbolContainer.position=new m(this.symbolContainer.position.x,-t,0),void Log.w("[Wheel] 无法找到第一个原始元素，已重置到第一个可用元素。")}const e=i.position.y;this._startY=-e,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._startY,0)}startSpin(t="",i=2,e){if(p(this.symbolContainer).stop(),!this._isSpinning){if(0===this._originalSymbolCount)return Log.w("[Wheel] 滚轮中没有元素，无法启动"),void(e&&e(""));this._isSpinning=!0,this._spinState=T.SPINNING,this._currentSpeed=this.maxSpeed,this._onSpinComplete=e||null,this._targetElementName=t}}stop(t,i,e){if(Log.d(`[Wheel] stop called: targetElementName="${t}", wheelType=${this.wheelType}`),!this._isSpinning||this._spinState!==T.SPINNING)return Log.d("[Wheel] stop: 滚轮未在滚动状态，直接回调"),void(i&&i());this._targetElementName=t,this._stopCallback=i||null;let n=null,o=[];const s=this.symbolContainer.position.y,l=.2*this.maxSpeed,r=this._startY-this._loopHeight+l,h=this._startY-l;for(const i of this.symbolContainer.children){if(i.name.replace(/-clone.*$/,"")===t){const t=-i.position.y;let e=t-s;e<0&&(e+=this._loopHeight),o.push({node:i,distance:e,targetY:t})}}if(o.length>0){const t=o.filter((t=>t.targetY>r&&t.targetY<h));t.length>0?(t.sort(((t,i)=>t.distance-i.distance)),n=t[0].node,Log.d(`[Wheel] 选择安全范围内的目标: targetY=${t[0].targetY.toFixed(2)}, 安全范围: (${r.toFixed(2)}, ${h.toFixed(2)})`)):(o.sort(((t,i)=>t.distance-i.distance)),n=o[0].node,Log.w(`[Wheel] 警告：没有安全范围内的目标，选择最近的: targetY=${o[0].targetY.toFixed(2)}`))}if(Log.d(`[Wheel] stop: 从 symbolContainer.children 查找 "${t}": ${!!n}`),n)this._targetY=-n.position.y,Log.d(`[Wheel] stop: 找到最佳目标元素 "${t}" at y=${n.position.y}`);else{const i=this.getClosestElement();if(i){const e=i.position.y;this._targetY=-e+this.symbolHeight/2+this.elementSpacing/2,Log.d(`[Wheel] stop: 目标元素 '${t}' 未找到，将停在元素之间, targetY=${this._targetY}`)}else this._targetY=this.symbolContainer.position.y,Log.w("[Wheel] stop: 无法找到任何元素，使用当前位置")}this._spinState=T.IDLE,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._targetY,0),this._onSpinFinished()}update(t){if(this._spinState!==T.SPINNING)return;this._currentSpeed<this.maxSpeed&&(this._currentSpeed+=this.acceleration*t,this._currentSpeed>this.maxSpeed&&(this._currentSpeed=this.maxSpeed));let i=this.symbolContainer.position.y-this._currentSpeed*t;if(this._originalSymbolCount>1&&this._loopHeight>0){i<this._startY-this._loopHeight&&(i+=this._loopHeight)}this.symbolContainer.position=new m(this.symbolContainer.position.x,i,0)}_onSpinFinished(){this._isSpinning=!1,this._spinState=T.IDLE,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._targetY,0),Log.d(`[Wheel] _onSpinFinished: targetElementName=${this._targetElementName}, finalY=${this._targetY}`);const t=this.getDisplayedElement();t?Log.d(`[Wheel] _onSpinFinished: 实际显示的元素=${t.name}, elementY=${t.position.y}, containerY=${this.symbolContainer.position.y}`):Log.w("[Wheel] _onSpinFinished: 未找到显示的元素"),this._stopCallback&&(this._stopCallback(),this._stopCallback=null),this._onSpinComplete&&(this._onSpinComplete(this._targetElementName),this._onSpinComplete=null)}getDisplayedElement(){return this._targetElementName&&""!==this._targetElementName?this.findDisplayedElement(this._targetElementName):null}findDisplayedElement(t){if(!this.symbolContainer)return Log.w("[Wheel] symbolContainer 为空"),null;Log.d(`[Wheel] findDisplayedElement: 查找元素 "${t}", symbolContainer 子节点数: ${this.symbolContainer.children.length}`);const i=[];for(const t of this.symbolContainer.children)i.push(t.name);Log.d(`[Wheel] symbolContainer 所有子节点: [${i.join(", ")}]`);let e=null,n=1/0;for(const i of this.symbolContainer.children){if(i.name.replace(/-clone.*$/,"")===t){const t=i.position.y,o=this.symbolContainer.position.y,s=Math.abs(o+t);Log.d(`[Wheel] 找到匹配元素: ${i.name}, elementY=${t}, containerY=${o}, distance=${s}`),s<n&&(n=s,e=i)}}return e?(Log.d(`[Wheel] 选择最近的元素: ${e.name}, distance=${n}`),e):(Log.w(`[Wheel] 未找到名称为 "${t}" 的元素节点`),null)}showResult(t){p(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE,this._currentSpeed=0;let i=0;const e=this._elementMap.get(t);if(e)i=-e.position.y;else{const t=this.getClosestElement();if(t){i=-t.position.y+this.symbolHeight/2+this.elementSpacing/2}else i=this.symbolContainer.position.y}if(this.symbolContainer.position=new m(this.symbolContainer.position.x,i,0),this._targetElementName=t,this._targetY=i,t&&""!==t&&this.bundle){const i=this.findDisplayedElement(t);if(i){Log.d(`[Wheel] Turbo 模式播放动画 for ${t}`);const e=i.getWorldPosition();c.playAnimationAt(this.node,e,t,this.bundle)}}}get isSpinning(){return this._isSpinning}reset(){p(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE,this.resetToInitialPosition()}getCurrentElementName(){return this.getClosestElement().name}getClosestElement(){const t=this.symbolContainer.position.y;let i=null,e=1/0;for(const n of this.symbolContainer.children){const o=n.position.y,s=Math.abs(t+o);s<e&&(e=s,i=n)}return i}setVisibleElements(t){if(Log.d(`[Wheel setVisibleElements] 被调用. Wheel Type: ${this.wheelType}`),Log.d(`[Wheel setVisibleElements] 当前可见元素 (_currentVisibleElements): [${this._currentVisibleElements.join(", ")}]`),Log.d(`[Wheel setVisibleElements] 新的可见元素 (visibleElements): [${t.join(", ")}]`),!this.symbolContainer)return void Log.w("[Wheel] symbolContainer 未初始化");if(0===this._elementMap.size)return void Log.w("[Wheel] _elementMap 为空，等待 onLoad 完成后再调用");0===t.length&&(t=Array.from(this._elementMap.keys()));const i=this._currentVisibleElements.length===t.length&&this._currentVisibleElements.every(((i,e)=>i===t[e]));if(Log.d(`[Wheel setVisibleElements] 列表是否相同 (isSameElements): ${i}`),i)return void Log.d("[Wheel] 可见元素列表未变化，跳过重建");this._spinState,T.IDLE;const e=this.symbolContainer.position.clone();p(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE;const n=this.symbolContainer.active;if(this.symbolContainer.active=!1,this.symbolContainer.removeAllChildren(),t.forEach((t=>{const i=this._elementMap.get(t);if(i){const t=r(i);this.symbolContainer.addChild(t)}else Log.w(`[Wheel] 未找到元素: ${t}`)})),this._originalSymbolCount=this.symbolContainer.children.length,0===this._originalSymbolCount)return void Log.w(`[Wheel] 设置可见元素后没有任何元素，visibleElements: [${t.join(", ")}]`);if(this._originalSymbolCount>1){const t=[...this.symbolContainer.children],i=Math.min(3,this._originalSymbolCount);for(let e=0;e<i;e++){const i=t[this._originalSymbolCount-1-e],n=r(i);this.symbolContainer.insertChild(n,0)}for(let e=0;e<i;e++){const i=t[e],n=r(i);this.symbolContainer.addChild(n)}}this._symbolCount=this.symbolContainer.children.length;const o=this.symbolContainer.getComponent(h);o&&(o.enabled=!1),this._manuallyLayoutChildren(),this._finalizePositionAfterRebuild(e,n),this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),this._currentVisibleElements=[...t],Log.d(`[Wheel] 设置可见元素: [${t.join(", ")}]，总计 ${this._symbolCount} 个节点`)}_manuallyLayoutChildren(){if(!this.symbolContainer||0===this.symbolContainer.children.length)return;let t=0;for(let i=0;i<this.symbolContainer.children.length;i++){const e=this.symbolContainer.children[i];0===i?t=0:t-=this.symbolHeight+this.elementSpacing,e.setPosition(0,t,0)}Log.d(`[Wheel] 手动布局完成，共 ${this.symbolContainer.children.length} 个子节点`)}_finalizePositionAfterRebuild(t,i=!0){if(t&&this._currentVisibleElements.length>0){const t=(this._symbolCount-this._originalSymbolCount)/2,i=this.symbolContainer.children[t];if(i){const t=i.position.y;this._startY=-t,Log.d(`[Wheel] 重建后重新计算 _startY = ${this._startY}`),this.resetToInitialPosition(),Log.d("[Wheel] 切换投注金额后重置到初始位置，确保不抖动")}else this.resetToInitialPosition()}else this.resetToInitialPosition();this.symbolContainer.active=i}}).prototype,"symbolContainer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=i(E.prototype,"symbolHeight",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 166}}),W=i(E.prototype,"wheelType",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"coin"}}),w=i(E.prototype,"containerHeight",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 316}}),N=i(E.prototype,"elementSpacing",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),I=i(E.prototype,"maxSpeed",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4e3}}),Y=i(E.prototype,"acceleration",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3e3}}),D=i(E.prototype,"decelerationEasing",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quadOut"}}),P=i(E.prototype,"decelerationDuration",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),H=i(E.prototype,"bounceEasing",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),v=i(E.prototype,"bounceDuration",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),S=E))||S));n._RF.pop()}}}));

System.register("chunks:///_virtual/WinManager.ts",["cc","./MoneyComingConfig.ts","./SymbolAnimator.ts"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy},function(t){n=t.MoneyComingConfig},function(t){i=t.SymbolAnimator}],execute:function(){e._RF.push({},"f36baZcfhVPHJqnM3ca7vWf","WinManager",void 0);t("WinManager",class{constructor(t,e){this.wheels=void 0,this.audioManager=void 0,this.wheels=t,this.audioManager=e}calculateWinAmount(t,e){if(t.length<4)return 0;const i=1===e?2:3,s=t.slice(0,i),o=t[3];let a="";for(const t of s)t&&t.startsWith(n.constants.elementPrefix)&&(a+=t.replace(n.constants.elementPrefix,""));if(""===a)return 0;const r=parseInt(a,10);if(isNaN(r)||0===r)return 0;let l=1;return o===n.constants.featureMultiplierPrefix+"2"?l=2:o===n.constants.featureMultiplierPrefix+"5"?l=5:o===n.constants.featureMultiplierPrefix+"10"&&(l=10),r*l}playWinningAnimations(t,e,s){this.stopWinningAnimations();const o=1===e?2:3,a=t[3];let r=!1,l="";for(let e=0;e<o;e++)t[e]&&t[e].startsWith(n.constants.elementPrefix)&&(l+=t[e].replace(n.constants.elementPrefix,""));const c=l?parseInt(l,10):0;if(c>0){r=!0;let e=-1;for(let i=0;i<o;i++){const s=t[i];if(s&&s.startsWith(n.constants.elementPrefix)){const t=s.replace(n.constants.elementPrefix,"");if("0"!==t&&"00"!==t){e=i;break}}}if(-1!==e)for(let s=e;s<o;s++)if(t[s]&&t[s].startsWith(n.constants.elementPrefix)){const e=this.wheels[s],o=e.getDisplayedElement();if(o){const a=o.getWorldPosition();i.playAnimationAt(e.node,a,t[s],n.constants.bundleName,!0)}}}if(a){const t=c>0&&a.startsWith(n.constants.featureMultiplierPrefix),e=a.includes(n.constants.featureScatterKeyword);if(t||e){r=!0;const t=this.wheels[3],e=t.getDisplayedElement();if(e){const s=e.getWorldPosition();i.playAnimationAt(t.node,s,a,n.constants.bundleName,!0)}}}r&&0===s&&this.audioManager.playWinSound()}playFeatureAnimation(t){if(!t||this.wheels.length<4)return;const e=this.wheels[3],s=e.getDisplayedElement();if(s){const o=s.getWorldPosition();i.playAnimationAt(e.node,o,t,n.constants.bundleName,!0),Log.d(`[WinManager] 播放 feature 动画: ${t}`)}else Log.w(`[WinManager] 无法找到 feature 元素节点: ${t}`)}stopWinningAnimations(){Log.d("[WinManager] 停止所有中奖动画");for(const t of this.wheels)i.stopAllAnimations(t.node)}}),e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/moneyComing', 'chunks:///_virtual/moneyComing'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});