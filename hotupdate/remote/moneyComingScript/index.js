System.register("chunks:///_virtual/AnimationUtils.ts",["cc"],(function(t){var e,o,i,s,n,a,r,l,c,d;return{setters:[function(t){e=t.cclegacy,o=t.Node,i=t.Layers,s=t.UIOpacity,n=t.Sprite,a=t.assetManager,r=t.SpriteFrame,l=t.v3,c=t.tween,d=t._decorator}],execute:function(){var m;e._RF.push({},"14eccGvK+pDd40mf1YiHSFj","AnimationUtils",void 0);const{ccclass:p}=d;t("AnimationUtils",p("AnimationUtils")(m=class{static playImage(t,e,l,c,d,m="up"){console.log(`[AnimationUtils] playImage called with: fromNode=${e.name}, toNode=${l.name}, parentNode=${c.name}, curveType=${m}`);let p=new o("FlyEffectNode");p.layer=i.Enum.UI_2D;let y=p.addComponent(s),u=p.addComponent(n);const f=a.getBundle(t);if(!f)return void console.error(`[AnimationUtils] Bundle ${t} not found`);const _="cocos_lizi/fly/sybres_eft_str_02/spriteFrame";f.load(_,r,((t,o)=>{t?console.error(`[AnimationUtils] Failed to load spriteFrame: ${_}`,t):(u.spriteFrame=o,this._startAnimation(p,u,y,e,l,c,f,d,m))}))}static _startAnimation(t,e,o,i,s,n,a,d,m="up"){t.active=!0,n.addChild(t);let p,y=i.getWorldPosition(),u=s.getWorldPosition();if("down"===m){const t=.3*(u.x-y.x),e=-200;p=l(y.x+t,y.y+e,y.z)}else p=l(y.x,y.y+500,y.z);t.setWorldPosition(y),t.setScale(2,2,1),c(t).to(1,{worldPosition:u},{onUpdate:(e,o)=>{let i=o,s=y,n=p,a=u,r=(1-i)*(1-i)*s.x+2*i*(1-i)*n.x+i*i*a.x,c=(1-i)*(1-i)*s.y+2*i*(1-i)*n.y+i*i*a.y;t.setWorldPosition(l(r,c,0))}}).call((()=>{a.load("cocos_lizi/fly/sybres_eft_exp_04/spriteFrame",r,((i,s)=>{if(i)return console.error("[AnimationUtils] Failed to load explosion sprite",i),t.destroy(),void(d&&d());e.spriteFrame=s,c(t).to(.3,{scale:l(8,8,1)}).start(),c(o).to(.1,{opacity:0}).call((()=>{t.destroy(),d&&d()})).start()}))})).start()}})||m);e._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationViewModel.ts",["cc","./ViewModel.ts","./index80.ts","./index82.ts","./soundDefine21.ts"],(function(e){var o,i,n,t,l,s,a,c,h,d,m,p,k;return{setters:[function(e){o=e.cclegacy,i=e.Node,n=e.UITransform,t=e.Graphics,l=e.Color,s=e.sp,a=e.assetManager,c=e._decorator},function(e){h=e.StoreInject,d=e.default},function(e){m=e.getStore},function(e){p=e.moneyComing_Audio},function(e){k=e.SoundPathDefine}],execute:function(){var r;o._RF.push({},"c8234RwiX9BV79sxen4RPgp","AnimationViewModel",void 0);const{ccclass:w}=c;e("AnimationViewModel",h(m())(r=w("AnimationViewModel")(r=class extends d{constructor(){super("MoneyComing_GameMain"),this.previousBet=10,this.isInitialized=!1}begin(){const e=m().getState();this.previousBet=e.betAmount}connect(e){const o=this.store.getState();console.log("[AnimationViewModel] connect: initial state",o),o&&this.onStateUpdate(o),this.store.subscribe((()=>{const e=this.store.getState();this.onStateUpdate(e)}))}onStateUpdate(e){const o=e.betAmount;this.isInitialized?o!==this.previousBet&&(console.log(`[AnimationViewModel] onStateUpdate: Bet changed from ${this.previousBet} to ${o}`),this.handleBetChange(o)):(console.log(`[AnimationViewModel] onStateUpdate: Initializing with betAmount=${o}`),this.isInitialized=!0,this.setInitialLockState(o),this.previousBet=o)}setInitialLockState(e){if(console.log(`[AnimationViewModel] setInitialLockState: betAmount=${e}`),1===e){const e=this.comp.wheel3LockNode;e?(this.showWheel3ShadowMask(),this.playSpineAnimation(e,"spine/lock/wheel_lock","stand",!0)):console.warn("[AnimationViewModel] setInitialLockState: wheel3LockNode is missing");const o=this.comp.luckyWheelLockNode;o?this.playSpineAnimation(o,"spine/lock/unlock","stand",!0):console.warn("[AnimationViewModel] setInitialLockState: luckyWheelLockNode is missing")}else this.comp.wheel3LockNode&&(this.comp.wheel3LockNode.active=!1),this.comp.luckyWheelLockNode&&(this.comp.luckyWheelLockNode.active=!1),this.hideWheel3ShadowMask()}handleBetChange(e){const o=this.previousBet;console.log(`[AnimationViewModel] handleBetChange: previous=${o}, new=${e}`),e>o&&p&&p.playOneShot(k.activeFeature),1!==o&&1===e?(console.log("[AnimationViewModel] Switching to Bet 1 -> LOCK"),this.playWheel3LockAnimation(),this.playLuckyWheelLockAnimation()):1===o&&1!==e&&(console.log("[AnimationViewModel] Switching from Bet 1 -> UNLOCK"),this.playWheel3UnlockAnimation(),this.playLuckyWheelUnlockAnimation()),this.previousBet=e}playWheel3LockAnimation(){const e=this.comp.wheel3LockNode;console.log("[AnimationViewModel] playWheel3LockAnimation: lockNode exists?",!!e),e&&(this.showWheel3ShadowMask(),p&&p.playOneShot(k.wheelLock),this.playSpineAnimation(e,"spine/lock/wheel_lock","lock",!1,(()=>{this.playSpineAnimation(e,"spine/lock/wheel_lock","stand",!0)})))}playWheel3UnlockAnimation(){const e=this.comp.wheel3LockNode;e&&(this.hideWheel3ShadowMask(),this.playSpineAnimation(e,"spine/lock/wheel_lock","unlock",!1,(()=>{e.active=!1})))}showWheel3ShadowMask(){const e=this.comp.wheels[2];if(!e||!e.node)return;let o=e.node.getChildByName("wheel_shadow_mask");if(!o){o=new i("wheel_shadow_mask"),e.node.addChild(o),o.setPosition(-7,0,0);o.addComponent(n).setContentSize(200,400);const s=o.addComponent(t);s.clear(),s.fillColor=new l(0,0,0,128),s.rect(-100,-200,200,400),s.fill()}o.active=!0;const s=this.comp.wheel3LockNode;s?o.setSiblingIndex(Math.max(0,s.getSiblingIndex()-1)):o.setSiblingIndex(e.node.children.length-1)}hideWheel3ShadowMask(){const e=this.comp.wheels[2];if(!e||!e.node)return;const o=e.node.getChildByName("wheel_shadow_mask");o&&(o.active=!1)}playLuckyWheelLockAnimation(){const e=this.comp.luckyWheelLockNode;e&&this.playSpineAnimation(e,"spine/lock/unlock","start",!1,(()=>{this.playSpineAnimation(e,"spine/lock/unlock","stand",!0)}))}playLuckyWheelUnlockAnimation(){const e=this.comp.luckyWheelLockNode;e&&this.playSpineAnimation(e,"spine/lock/unlock","end",!1,(()=>{e.active=!1}))}playSymbolAnimation(e,o,n=!1){if(!e)return;let t=e.getChildByName("symbol_anim");t||(t=new i("symbol_anim"),e.addChild(t),t.setPosition(0,0,0)),t.setScale(1,1,1),this.playSpineAnimation(t,`spine/${o}/${o}`,"animation",n)}playSpineAnimation(e,o,i,n,t){if(!e)return void console.warn("[AnimationViewModel] playSpineAnimation: node is null");console.log(`[AnimationViewModel] playSpineAnimation: path=${o}, anim=${i}, node=${e.name}, active=${e.active}`),e.active=!0;let l=e.getComponent(s.Skeleton);l||(l=e.addComponent(s.Skeleton),console.log("[AnimationViewModel] Added sp.Skeleton component"));const c=a.getBundle("moneyComing");c?c.load(o,s.SkeletonData,((e,s)=>{if(e||!l)return void console.error(`[AnimationViewModel] Failed to load spine: ${o}`,e);console.log(`[AnimationViewModel] Spine loaded successfully: ${o}`),l.skeletonData=s,l.premultipliedAlpha=!0;const a=l.setAnimation(0,i,n);console.log(`[AnimationViewModel] Animation set: ${i}, trackEntry=${!!a}`),a&&!n&&t&&l.setCompleteListener((()=>{l.setCompleteListener(null),t()}))})):console.error("[AnimationViewModel] Failed to get bundle: moneyComing")}})||r)||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/BetSelection.ts",["cc"],(function(e){var t,c,n;return{setters:[function(e){t=e.cclegacy,c=e.Component,n=e._decorator}],execute:function(){var A;t._RF.push({},"12345Z4AAAAAAAAAAAAAAAA","BetSelection",void 0);const{ccclass:o,property:s}=n;e("BetSelection",o("BetSelection")(A=class extends c{start(){}update(e){}})||A);t._RF.pop()}}}));

System.register("chunks:///_virtual/config20.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"18850r0KmRN6qlyxOsoJpRt","config",void 0);e("default",{sktCode:"MoneyComing",name:"MoneyComing",gameId:22,isTest:!1,seatNumber:1,isReconnect:!1,memberId:"",testConfig:{wsUrl:"",token:"",uid:""},gameConfig:{autoSpin:{totalSpins:50,intervals:{normal:1,turbo:.5,superTurbo:.2}},sequentialStop:{initialStopDelay:4.5,wheelStopInterval:.2},simultaneousStop:{normal:{scrollDuration:5,stopDuration:.1},turbo:{scrollDuration:3,stopDuration:.1},superTurbo:{scrollDuration:1,stopDuration:.1}},luckyWheelPrizes:{5:[1e3,250,50,150,75,500,25,100],10:[2e3,500,100,300,150,1e3,50,200],50:[5e4,1e4,1e3,5e3,1500,25e3,500,2500],100:[1e5,2e4,2e3,1e4,3e3,5e4,1e3,5e3]},luckyWheel:{spinDuration:6,accelerationDuration:.5,decelerationDuration:1,maxRotationSpeed:720,easing:"cubicOut",anglePerPrize:45,startAngleOffset:0},gameplay:{winDisplayDuration:.1,symbolProbability:.8,bigWin:{big:1500,mega:3e3,super:5e3}},constants:{elementPrefix:"element_",featureMultiplierPrefix:"feature_x",featureScatterKeyword:"feature_scatter",featureAllRespinKeyword:"feature_all_respin",bundleName:"moneyComing"}}});t._RF.pop()}}}));

System.register("chunks:///_virtual/game37.ts",["cc","./index.mjs_cjs=&original=2.js","./index2.js"],(function(e){var t,n;return{setters:[function(e){t=e.cclegacy},null,function(e){n=e.default}],execute:function(){t._RF.push({},"4b354Q8P1pH4K0SMiEw2Kdu","game",void 0);e("updateBalance",n.createAction("UPDATE_BALANCE")),e("updateBet",n.createAction("UPDATE_BET")),e("updateWin",n.createAction("UPDATE_WIN")),e("setSpinning",n.createAction("SET_SPINNING")),e("setSpinResults",n.createAction("SET_SPIN_RESULTS")),e("setTurboMode",n.createAction("SET_TURBO_MODE")),e("setAutoSpin",n.createAction("SET_AUTO_SPIN"));t._RF.pop()}}}));

System.register("chunks:///_virtual/GameMainViewModel2.ts",["cc","./ViewModel.ts","./index80.ts","./MoneyComing_GameMain.ts","./socketConnect20.ts","./index81.ts","./game37.ts","./config20.ts","./index82.ts","./soundDefine21.ts"],(function(t){var e,n,o,i,s,a,c,p,l,u,h,r,m,g,d,M,S,f,y;return{setters:[function(t){e=t.cclegacy,n=t._decorator},function(t){o=t.StoreInject,i=t.default},function(t){s=t.getStore},function(t){a=t.MoneyComing_GameMain},function(t){c=t.moneyComingWebSocketDriver,p=t.SKT_MAG_TYPE},function(t){l=t.bundlePkgName},function(t){u=t.setAutoSpin,h=t.setTurboMode,r=t.updateBet,m=t.updateWin,g=t.updateBalance,d=t.setSpinning,M=t.setSpinResults},function(t){S=t.default},function(t){f=t.moneyComing_Audio},function(t){y=t.SoundPathDefine}],execute:function(){var A;e._RF.push({},"d5bd4ymCwtHVZf5COZPZI7Z","GameMainViewModel",void 0);const{ccclass:b}=n;t("GameMainViewModel",o(s())(A=b("GameMainViewModel")(A=class extends i{constructor(){super(a)}begin(){this.listenServerMsg(),this.playBgMusic()}connect(t){return this.inject(t,(t=>(console.log("[GameMainViewModel] inject: state.betAmount =",t.betAmount),{balance:t.balance,betAmount:t.betAmount,winAmount:t.winAmount,spinResults:t.spinResults,isSpinning:t.isSpinning,turboMode:t.turboMode,autoSpin:t.autoSpin}))),this.setEvent({onSpin:()=>{this.onSpin()},onAutoSpin:()=>{this.comp.props.autoSpin?(console.log("[MoneyComing] 停止 AutoSpin"),this.dispatch(u(!1))):(console.log("[MoneyComing] 开始 AutoSpin"),this.dispatch(u(!0)),this.onSpin())},onTurbo:()=>{const t=(this.comp.props.turboMode+1)%3;console.log("[MoneyComing] 切换 Turbo 模式:",0===t?"Normal":1===t?"Turbo":"Super Turbo"),this.dispatch(h(t))},onBetChange:t=>{t>this.comp.props.betAmount&&f.playOneShot(y.activeFeature),this.dispatch(r(t))},onSpinComplete:()=>{const t=this.comp.props.spinResults;if("feature_all_respin"===t[3]&&this.respinViewModel)return console.log("[MoneyComing] 触发 All Respin Feature"),void this.handleAllRespinFlow(t);if(t[3]&&t[3].includes("scatter"))return console.log("[MoneyComing] 触发 Scatter Feature"),void this.handleScatterFlow(t);const e=this.calculateWinAmount(t,this.comp.props.betAmount);console.log("[MoneyComing] 轮盘停止完成，计算中奖:",t,"中奖金额:",e),this.comp.playWinAnimations(t),this.checkAndPlayBigWin(e,(()=>{this.dispatch(m(e)),this.dispatch(g(this.comp.props.balance-this.comp.props.betAmount+e)),this.dispatch(d(!1)),this.handleAutoSpin()}))}}),this}handleAutoSpin(){if(this.comp.props.autoSpin){const t=this.getAutoSpinInterval();console.log(`[MoneyComing] AutoSpin 下一次延迟: ${t}秒`),this.comp.scheduleOnce((()=>{this.comp.props.autoSpin&&this.onSpin()}),t)}}async handleAllRespinFlow(t){const e=this.calculateWinAmount(t,this.comp.props.betAmount);console.log("[MoneyComing] All Respin 初始奖励:",e),this.dispatch(m(e)),this.dispatch(g(this.comp.props.balance-this.comp.props.betAmount+e));const n=this.respinViewModel;await n.handleAllRespin(t,(async t=>{const n=this.calculateWinAmount(t,this.comp.props.betAmount);console.log("[MoneyComing] All Respin 重转奖励:",n);const o=e+n;console.log("[MoneyComing] All Respin 总奖励:",o),this.checkAndPlayBigWin(o,(()=>{this.dispatch(m(o)),this.dispatch(g(this.comp.props.balance-this.comp.props.betAmount+o)),this.dispatch(d(!1)),this.handleAutoSpin()}))}))}async handleScatterFlow(t){const e=this.comp.props.betAmount,n=this.calculateWinAmount(t,e);console.log("[MoneyComing] Scatter Base Win:",n),this.comp.showFeaturePanel(n,"scatter",e),this.comp.playFeatureSymbolAnimation(t[3]),this.comp.playScatterFlyAnimation(e,(()=>{console.log("[MoneyComing] Scatter Fly Complete, Spinning Wheel");const t=this.luckyWheelViewModel;if(t){const o=Math.floor(8*Math.random());t.spin(o,(()=>{console.log("[MoneyComing] Lucky Wheel Spin Complete");const t=e*(o+1)*5;this.comp.updateFeatureBonus(t),f.playOneShot(y.scatterOver),setTimeout((()=>{const o=n+t;this.checkAndPlayBigWin(o,(()=>{this.dispatch(m(o)),this.dispatch(g(this.comp.props.balance-e+o)),this.dispatch(d(!1)),this.comp.hideFeaturePanel(),this.handleAutoSpin()}))}),2e3)}))}else console.error("[MoneyComing] LuckyWheelViewModel not found"),this.dispatch(d(!1)),this.comp.hideFeaturePanel()}))}checkAndPlayBigWin(t,e){const n=t/this.comp.props.betAmount;let o="";n>=20?o="super":n>=10?o="mega":n>=5&&(o="big"),o?(console.log(`[MoneyComing] Trigger Big Win: ${o}, amount: ${t}`),this.comp.playBigWinEffect(o,t,e)):e()}getAutoSpinInterval(){const t=this.comp.props.turboMode;return 1===t?S.gameConfig.autoSpin.intervals.turbo:2===t?S.gameConfig.autoSpin.intervals.superTurbo:S.gameConfig.autoSpin.intervals.normal}generateSpinResults(){const t=["element_0","element_00","element_1","element_5","element_10"],e=this.comp.props.betAmount,n=[];for(let o=0;o<3;o++)(1!==e||2!==o)&&Math.random()<.8?n.push(t[Math.floor(Math.random()*t.length)]):n.push("");let o=["feature_x2","feature_x5","feature_all_respin"];return 5===e?o.push("feature_scatter"):10===e?o.push("feature_x10","feature_scatter"):50!==e&&100!==e||o.push("feature_x10","feature_scatter_50_100"),Math.random()<.8?n.push(o[Math.floor(Math.random()*o.length)]):n.push(""),n}calculateWinAmount(t,e){if(t.length<4)return 0;const n=t.slice(0,3),o=t[3];let i="";for(const t of n)t&&t.startsWith("element_")&&(i+=t.replace("element_",""));if(""===i)return 0;const s=parseInt(i,10);if(isNaN(s)||0===s)return 0;let a=1;return"feature_x2"===o?a=2:"feature_x5"===o?a=5:"feature_x10"===o&&(a=10),s*a}onSpin(){this.comp.props.isSpinning||(console.log("[MoneyComing] Spin 开始"),this.dispatch(d(!0)),setTimeout((()=>{const t=this.generateSpinResults();console.log("[MoneyComing] 设置 spin 结果:",t),this.dispatch(M(t))}),500))}listenServerMsg(){console.log("[MoneyComing] 设置 WebSocket 监听器..."),c.sktMsgListener.add(p.SPIN,l,(t=>{console.log("[MoneyComing] 收到 SPIN 响应:",t),this.dispatch(M(t.results))}))}playBgMusic(){this.comp.scheduleOnce((()=>{f.stop(),this.comp.scheduleOnce((()=>{f.play(y.bg,!0)}))}))}unMountCallBack(){c.sktMsgListener.remove(p.SPIN,l)}})||A)||A);e._RF.pop()}}}));

System.register("chunks:///_virtual/index80.ts",["cc","./redux.mjs_cjs=&original=.js","./index83.ts","./redux.js"],(function(e){var t,n,o;return{setters:[function(e){t=e.cclegacy},null,function(e){n=e.rootReducer},function(e){o=e.default}],execute:function(){let r;e("store",void 0),t._RF.push({},"25c02KUwCBEBKpdOTVmCIxz","index",void 0);const c=t=>{if(!r){const t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose;r=e("store",o.createStore(n,t(o.applyMiddleware())))}return r};e("default",{configureStore:c});e("getStore",(()=>(r||c(),r)));t._RF.pop()}}}));

System.register("chunks:///_virtual/index81.ts",["cc","./prefabDefine21.ts","./soundDefine21.ts"],(function(e){var n,t,u;return{setters:[function(e){n=e.cclegacy},function(e){t=e.default},function(e){u=e.default}],execute:function(){n._RF.push({},"668502f67VE45lcjAlGJjuA","index",void 0);const c=e("bundlePkgName","moneyComing");e("default",[...t(c),...u(c)]);n._RF.pop()}}}));

System.register("chunks:///_virtual/index82.ts",["cc","./LoaderPanelViewModel.ts","./AudioMgr.ts","./config20.ts","./socketConnect20.ts","./index81.ts","./prefabDefine21.ts","./index80.ts","./game37.ts","./index60.ts","./baseBoard.ts","./index69.ts","./hallType2.ts","./WebSocketStarter.ts","./GameMainViewModel2.ts","./AnimationViewModel.ts","./listenerFactoy.ts","./UseSetOption.ts","./config17.ts"],(function(e,o){var n,t,i,l,c,a,d,s,m,u,g,r,M,p,w,f,y,h,C,S,G,b,A,v,V,k;return{setters:[function(e){n=e.cclegacy,t=e.assetManager,i=e.Prefab},function(e){l=e.default},function(e){c=e.AudioMgr},function(e){a=e.default},function(e){d=e.default},function(e){s=e.bundlePkgName,m=e.default},function(e){u=e.PrefabPathDefine},function(e){g=e.default},function(e){r=e.updateBalance},function(e){M=e.global,p=e.lang},function(e){w=e.setSubGameRunState,f=e.addToastAction,y=e.setSubGameInfoAction,h=e.setLoadingAction},function(e){C=e.getStore},function(e){S=e.SubGameRunState},function(e){G=e.default},function(e){b=e.GameMainViewModel},function(e){A=e.AnimationViewModel},function(e){v=e.listenerFactoy},function(e){V=e.setActiveAudio},function(e){k=e.subGameList}],execute:function(){e({animationViewModel:void 0,gameMainViewModel:void 0,moneyComing_Audio:void 0}),n._RF.push({},"9168eZ7yHlO0IqoXiXqc0yH","index",void 0);let N,_,I,L,W=[],D=e("bundleMoneyComing",null);const R=e("sourceManageSeletor",((e=s)=>W.find((o=>o.bundle.name===e))));e("NORMAL_MAG_TYPE",function(e){return e[e.CHANGE_GAME=0]="CHANGE_GAME",e}({}));e("msgListener",v());let T=0;e("startUp",(n=>{g.configureStore(),t.loadBundle(s,((t,s)=>{D=e("bundleMoneyComing",s),D.load(u.LOAING_PANEL,i,((e,o)=>{}),((t,i)=>{M.isAllowOpenSubGame(a.gameId)&&(M.hallDispatch(w(S.READY)),L=(new l).mountView(i).appendTo(n).setProps({loadBarType:1}).setEvent({onLoadDone:t=>{W=t,I=e("moneyComing_Audio",new c(R())),V(I),T=window.setTimeout((()=>{M.closeSubGame({confirmContent:p.write((e=>e.InitGameModule.GameBoardInit)),confirmDoneBeforeFn:()=>i(L,T)}),M.hallDispatch(f({content:p.write((e=>e.InitGameModule.GameBoardInit),{},{placeStr:"game init failed"})}))}),1e4);const i=(e,o)=>{e.unMount(),window.clearTimeout(o)};L.comp.setTipContent(p.write((e=>e.WebSocketModule.GameInit),{},{placeStr:"Game init..."})),M.hallDispatch(w(S.RUN)),console.log("[MoneyComing] 开始初始化 WebSocket..."),d().then((()=>{console.log("[MoneyComing] WebSocket 初始化成功"),C().dispatch(r(1e4)),console.log("[MoneyComing] 初始余额已设置为 10000");const t=R().getFile(u.GAME_MAIN);if(console.log("[MoneyComing] 获取 prefab:",t?"成功":"失败",t),!t||!t.source)return console.error("[MoneyComing] 游戏主界面 prefab 未找到或无效！"),M.hallDispatch(f({content:"游戏资源加载失败"})),void M.closeSubGame();console.log("[MoneyComing] 创建 GameMainViewModel..."),N=e("gameMainViewModel",(new b).mountView(t.source).appendTo(n).connect(C().getState())),console.log("[MoneyComing] GameMainViewModel 创建完成，节点:",N.viewNode),console.log("[MoneyComing] 创建 AnimationViewModel..."),_=e("animationViewModel",new A),_.viewNode=N.viewNode,_.comp=N.comp,_.connect(C().getState()),console.log("[MoneyComing] 根节点:",n,"子节点数量:",n.children.length);const l=N.viewNode.getChildByPath("lucky_wheel");l?(console.log("[MoneyComing] Found lucky_wheel node, attaching LuckyWheelViewModel"),o.import("./MoneyComing_LuckyWheel.ts").then((({MoneyComing_LuckyWheel:e})=>{let n=l.getComponent(e);n||(n=l.addComponent(e)),o.import("./LuckyWheelViewModel.ts").then((({LuckyWheelViewModel:e})=>{const o=new e;o.viewNode=l,o.comp=n,o.connect(),N.luckyWheelViewModel=o,console.log("[MoneyComing] LuckyWheelViewModel attached and connected")}))}))):console.error("[MoneyComing] Could not find lucky_wheel node"),o.import("./MoneyComing_Respin.ts").then((({MoneyComing_Respin:e})=>{let n=N.viewNode.getComponent(e);n||(n=N.viewNode.addComponent(e)),o.import("./RespinViewModel.ts").then((({RespinViewModel:e})=>{const o=new e;o.viewNode=N.viewNode,o.comp=n,o.connect(),o.setGameMain(N.comp),N.respinViewModel=o,console.log("[MoneyComing] RespinViewModel attached and connected")}))})),L.viewNode.isValid&&L.viewNode.setSiblingIndex(L.viewNode.parent.children.length),setTimeout((()=>{console.log("[MoneyComing] 卸载加载面板..."),i(L,T),console.log("[MoneyComing] 游戏初始化完成！")}),100)})).catch((e=>{console.error("[MoneyComing] WebSocket 初始化失败:",e),L.comp.setTipContent(e||"WebSocket connection error"),M.hallDispatch(f({content:"WebSocket 连接失败"}))}))}}).setProps({versionStr:`md5: ${k&&k.find((e=>e.gameId===a.gameId))?k.find((e=>e.gameId===a.gameId)).md5:""}`}),L.comp.startLoad([s],[...m]))}))}))})),e("stopGame",(()=>{console.log("[MoneyComing] stopGame called"),M.hallDispatch(y(null)),M.hallDispatch(h({isShow:!1,flagId:s})),console.log("[MoneyComing] setLoadingAction dispatched"),T&&window.clearTimeout(T),G.Instance().eventListener.removeById(s),L&&L.unMount(),N&&N.unMount(),console.log("[MoneyComing] 游戏卸载完成！",I),I&&(I.stop(),I.longStop(),I.remove(),I=e("moneyComing_Audio",null)),console.log("[MoneyComing] stopGame completed")}));n._RF.pop()}}}));

System.register("chunks:///_virtual/index83.ts",["cc","./index.mjs_cjs=&original=2.js","./game37.ts","./index2.js"],(function(t){var n,e,i,o,u,s,r,c,a;return{setters:[function(t){n=t.cclegacy},null,function(t){e=t.updateBalance,i=t.updateBet,o=t.updateWin,u=t.setSpinning,s=t.setSpinResults,r=t.setTurboMode,c=t.setAutoSpin},function(t){a=t.default}],execute:function(){n._RF.push({},"6fb59NzZ7JMAbVTDMEx39UD","index",void 0);const p=a.createReducer({[e.toString()]:(t,n)=>({...t,balance:n}),[i.toString()]:(t,n)=>({...t,betAmount:n}),[o.toString()]:(t,n)=>({...t,winAmount:n}),[u.toString()]:(t,n)=>({...t,isSpinning:n}),[s.toString()]:(t,n)=>({...t,spinResults:n}),[r.toString()]:(t,n)=>({...t,turboMode:n}),[c.toString()]:(t,n)=>({...t,autoSpin:n})},{balance:2e4,betAmount:10,winAmount:0,spinResults:[],isSpinning:!1,turboMode:0,autoSpin:!1});t("rootReducer",p);n._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelRotator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,r,n,a,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.initializerDefineProperty},function(t){i=t.cclegacy,r=t.Node,n=t._decorator,a=t.Component,s=t.tween}],execute:function(){var u,h,c,l,R,p,g,d,_;i._RF.push({},"49b6bvzj2NO17Z1y2g/1Pi6","LuckyWheelRotator",void 0);const{ccclass:b,property:y}=n;t("LuckyWheelRotator",(u=b("LuckyWheelRotator"),h=y({tooltip:"旋转速度（度/秒）"}),c=y({tooltip:"是否自动开始旋转"}),l=y({type:r,tooltip:"旋转的目标节点，默认为当前节点"}),u((g=e((p=class extends a{constructor(...t){super(...t),o(this,"rotationSpeed",g,this),o(this,"autoStart",d,this),o(this,"targetNode",_,this),this._isRotating=!1,this._currentRotation=0,this.betAmount=0}onLoad(){this.targetNode||(this.targetNode=this.node),this._currentRotation=this.targetNode.eulerAngles.z,this.autoStart&&this.startRotation()}update(t){if(!this._isRotating||!this.targetNode||this.betAmount<=1)return;const e=this.rotationSpeed*t;this._currentRotation+=e,this._currentRotation>=360?this._currentRotation-=360:this._currentRotation<0&&(this._currentRotation+=360),this.targetNode.setRotationFromEuler(0,0,this._currentRotation)}startRotation(){this._isRotating=!0}stopRotation(){this._isRotating=!1}setRotationSpeed(t){this.rotationSpeed=t}toggleRotation(){this._isRotating=!this._isRotating}resetRotation(){this._currentRotation=0,this.targetNode&&this.targetNode.setRotationFromEuler(0,0,0)}setCurrentRotation(t){this._currentRotation=t,this.targetNode&&this.targetNode.setRotationFromEuler(0,0,t)}spinTo(t,e,o){this._isRotating=!1;const i={angle:this._currentRotation};let r=0;if(this.rotationSpeed<0){let e=this._currentRotation%360;e>0&&(e-=360);let o=t;o>0&&(o-=360);let i=o-e;i>0&&(i-=360),r=this._currentRotation+i-1800}else{let e=this._currentRotation%360;e<0&&(e+=360);let o=t-e;o<0&&(o+=360),r=this._currentRotation+o+1800}s(i).to(e,{angle:r},{easing:"cubicOut",onUpdate:()=>{this.setCurrentRotation(i.angle)},onComplete:()=>{this._isRotating=!1,o&&o()}}).start()}}).prototype,"rotationSpeed",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),d=e(p.prototype,"autoStart",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_=e(p.prototype,"targetNode",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=p))||R));i._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelViewModel.ts",["cc","./ViewModel.ts","./index80.ts"],(function(e){var t,o,c,n,i;return{setters:[function(e){t=e.cclegacy,o=e._decorator},function(e){c=e.StoreInject,n=e.default},function(e){i=e.getStore}],execute:function(){var s;t._RF.push({},"d868bL/mA1HU6Cbby25yYM5","LuckyWheelViewModel",void 0);const{ccclass:u}=o;e("LuckyWheelViewModel",c(i())(s=u("LuckyWheelViewModel")(s=class extends n{constructor(){super("MoneyComing_LuckyWheel")}begin(){}connect(){return this.inject({},(e=>({betAmount:e.betAmount}))),this}spin(e,t){this.comp?this.comp.spin(e,t):(console.error("[LuckyWheelViewModel] Component not found"),t())}})||s)||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_GameMain.ts",["cc","./BaseComponent.ts","./MoneyComing_Wheel.ts","./SymbolAnimator.ts","./AnimationUtils.ts","./index82.ts","./soundDefine21.ts"],(function(e){var t,o,n,i,s,r,a,l,p,c,h,d,_,u,m,b,g,y;return{setters:[function(e){t=e.cclegacy,o=e.Button,n=e.Label,i=e.Node,s=e.Color,r=e.UITransform,a=e.sp,l=e.assetManager,p=e.SpriteFrame,c=e.Sprite,h=e.tween,d=e._decorator},function(e){_=e.BaseComponent},function(e){u=e.MoneyComing_Wheel},function(e){m=e.SymbolAnimator},function(e){b=e.AnimationUtils},function(e){g=e.moneyComing_Audio},function(e){y=e.SoundPathDefine}],execute:function(){var f;t._RF.push({},"93351gVVfJBKKOjeFsktmEg","MoneyComing_GameMain",void 0);const{ccclass:w,property:N}=d;e("MoneyComing_GameMain",w("MoneyComing_GameMain")(f=class extends _{constructor(...e){super(...e),this.wheels=[],this.betSelectionNode=null,this.propertyNode={props_spin_btn:new o,props_bet_btn:new o,props_auto_btn:new o,props_turbo:new o,props_balance_label:new n,props_win_label:new n,props_bet_label:new n,props_unlock_1:new i,props_unlock_5:new i,props_unlock_10:new i,props_unlock_50:new i,props_brand_board:new i,props_feature_board:new i,props_lucky_wheel_1_5_10:new i,props_lucky_wheel_50_100:new i,props_lucky_wheels:new i,props_win_effect:new i,props_setting:new i,props_setting_selection:new i,props_setting_back:new i},this.wheel3LockNode=null,this.luckyWheelLockNode=null,this.props={balance:2e4,betAmount:10,winAmount:0,spinResults:[],isSpinning:!1,turboMode:0,autoSpin:!1},this.events={onSpin:()=>{},onAutoSpin:()=>{},onTurbo:()=>{},onBetChange:e=>{},onSpinComplete:()=>{}}}initState(){return{}}start(){console.log("[GameMain] start: current props.betAmount =",this.props.betAmount),this.props.betAmount>0?(console.log("[GameMain] start: forcing UI update for betAmount:",this.props.betAmount),this.updateUnlockLevels(this.props.betAmount),this.highlightCurrentBet(this.props.betAmount),this.updateUnlockLevels(this.props.betAmount),this.highlightCurrentBet(this.props.betAmount),this.propertyNode.props_bet_label&&(this.propertyNode.props_bet_label.string=this.props.betAmount.toFixed(2))):console.warn("[GameMain] start: betAmount is 0, waiting for props update...")}bindEvent(){this.propertyNode.props_spin_btn&&this.propertyNode.props_spin_btn.node.on(i.EventType.TOUCH_END,(()=>{this.hideBetSelection(),this.hideSettingSelection(),g.playOneShot(y.spin),this.events.onSpin()})),this.propertyNode.props_auto_btn&&this.propertyNode.props_auto_btn.node.on(i.EventType.TOUCH_END,(()=>{this.hideBetSelection(),this.events.onAutoSpin()})),this.propertyNode.props_turbo&&this.propertyNode.props_turbo.node.on(i.EventType.TOUCH_END,(()=>{this.hideBetSelection(),this.events.onTurbo()})),this.propertyNode.props_bet_btn&&this.propertyNode.props_bet_btn.node.on(i.EventType.TOUCH_END,(()=>this.toggleBetSelection())),this.propertyNode.props_setting&&this.propertyNode.props_setting.on(i.EventType.TOUCH_END,(()=>{this.onSettingClick()})),this.propertyNode.props_setting_back&&this.propertyNode.props_setting_back.on(i.EventType.TOUCH_END,(()=>{this.onBackToHallClick()}))}onSettingClick(){this.props.isSpinning||this.props.autoSpin||this.propertyNode.props_setting_selection&&(this.propertyNode.props_setting_selection.active=!0)}hideSettingSelection(){this.propertyNode.props_setting_selection&&(this.propertyNode.props_setting_selection.active=!1)}onBackToHallClick(){window.HALL_GLOBAL&&window.HALL_GLOBAL.closeSubGame?window.HALL_GLOBAL.closeSubGame():console.error("[GameMain] window.HALL_GLOBAL.closeSubGame is not available")}hideBetSelection(){this.betSelectionNode&&this.betSelectionNode.active&&(this.betSelectionNode.active=!1)}toggleBetSelection(){this.betSelectionNode&&(this.betSelectionNode.active=!this.betSelectionNode.active,console.log("[GameMain] toggleBetSelection:",this.betSelectionNode.active),this.betSelectionNode.active&&this.highlightCurrentBet())}highlightCurrentBet(e=this.props.betAmount){if(!this.betSelectionNode)return;const t=[1,5,10,50,100];for(const n of t){const t=this.betSelectionNode.getChildByPath(`hLayout / betOptionLayout / betOption${n} `);if(t){const i=t.getComponentInChildren(o);i&&(i.normalColor=n===e?new s(150,150,150,255):new s(50,50,50,255))}}}updateUnlockLevels(e){const t={1:this.propertyNode.props_unlock_1,5:this.propertyNode.props_unlock_5,10:this.propertyNode.props_unlock_10,50:this.propertyNode.props_unlock_50};Object.keys(t).forEach((e=>{const o=t[e];o&&o.isValid&&(o.active=!1)}));const o=(e,t,o)=>{e&&e.isValid&&(e.active=t,e.setPosition(e.position.x,o,e.position.z))};switch(e){case 1:o(t[1],!0,-30),o(t[5],!0,30);break;case 5:o(t[5],!0,-30),o(t[10],!0,30);break;case 10:o(t[10],!0,-30),o(t[50],!0,30);break;case 50:case 100:o(t[10],!0,-30),o(t[50],!0,30)}-1!==[1,5,10].indexOf(e)?this.playBrandTextAnimation("down_start","down_cycle"):this.playBrandTextAnimation("up_start","up_cycle"),this.updateFeatureWheel(e)}updateFeatureWheel(e){if(this.wheels.length<4)return;const t=this.wheels[3];if(!t)return;const o=this.getAvailableFeatureElements(e);console.log(`[GameMain] updateFeatureWheel: bet = ${e}, elements = [${o.join(", ")}]`),t.setVisibleElements(o)}getAvailableFeatureElements(e){const t=["feature_x2","feature_x5","feature_all_respin"];return 1===e?t:5===e?[...t,"feature_scatter"]:10===e?[...t,"feature_x10","feature_scatter"]:50===e||100===e?[...t,"feature_x10","feature_scatter_50_100"]:t}playBrandTextAnimation(e,t){const o=this.propertyNode.props_brand_board;if(!o||!o.isValid)return;let n=o.getChildByName("payboard_light_anim");n||(n=new i("payboard_light_anim"),o.addChild(n));n.setSiblingIndex(2),n.layer=o.layer;let s=n.getComponent(r);s||(s=n.addComponent(r));const p=o.getComponent(r);p&&(s.contentSize=p.contentSize);let c=n.getComponent(a.Skeleton);c||(c=n.addComponent(a.Skeleton)),c.premultipliedAlpha=!0;const h="spine/payboard_Light/payboard_Light",d=l.getBundle("moneyComing");d?c.skeletonData&&"payboard_Light"===c.skeletonData.name?this.playSkeletonAnimation(c,e,t):d.load(h,a.SkeletonData,((o,n)=>{!o&&c&&c.isValid?(c.skeletonData=n,this.playSkeletonAnimation(c,e,t)):console.error(`[GameMain] Failed to load skeleton data for ${h}`,o)})):console.error("[GameMain] Cannot find bundle: moneyComing")}playSkeletonAnimation(e,t,o){if(e.animation===o)return;e.setAnimation(0,t,!1)?e.setCompleteListener((()=>{e.setAnimation(0,o,!0),e.setCompleteListener(null)})):e.setAnimation(0,o,!0)}onBetAmountSelected(e){console.log("[GameMain] onBetAmountSelected:",e),this.events.onBetChange(e),this.betSelectionNode&&(this.betSelectionNode.active=!1)}initBetSelection(){if(!this.betSelectionNode)return;console.log("[GameMain] 开始初始化 betSelection，节点:",this.betSelectionNode.name),console.log("[GameMain] betSelection 子节点:",this.betSelectionNode.children.map((e=>e.name)));const e=[1,5,10,50,100];for(const t of e){const e=`hLayout/betOptionLayout/betOption${t}`;let n=null;if(n=this.betSelectionNode.getChildByPath(e),n){console.log(`[GameMain] 找到投注按钮节点: ${t}, 路径: ${e} `);const s=n.getComponentInChildren(o);s?(s.node.on(i.EventType.TOUCH_END,(()=>{console.log(`[GameMain] 投注按钮被点击: ${t} `),this.onBetAmountSelected(t)})),console.log(`[GameMain] ✅ 成功绑定投注按钮: ${t} `)):console.warn(`[GameMain] ⚠️ 节点 ${e} 的子节点中没有 Button 组件`)}else console.warn(`[GameMain] ❌ 未找到投注按钮节点: ${t}，尝试的路径: `,e)}}useProps(e,t){if("balance"===e&&this.propertyNode.props_balance_label&&void 0!==t.cur&&null!==t.cur&&(this.propertyNode.props_balance_label.string=t.cur.toFixed(2)),"winAmount"===e&&this.propertyNode.props_win_label&&void 0!==t.cur&&null!==t.cur&&(this.propertyNode.props_win_label.string=t.cur.toFixed(2)),"betAmount"===e&&(console.log("[GameMain] useProps: betAmount changed to:",t.cur),this.propertyNode.props_bet_label&&void 0!==t.cur&&null!==t.cur?(this.propertyNode.props_bet_label.string=t.cur.toFixed(2),console.log("[GameMain] useProps: updated props_bet_label to:",this.propertyNode.props_bet_label.string),console.log("[GameMain] useProps: updated props_bet_label to:",this.propertyNode.props_bet_label.string),this.updateUnlockLevels(t.cur),this.highlightCurrentBet(t.cur),this.wheels.forEach(((e,t)=>{m.stopAllAnimations(e.node),this.stopExpectAnimation(t)}))):console.warn("[GameMain] useProps: props_bet_label is missing or value is invalid")),"isSpinning"===e){const e=t.cur,n=this.props.autoSpin;if(console.log(`[GameMain] useProps: isSpinning changed to ${e}, isAutoSpin = ${n} `),this.propertyNode.props_spin_btn&&(this.propertyNode.props_spin_btn.interactable=!e&&!n,console.log(`[GameMain] Updated spin_btn interactable: ${this.propertyNode.props_spin_btn.interactable} `)),this.propertyNode.props_bet_btn&&(this.propertyNode.props_bet_btn.interactable=!e&&!n),this.propertyNode.props_setting){const t=this.propertyNode.props_setting.getComponent(o);t&&(t.interactable=!e&&!n)}this.propertyNode.props_turbo&&(this.propertyNode.props_turbo.interactable=!e&&!n),this.propertyNode.props_auto_btn&&(this.propertyNode.props_auto_btn.interactable=n||!e),e&&!t.pre&&this.startSpin()}if("spinResults"===e&&t.cur&&t.cur.length>0&&this.props.isSpinning&&this.stopSpin(t.cur),"turboMode"===e&&this.updateTurboButtonSprite(t.cur),"autoSpin"===e){const e=t.cur,n=this.props.isSpinning;if(this.propertyNode.props_spin_btn&&(this.propertyNode.props_spin_btn.interactable=!n&&!e),this.propertyNode.props_bet_btn&&(this.propertyNode.props_bet_btn.interactable=!n&&!e),this.propertyNode.props_setting){const t=this.propertyNode.props_setting.getComponent(o);t&&(t.interactable=!n&&!e)}this.propertyNode.props_turbo&&(this.propertyNode.props_turbo.interactable=!n&&!e),this.propertyNode.props_auto_btn&&(this.propertyNode.props_auto_btn.interactable=e||!n)}}updateTurboButtonSprite(e){if(!this.propertyNode.props_turbo)return;let t="";if(0===e?t="texture/ui/controls/normal":1===e?t="texture/ui/controls/turbo":2===e&&(t="texture/ui/controls/super_turbo"),!t)return;console.log("[GameMain] 切换 Turbo 按钮素材:",t);const o=l.getBundle("moneyComing");o?o.load(`${t}/spriteFrame`,p,((e,o)=>{if(e||!o)return void console.error(`[GameMain] Failed to load turbo button image: ${t}`,e);const n=this.propertyNode.props_turbo.node.getComponent(c);n?n.spriteFrame=o:console.warn("[GameMain] Sprite component not found on turbo button")})):console.error("[GameMain] Cannot find moneyComing bundle")}bindUI(){console.log("[GameMain] bindUI: props_bet_label bound?",this.propertyNode.props_bet_label?"YES":"NO"),this.propertyNode.props_bet_label&&console.log("[GameMain] bindUI: props_bet_label string:",this.propertyNode.props_bet_label.string),this.betSelectionNode=this.node.getChildByPath("control_panel/controls/betSelection"),this.betSelectionNode?(this.betSelectionNode.active=!1,this.initBetSelection()):console.warn("[GameMain] betSelection 节点未找到，请在 Cocos Creator prefab 中创建该节点，路径：control_panel/controls/betSelection"),this.wheels=[];["wheels_container/wheels_layout/wheel_frame/wheels/wheel1","wheels_container/wheels_layout/wheel_frame/wheels/wheel2","wheels_container/wheels_layout/wheel_frame/wheels/wheel3","wheels_container/wheels_layout/wheel_frame/wheels/wheel_feature"].forEach(((e,t)=>{const o=this.node.getChildByPath(e);if(o){let e=o.getComponent(u);e||(e=o.addComponent(u)),e.symbolContainer||(e.symbolContainer=o.getChildByName("symbol_container")),e.wheelType=t<3?"coin":"feature",e.bundle="moneyComing",this.wheels.push(e)}else console.warn(`Wheel node not found: ${e}`)})),this.initLockNodes();const e=this.node.getChildByPath("control_panel/controls/props_setting_selection");if(e){this.propertyNode.props_setting_selection=e,e.active=!1,console.log("[GameMain] props_setting_selection bound successfully");const t=e.getChildByPath("OptionLayout/props_setting_back");t&&(this.propertyNode.props_setting_back=t,t.on(i.EventType.TOUCH_END,(()=>{this.onBackToHallClick()})),console.log("[GameMain] props_setting_back bound successfully"))}else console.warn("[GameMain] props_setting_selection node not found at control_panel/controls/props_setting_selection");const t=this.node.getChildByPath("lucky_wheel/brand/board/props_brand_board");t&&(this.propertyNode.props_brand_board=t,console.log("[GameMain] props_brand_board bound successfully"));const o=this.node.getChildByPath("lucky_wheel/brand/board/props_feature_board");o&&(this.propertyNode.props_feature_board=o,o.active=!1,console.log("[GameMain] props_feature_board bound successfully"))}initLockNodes(){const e=this.wheels[2];if(e&&e.node){let t=e.node.getChildByName("wheel_lock_node");t||(t=new i("wheel_lock_node"),e.node.addChild(t),t.setPosition(0,0,0)),t.layer=e.node.layer,t.setSiblingIndex(e.node.children.length-1),t.active=!1,this.wheel3LockNode=t,console.log("[GameMain] initLockNodes: Wheel 3 lock node created/found")}else console.error("[GameMain] initLockNodes: Wheel 3 not found");const t=this.propertyNode.props_lucky_wheel_1_5_10;if(t){let e=t.getChildByName("wheel_lock_node");e||(e=new i("wheel_lock_node"),t.addChild(e),e.setPosition(0,0,0)),e.layer=t.layer,e.setSiblingIndex(t.children.length-1),e.active=!1,this.luckyWheelLockNode=e,console.log("[GameMain] initLockNodes: Lucky Wheel lock node created/found on",t.name)}else console.error("[GameMain] initLockNodes: props_lucky_wheel_1_5_10 not bound")}startSpin(){this.wheels.forEach((e=>{m.stopAllAnimations(e.node)})),this.hideFeaturePanel(),this.wheels.forEach(((e,t)=>{1===this.props.betAmount&&2===t||e.startSpin()}))}stopSpin(e){console.log("[GameMain] stopSpin 开始, results:",e,"wheels数量:",this.wheels.length);let t=0;this.wheels.forEach(((o,n)=>{const i=e[n]||"";console.log(`[GameMain] 停止 wheel ${n}, result:`,i),this.scheduleOnce((()=>{g.playOneShot(y.spinOver),o.stop(i,(()=>{t++,console.log(`[GameMain] wheel ${n} 停止完成, stoppedCount:`,t,"/",this.wheels.length),t===this.wheels.length&&(console.log("[GameMain] 所有 wheel 停止完成，触发 onSpinComplete"),this.events.onSpinComplete())}))}),.2*n)}))}startRespin(){console.log("[GameMain] startRespin");for(let e=0;e<3;e++)this.wheels[e]&&m.stopAllAnimations(this.wheels[e].node);this.wheels.forEach(((e,t)=>{3!==t&&(1===this.props.betAmount&&2===t||(e.startSpin(),this.playExpectAnimation(t)))}))}stopRespin(e,t){console.log("[GameMain] stopRespin, results:",e);let o=0;const n=[];this.wheels.forEach(((e,t)=>{3!==t&&(1===this.props.betAmount&&2===t||n.push(e))})),n.forEach(((i,s)=>{const r=this.wheels.indexOf(i),a=e[r]||"";this.scheduleOnce((()=>{i.stop(a,(()=>{this.stopExpectAnimation(r),o++,o===n.length&&(console.log("[GameMain] stopRespin complete"),t())}))}),.2*s)}))}showFeaturePanel(e,t="all_respin",o=1){const i=this.propertyNode.props_brand_board,s=this.propertyNode.props_feature_board;if(!i||!s)return void console.warn("[GameMain] Brand or Feature board nodes missing");console.log(`[GameMain] showFeaturePanel: baseWin=${e}, type=${t}`);s.parent===i?(console.log("[GameMain] featureBoard is a child of brandBoard. Keeping brandBoard active."),i.active=!0):i.active=!1,s.active=!0;const r=s.getChildByPath("right");if(r){const e=r.getChildByName("all_respin"),n=r.getChildByName("scatter"),i=r.getChildByName("scatter_50_100");e&&(e.active=!1),n&&(n.active=!1),i&&(i.active=!1),"all_respin"===t&&e?e.active=!0:"scatter"===t&&(-1!==[50,100].indexOf(o)&&i?i.active=!0:n&&(n.active=!0))}const a=s.getChildByPath("base_value")?.getComponent(n);a&&(a.string=e.toString());const l=s.getChildByPath("bonus_value")?.getComponent(n);l&&(l.string="0")}updateFeatureBonus(e){const t=this.propertyNode.props_feature_board;if(!t||!t.active)return;const o=t.getChildByPath("bonus_value")?.getComponent(n);o&&(o.string=e.toString())}playFeatureSymbolAnimation(e){if(this.wheels.length<4)return;const t=this.wheels[3];if(!t)return;const o=t.getDisplayedElement();if(o){console.log(`[GameMain] Playing feature symbol animation: ${e} on ${o.name}`);const n=o.getWorldPosition();m.playAnimationAt(t.node,n,e,"moneyComing",!0)}}playWinAnimations(e){console.log("[GameMain] playWinAnimations:",e),this.wheels.forEach((e=>{m.stopAllAnimations(e.node)}));const t=1===this.props.betAmount?2:3,o=e[3];let n="";for(let o=0;o<t;o++){const t=e[o];t&&t.startsWith("element_")&&(n+=t.replace("element_",""))}const i=n?parseInt(n,10):0;if(i>0){let o=-1;for(let n=0;n<t;n++){const t=e[n];if(t&&t.startsWith("element_")){const e=t.replace("element_","");if("0"!==e&&"00"!==e){o=n;break}}}if(-1!==o)for(let n=o;n<t;n++){const t=e[n];if(t&&t.startsWith("element_")){const e=this.wheels[n],o=e.getDisplayedElement();if(o){const n=o.getWorldPosition();m.playAnimationAt(e.node,n,t,"moneyComing",!0)}}}}if(o){const e=o.includes("x"),t=o.includes("scatter"),n="feature_all_respin"===o;if(i>0&&e||t||n){const e=this.wheels[3],t=e.getDisplayedElement();if(t){const n=t.getWorldPosition();m.playAnimationAt(e.node,n,o,"moneyComing",!0)}}}}playExpectAnimation(e){if(e<0||e>=this.wheels.length)return;const t=this.wheels[e];if(!t||!t.node)return;const o=this.node,n=`expect_anim_${e}`;let s=o.getChildByName(n);s||(s=new i(n),o.addChild(s));const p=t.node.getWorldPosition(),c=o.getComponent(r)?.convertToNodeSpaceAR(p)||p;s.setPosition(c),s.setScale(1,.95,1),s.setSiblingIndex(o.children.length-1),s.active=!0;let h=s.getComponent(a.Skeleton);h||(h=s.addComponent(a.Skeleton)),h.premultipliedAlpha=!0;const d="spine/expect/expect",_=l.getBundle("moneyComing");_&&_.load(d,a.SkeletonData,((e,t)=>{!e&&h&&h.isValid?(h.skeletonData=t,h.setAnimation(0,"light01",!0)):console.error(`[GameMain] Failed to load expect spine: ${d}`,e)}))}stopExpectAnimation(e){if(e<0||e>=this.wheels.length)return;const t=this.wheels[e];if(!t||!t.node)return;const o=t.node.parent;if(!o)return;if(!o.parent)return;const n=`expect_anim_${e}`,i=this.node.getChildByName(n);i&&i.destroy()}playBigWinEffect(e,t,o){console.log(`[GameMain] playBigWinEffect: type=${e}, amount=${t}`),g.playOneShot(y.bigWin);const i=this.propertyNode.props_win_effect;if(!i)return console.error("[GameMain] props_win_effect node not found!"),void o();i.active=!0;const s=`${e}win_start`,r=`${e}win_cycle`,l=i.getChildByName("point");if(l){const e=l.getComponent(a.Skeleton);e&&(e.setAnimation(0,"win_start",!1),e.addAnimation(0,"win_cycle",!0));const o=l.getComponentInChildren(n);if(o){h({value:0}).to(2,{value:t},{onUpdate:e=>{o.string=e.value.toFixed(2)}}).start()}}const p=i.getChildByName("win_back");if(p){const e=p.getComponent(a.Skeleton);e&&(e.setAnimation(0,s,!1),e.addAnimation(0,r,!0))}const c=i.getChildByName("win_front");if(c){const e=c.getComponent(a.Skeleton);e&&(e.setAnimation(0,s,!1),e.addAnimation(0,r,!0))}this.scheduleOnce((()=>{i.active=!1,o()}),5)}playScatterFlyAnimation(e,t){if(console.log(`[GameMain] playScatterFlyAnimation: betAmount=${e}`),this.wheels.length<4)return void t();const o=this.wheels[3].node;let n="";1===e||5===e||10===e?n="props_lucky_wheel_1_5_10/money_bg":50!==e&&100!==e||(n="props_lucky_wheel_50_100/money_bg");const i=this.propertyNode.props_lucky_wheels;if(!i)return console.error("[GameMain] Lucky wheels node not found"),void t();const s=i.getChildByPath(n);if(!o||!s)return console.error(`[GameMain] Start or End node not found. Start: ${o?.name}, End: ${s?.name}`),void t();const r=this.node;g.playOneShot(y.allRespinScatter),b.playImage("moneyComing",o,s,r,(()=>{console.log("[GameMain] Scatter fly animation completed"),t()}),"up")}hideFeaturePanel(){const e=this.propertyNode.props_brand_board,t=this.propertyNode.props_feature_board;if(e&&t&&t.active){console.log("[GameMain] hideFeaturePanel");t.parent===e?(t.active=!1,e.active=!0):(e.active=!0,t.active=!1)}}})||f);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_LuckyWheel.ts",["cc","./BaseComponent.ts","./LuckyWheelRotator.ts","./index82.ts","./soundDefine21.ts"],(function(e){var t,o,n,s,i,r,c,l;return{setters:[function(e){t=e.cclegacy,o=e.Node,n=e.sp,s=e._decorator},function(e){i=e.BaseComponent},function(e){r=e.LuckyWheelRotator},function(e){c=e.moneyComing_Audio},function(e){l=e.SoundPathDefine}],execute:function(){var u;t._RF.push({},"14404rPkqdIX447vdvVabHH","MoneyComing_LuckyWheel",void 0);const{ccclass:p,property:h}=s;e("MoneyComing_LuckyWheel",p("MoneyComing_LuckyWheel")(u=class extends i{constructor(...e){super(...e),this.rotators=[],this.propertyNode={props_lucky_wheel_1_5_10:new o,props_lucky_wheel_50_100:new o},this.props={betAmount:1},this.events={}}bindEvent(){}initState(){return{}}bindUI(){this.initRotators(),console.log("[LuckyWheel] bindUI: forcing initial update with betAmount=",this.props.betAmount),this.updateWheelState(this.props.betAmount)}initRotators(){[this.propertyNode.props_lucky_wheel_1_5_10,this.propertyNode.props_lucky_wheel_50_100].forEach((e=>{if(e&&e.isValid){["money","money_upgrade","money_bg"].forEach((t=>{const o=e.getChildByName(t);if(o){let e=o.getComponent(r);e||(e=o.addComponent(r)),e.autoStart=!0,e.rotationSpeed=-10,e.startRotation(),this.rotators.push(e)}}))}}))}useProps(e,t){console.log(`[LuckyWheel] useProps: key=${e}, pre=${t.pre}, cur=${t.cur}`),"betAmount"===e&&this.updateWheelState(t.cur)}updateWheelState(e){console.log(`[LuckyWheel] updateWheelState: betAmount=${e}`),this.rotators.forEach((t=>t.betAmount=e));const t=this.propertyNode.props_lucky_wheel_1_5_10,o=this.propertyNode.props_lucky_wheel_50_100;console.log(`[LuckyWheel] Nodes: 1_5_10=${t?.name}, 50_100=${o?.name}`),t&&o&&(-1!==[1,5,10].indexOf(e)?(console.log("[LuckyWheel] Showing 1_5_10"),t.active=!0,o.active=!1,this.updateWheelContent(t,e)):(console.log("[LuckyWheel] Showing 50_100"),t.active=!1,o.active=!0,this.updateWheelContent(o,e)))}updateWheelContent(e,t){const o=e.getChildByName("money"),n=e.getChildByName("money_upgrade"),s=e.getChildByName("money_bg");let i=!1;i=1===t||5===t||50===t;let c=0;if(s&&(c=s.eulerAngles.z),o&&(o.active=i,i&&s)){o.setRotationFromEuler(0,0,c);const e=o.getComponent(r);e&&e.setCurrentRotation(c)}if(n&&(n.active=!i,!i&&s)){n.setRotationFromEuler(0,0,c);const e=n.getComponent(r);e&&e.setCurrentRotation(c)}}spin(e,t){console.log(`[LuckyWheel] spin: prizeIndex=${e}`),c.playOneShot(l.luckyWheel);const o=this.propertyNode.props_lucky_wheel_1_5_10.active?this.propertyNode.props_lucky_wheel_1_5_10:this.propertyNode.props_lucky_wheel_50_100;if(o){const e=o.getChildByName("wheel");if(e){const t=e.getComponent(n.Skeleton);t&&t.setAnimation(0,"common_run_start",!1)}}let s=90-45*e;if(s<0&&(s+=360),!o)return console.error("[LuckyWheel] No active wheel found"),void t();const i=[];if(["money","money_upgrade","money_bg"].forEach((e=>{const t=o.getChildByName(e);if(t&&t.active){const e=t.getComponent(r);e&&i.push(e)}})),0===i.length)return console.warn("[LuckyWheel] No active rotators found"),void t();let u=0;i.forEach((e=>{e.spinTo(s,6,(()=>{u++,u===i.length&&t()}))}))}})||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_Respin.ts",["cc","./BaseComponent.ts"],(function(e){var o,t,n,s,i,l,r,a,c,p,h,y,d;return{setters:[function(e){o=e.cclegacy,t=e.assetManager,n=e.SpriteFrame,s=e.Node,i=e.Layers,l=e.UIOpacity,r=e.Sprite,a=e.UITransform,c=e.Vec3,p=e.v3,h=e.tween,y=e._decorator},function(e){d=e.BaseComponent}],execute:function(){var m;o._RF.push({},"a3599MIjJJN/bQKZ+9K2205","MoneyComing_Respin",void 0);const{ccclass:_,property:u}=y;e("MoneyComing_Respin",_("MoneyComing_Respin")(m=class extends d{constructor(...e){super(...e),this.propertyNode={},this.props={betAmount:1},this.events={onFlyComplete:()=>{}}}initState(){return{}}bindEvent(){}useProps(e,o){}bindUI(){}playFlyAnimation(e){const o=this.node.getChildByPath("wheels_container/wheels_layout/wheel_frame/wheels/wheel_feature");if(!o)return console.error("[MoneyComing_Respin] Feature wheel node not found"),void this.events.onFlyComplete();const s=o,i=[],l=["wheels_container/wheels_layout/wheel_frame/wheels/wheel1","wheels_container/wheels_layout/wheel_frame/wheels/wheel2","wheels_container/wheels_layout/wheel_frame/wheels/wheel3"],r=1===e?2:3;for(let e=0;e<r;e++){const o=this.node.getChildByPath(l[e]);o&&i.push(o)}if(0===i.length)return console.warn("[MoneyComing_Respin] No target wheels found"),void this.events.onFlyComplete();let a=0;const c=i.length,p="moneyComing",h=t.getBundle(p);if(!h)return console.error("[MoneyComing_Respin] Bundle moneyComing not found"),void this.events.onFlyComplete();h.load(["cocos_lizi/fly/sybres_eft_str_02/spriteFrame","cocos_lizi/fly/sybres_eft_exp_04/spriteFrame"],n,((e,o)=>{if(e)return console.error("[MoneyComing_Respin] Failed to load fly assets",e),void this.events.onFlyComplete();const t=o[0],n=o[1];i.forEach(((e,o)=>{this.playSingleFly(s,e,t,n,(()=>{a++,a===c&&this.events.onFlyComplete()}))}))}))}playSingleFly(e,o,t,n,y){let d=new s("FlyEffectNode");d.layer=i.Enum.UI_2D;let m=d.addComponent(l),_=d.addComponent(r);_.spriteFrame=t,this.node.addChild(d);let u=e.getWorldPosition(),w=o.getWorldPosition(),f=this.node.getComponent(a)?.convertToNodeSpaceAR(u)||new c,g=this.node.getComponent(a)?.convertToNodeSpaceAR(w)||new c,C=p(f.x,f.y+500,0);d.setPosition(f),d.setScale(2,2,1),h(d).to(1,{position:g},{onUpdate:(e,o)=>{let t=o,n=f,s=C,i=g,l=(1-t)*(1-t)*n.x+2*t*(1-t)*s.x+t*t*i.x,r=(1-t)*(1-t)*n.y+2*t*(1-t)*s.y+t*t*i.y;d.setPosition(l,r,0)}}).call((()=>{_.spriteFrame=n,h(d).to(.3,{scale:new c(8,8,1)}).start(),h(m).to(.1,{opacity:0}).call((()=>{d.destroy(),y()})).start()})).start()}})||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_StartUp.ts",["cc","./index82.ts"],(function(t){var e,n,c;return{setters:[function(t){e=t.cclegacy},function(t){n=t.startUp,c=t.stopGame}],execute:function(){e._RF.push({},"684abfx4RNH163jlrqRZBFm","MoneyComing_StartUp",void 0);t("default",(t=>(n(t),()=>{c()})));e._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_Wheel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SymbolAnimator.ts"],(function(t){var e,i,n,o,s,l,r,h,a,m,c,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.initializerDefineProperty},function(t){n=t.cclegacy,o=t.Node,s=t._decorator,l=t.Component,r=t.instantiate,h=t.Layout,a=t.UITransform,m=t.Vec3,c=t.tween},function(t){p=t.SymbolAnimator}],execute:function(){var b,y,g,u,_,C,d,f,S,E,$,W,w,N,I,Y,D,P,H,v,x;n._RF.push({},"f96714hkFBGA73VXVIiag4T","MoneyComing_Wheel",void 0);const{ccclass:M,property:L}=s;var T=function(t){return t[t.IDLE=0]="IDLE",t[t.SPINNING=1]="SPINNING",t[t.DECELERATING=2]="DECELERATING",t[t.BOUNCING=3]="BOUNCING",t}(T||{});t("MoneyComing_Wheel",(b=M("MoneyComing_Wheel"),y=L(o),g=L({group:"Physics",tooltip:"最大速度（像素/秒）"}),u=L({group:"Physics",tooltip:"加速度（像素/秒²）"}),_=L({group:"Physics",tooltip:"减速时使用的缓动函数"}),C=L({group:"Physics",tooltip:"减速到停止的总时长"}),d=L({group:"Physics",tooltip:"回弹效果的缓动函数"}),f=L({group:"Physics",tooltip:"回弹效果的时长"}),b(($=e((E=class extends l{constructor(...t){super(...t),i(this,"symbolContainer",$,this),i(this,"symbolHeight",W,this),i(this,"wheelType",w,this),i(this,"containerHeight",N,this),i(this,"elementSpacing",I,this),this.bundle=null,i(this,"maxSpeed",Y,this),i(this,"acceleration",D,this),i(this,"decelerationEasing",P,this),i(this,"decelerationDuration",H,this),i(this,"bounceEasing",v,this),i(this,"bounceDuration",x,this),this._isSpinning=!1,this._onSpinComplete=null,this._targetElementName="",this._symbolCount=0,this._elementMap=new Map,this._originalSymbolCount=0,this._currentVisibleElements=[],this._spinState=T.IDLE,this._currentSpeed=0,this._targetY=0,this._stopCallback=null,this._loopHeight=0,this._startY=0}onLoad(){if(this.symbolContainer||(this.symbolContainer=this.node.getChildByName("symbol_container")||this.node),this.symbolContainer){const t=[...this.symbolContainer.children];if(this._originalSymbolCount=t.length,this._elementMap.clear(),t.forEach((t=>{this._elementMap.set(t.name,r(t))})),this._originalSymbolCount>1){const e=Math.min(3,this._originalSymbolCount);for(let i=0;i<e;i++){const e=t[this._originalSymbolCount-1-i],n=r(e);this.symbolContainer.insertChild(n,0)}for(let i=0;i<e;i++){const e=t[i],n=r(e);this.symbolContainer.addChild(n)}}const e=this.symbolContainer.getComponent(h);e&&(e.updateLayout(),e.enabled=!1),this._symbolCount=this.symbolContainer.children.length,this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),console.log(`[Wheel] 初始化完成，元素数量: ${this._symbolCount}, 原始元素数量: ${this._originalSymbolCount}, 模板数量: ${this._elementMap.size}`)}if(this.symbolHeight<=0&&this.symbolContainer&&this.symbolContainer.children.length>0){const t=this.symbolContainer.children[0].getComponent(a);t&&(this.symbolHeight=t.height)}this.resetToInitialPosition()}resetToInitialPosition(){if(!this.symbolContainer||0===this.symbolContainer.children.length)return;const t=(this._symbolCount-this._originalSymbolCount)/2,e=this.symbolContainer.children[t];if(!e){const t=this.symbolContainer.children[0].position.y;return this.symbolContainer.position=new m(this.symbolContainer.position.x,-t,0),void console.warn("[Wheel] 无法找到第一个原始元素，已重置到第一个可用元素。")}const i=e.position.y;this._startY=-i,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._startY,0)}startSpin(t="",e=2,i){if(c(this.symbolContainer).stop(),!this._isSpinning){if(0===this._originalSymbolCount)return console.warn("[Wheel] 滚轮中没有元素，无法启动"),void(i&&i(""));this._isSpinning=!0,this._spinState=T.SPINNING,this._currentSpeed=this.maxSpeed,this._onSpinComplete=i||null,this._targetElementName=t}}stop(t,e,i){if(console.log(`[Wheel] stop called: targetElementName="${t}", wheelType=${this.wheelType}`),!this._isSpinning||this._spinState!==T.SPINNING)return console.log("[Wheel] stop: 滚轮未在滚动状态，直接回调"),void(e&&e());this._targetElementName=t,this._stopCallback=e||null;let n=null,o=[];const s=this.symbolContainer.position.y,l=.2*this.maxSpeed,r=this._startY-this._loopHeight+l,h=this._startY-l;for(const e of this.symbolContainer.children){if(e.name.replace(/-clone.*$/,"")===t){const t=-e.position.y;let i=t-s;i<0&&(i+=this._loopHeight),o.push({node:e,distance:i,targetY:t})}}if(o.length>0){const t=o.filter((t=>t.targetY>r&&t.targetY<h));t.length>0?(t.sort(((t,e)=>t.distance-e.distance)),n=t[0].node,console.log(`[Wheel] 选择安全范围内的目标: targetY=${t[0].targetY.toFixed(2)}, 安全范围: (${r.toFixed(2)}, ${h.toFixed(2)})`)):(o.sort(((t,e)=>t.distance-e.distance)),n=o[0].node,console.warn(`[Wheel] 警告：没有安全范围内的目标，选择最近的: targetY=${o[0].targetY.toFixed(2)}`))}if(console.log(`[Wheel] stop: 从 symbolContainer.children 查找 "${t}": ${!!n}`),n)this._targetY=-n.position.y,console.log(`[Wheel] stop: 找到最佳目标元素 "${t}" at y=${n.position.y}`);else{const e=this.getClosestElement();if(e){const i=e.position.y;this._targetY=-i+this.symbolHeight/2+this.elementSpacing/2,console.log(`[Wheel] stop: 目标元素 '${t}' 未找到，将停在元素之间, targetY=${this._targetY}`)}else this._targetY=this.symbolContainer.position.y,console.warn("[Wheel] stop: 无法找到任何元素，使用当前位置")}this._spinState=T.IDLE,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._targetY,0),this._onSpinFinished()}update(t){if(this._spinState!==T.SPINNING)return;this._currentSpeed<this.maxSpeed&&(this._currentSpeed+=this.acceleration*t,this._currentSpeed>this.maxSpeed&&(this._currentSpeed=this.maxSpeed));let e=this.symbolContainer.position.y-this._currentSpeed*t;if(this._originalSymbolCount>1&&this._loopHeight>0){e<this._startY-this._loopHeight&&(e+=this._loopHeight)}this.symbolContainer.position=new m(this.symbolContainer.position.x,e,0)}_onSpinFinished(){this._isSpinning=!1,this._spinState=T.IDLE,this.symbolContainer.position=new m(this.symbolContainer.position.x,this._targetY,0),console.log(`[Wheel] _onSpinFinished: targetElementName=${this._targetElementName}, finalY=${this._targetY}`);const t=this.getDisplayedElement();t?console.log(`[Wheel] _onSpinFinished: 实际显示的元素=${t.name}, elementY=${t.position.y}, containerY=${this.symbolContainer.position.y}`):console.warn("[Wheel] _onSpinFinished: 未找到显示的元素"),this._stopCallback&&(this._stopCallback(),this._stopCallback=null),this._onSpinComplete&&(this._onSpinComplete(this._targetElementName),this._onSpinComplete=null)}getDisplayedElement(){return this._targetElementName&&""!==this._targetElementName?this.findDisplayedElement(this._targetElementName):null}findDisplayedElement(t){if(!this.symbolContainer)return console.warn("[Wheel] symbolContainer 为空"),null;console.log(`[Wheel] findDisplayedElement: 查找元素 "${t}", symbolContainer 子节点数: ${this.symbolContainer.children.length}`);const e=[];for(const t of this.symbolContainer.children)e.push(t.name);console.log(`[Wheel] symbolContainer 所有子节点: [${e.join(", ")}]`);let i=null,n=1/0;for(const e of this.symbolContainer.children){if(e.name.replace(/-clone.*$/,"")===t){const t=e.position.y,o=this.symbolContainer.position.y,s=Math.abs(o+t);console.log(`[Wheel] 找到匹配元素: ${e.name}, elementY=${t}, containerY=${o}, distance=${s}`),s<n&&(n=s,i=e)}}return i?(console.log(`[Wheel] 选择最近的元素: ${i.name}, distance=${n}`),i):(console.warn(`[Wheel] 未找到名称为 "${t}" 的元素节点`),null)}showResult(t){c(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE,this._currentSpeed=0;let e=0;const i=this._elementMap.get(t);if(i)e=-i.position.y;else{const t=this.getClosestElement();if(t){e=-t.position.y+this.symbolHeight/2+this.elementSpacing/2}else e=this.symbolContainer.position.y}if(this.symbolContainer.position=new m(this.symbolContainer.position.x,e,0),this._targetElementName=t,this._targetY=e,t&&""!==t&&this.bundle){const e=this.findDisplayedElement(t);if(e){console.log(`[Wheel] Turbo 模式播放动画 for ${t}`);const i=e.getWorldPosition();p.playAnimationAt(this.node,i,t,this.bundle)}}}get isSpinning(){return this._isSpinning}reset(){c(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE,this.resetToInitialPosition()}getCurrentElementName(){return this.getClosestElement().name}getClosestElement(){const t=this.symbolContainer.position.y;let e=null,i=1/0;for(const n of this.symbolContainer.children){const o=n.position.y,s=Math.abs(t+o);s<i&&(i=s,e=n)}return e}setVisibleElements(t){if(console.log(`[Wheel setVisibleElements] 被调用. Wheel Type: ${this.wheelType}`),console.log(`[Wheel setVisibleElements] 当前可见元素 (_currentVisibleElements): [${this._currentVisibleElements.join(", ")}]`),console.log(`[Wheel setVisibleElements] 新的可见元素 (visibleElements): [${t.join(", ")}]`),!this.symbolContainer)return void console.warn("[Wheel] symbolContainer 未初始化");if(0===this._elementMap.size)return void console.warn("[Wheel] _elementMap 为空，等待 onLoad 完成后再调用");0===t.length&&(t=Array.from(this._elementMap.keys()));const e=this._currentVisibleElements.length===t.length&&this._currentVisibleElements.every(((e,i)=>e===t[i]));if(console.log(`[Wheel setVisibleElements] 列表是否相同 (isSameElements): ${e}`),e)return void console.log("[Wheel] 可见元素列表未变化，跳过重建");this._spinState,T.IDLE;const i=this.symbolContainer.position.clone();c(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=T.IDLE;const n=this.symbolContainer.active;if(this.symbolContainer.active=!1,this.symbolContainer.removeAllChildren(),t.forEach((t=>{const e=this._elementMap.get(t);if(e){const t=r(e);this.symbolContainer.addChild(t)}else console.error(`[Wheel] setVisibleElements: 无法找到元素 "${t}"。请确保场景/Prefab中的 symbol_container 包含名为 "${t}" 的子节点！`)})),this._originalSymbolCount=this.symbolContainer.children.length,0===this._originalSymbolCount)return void console.warn(`[Wheel] 设置可见元素后没有任何元素，visibleElements: [${t.join(", ")}]`);if(this._originalSymbolCount>1){const t=[...this.symbolContainer.children],e=Math.min(3,this._originalSymbolCount);for(let i=0;i<e;i++){const e=t[this._originalSymbolCount-1-i],n=r(e);this.symbolContainer.insertChild(n,0)}for(let i=0;i<e;i++){const e=t[i],n=r(e);this.symbolContainer.addChild(n)}}this._symbolCount=this.symbolContainer.children.length;const o=this.symbolContainer.getComponent(h);o&&(o.enabled=!1),this._manuallyLayoutChildren(),this._finalizePositionAfterRebuild(i,n),this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),this._currentVisibleElements=[...t],console.log(`[Wheel] 设置可见元素: [${t.join(", ")}]，总计 ${this._symbolCount} 个节点`)}_manuallyLayoutChildren(){if(!this.symbolContainer||0===this.symbolContainer.children.length)return;let t=0;for(let e=0;e<this.symbolContainer.children.length;e++){const i=this.symbolContainer.children[e];0===e?t=0:t-=this.symbolHeight+this.elementSpacing,i.setPosition(0,t,0)}console.log(`[Wheel] 手动布局完成，共 ${this.symbolContainer.children.length} 个子节点`)}_finalizePositionAfterRebuild(t,e=!0){if(t&&this._currentVisibleElements.length>0){const t=(this._symbolCount-this._originalSymbolCount)/2,e=this.symbolContainer.children[t];if(e){const t=e.position.y;this._startY=-t,console.log(`[Wheel] 重建后重新计算 _startY = ${this._startY}`),this.resetToInitialPosition(),console.log("[Wheel] 切换投注金额后重置到初始位置，确保不抖动")}else this.resetToInitialPosition()}else this.resetToInitialPosition();this.symbolContainer.active=e}}).prototype,"symbolContainer",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(E.prototype,"symbolHeight",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 166}}),w=e(E.prototype,"wheelType",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"coin"}}),N=e(E.prototype,"containerHeight",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 316}}),I=e(E.prototype,"elementSpacing",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Y=e(E.prototype,"maxSpeed",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4e3}}),D=e(E.prototype,"acceleration",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3e3}}),P=e(E.prototype,"decelerationEasing",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quadOut"}}),H=e(E.prototype,"decelerationDuration",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),v=e(E.prototype,"bounceEasing",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),x=e(E.prototype,"bounceDuration",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),S=E))||S));n._RF.pop()}}}));

System.register("chunks:///_virtual/moneyComingScript",["./MoneyComing_StartUp.ts","./BetSelection.ts","./LuckyWheelRotator.ts","./MoneyComing_GameMain.ts","./MoneyComing_LuckyWheel.ts","./MoneyComing_Respin.ts","./MoneyComing_Wheel.ts","./config20.ts","./index82.ts","./socketConnect20.ts","./index81.ts","./prefabDefine21.ts","./soundDefine21.ts","./game37.ts","./index80.ts","./index83.ts","./type19.ts","./AnimationUtils.ts","./SymbolAnimator.ts","./AnimationViewModel.ts","./GameMainViewModel2.ts","./LuckyWheelViewModel.ts","./RespinViewModel.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/prefabDefine21.ts",["cc","./SourceManage.ts"],(function(e){var n,r,t;return{setters:[function(e){n=e.cclegacy,r=e.Prefab},function(e){t=e.loopFiles}],execute:function(){n._RF.push({},"cdbe4QsFEVMwrlG434WG6Xp","prefabDefine",void 0);let f=e("PrefabPathDefine",function(e){return e.LOAING_PANEL="prefabs/prefab_moneyComing_loading",e.GAME_MAIN="prefabs/MoneyComingView",e}({}));e("default",(e=>t(e,r,f)));n._RF.pop()}}}));

System.register("chunks:///_virtual/RespinViewModel.ts",["cc","./ViewModel.ts","./index80.ts","./index82.ts","./soundDefine21.ts"],(function(e){var t,n,i,s,o,a,l;return{setters:[function(e){t=e.cclegacy,n=e._decorator},function(e){i=e.StoreInject,s=e.default},function(e){o=e.getStore},function(e){a=e.moneyComing_Audio},function(e){l=e.SoundPathDefine}],execute:function(){var p;t._RF.push({},"f8dcdnlnTtEgYLs8Y177lIp","RespinViewModel",void 0);const{ccclass:m}=n;e("RespinViewModel",i(o())(p=m("RespinViewModel")(p=class extends s{constructor(){super("MoneyComing_Respin"),this.gameMainComp=null}begin(){}connect(){return this.inject({},(e=>({betAmount:e.betAmount}))),this}setGameMain(e){this.gameMainComp=e}async handleAllRespin(e,t){console.log("[RespinViewModel] handleAllRespin started");let n="";const i=1===this.comp.props.betAmount?2:3;for(let t=0;t<i;t++){const i=e[t];i&&i.startsWith("element_")&&(n+=i.replace("element_",""))}const s=""===n||isNaN(parseInt(n,10))?0:parseInt(n,10);this.gameMainComp&&(this.gameMainComp.showFeaturePanel(s,"all_respin",this.comp.props.betAmount),a.playOneShot(l.activeFeature)),this.gameMainComp&&this.gameMainComp.playFeatureSymbolAnimation("feature_all_respin"),a.playOneShot(l.allRespin),a.playOneShot(l.allRespinScatter),this.comp&&await new Promise((e=>{this.comp.playFlyAnimation(this.comp.props.betAmount),setTimeout(e,1500)})),this.gameMainComp&&(a.playOneShot(l.spin),this.gameMainComp.startRespin()),await new Promise((e=>setTimeout(e,2e3)));const o=this.generateRespinResults(this.comp.props.betAmount);this.gameMainComp&&await new Promise((e=>{this.gameMainComp.stopRespin(o,e)}));let p="";for(let e=0;e<i;e++){const t=o[e];t&&t.startsWith("element_")&&(p+=t.replace("element_",""))}const m=""===p||isNaN(parseInt(p,10))?0:parseInt(p,10);this.gameMainComp&&this.gameMainComp.updateFeatureBonus(m),await new Promise((e=>setTimeout(e,1e3))),this.gameMainComp&&this.gameMainComp.hideFeaturePanel(),console.log("[RespinViewModel] handleAllRespin completed"),t(o)}generateRespinResults(e){const t=["element_0","element_00","element_1","element_5","element_10"],n=()=>t[Math.floor(Math.random()*t.length)];return[n(),n(),1===e?"":n(),"feature_all_respin"]}})||p)||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/socketConnect20.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"2f393RnampFrJaP9qGy4476","socketConnect",void 0);let n=e("SKT_MAG_TYPE",function(e){return e.LOGIN="1",e.JOIN_ROOM="2",e.SPIN="3",e.EXIT_GAME="15",e}({})),t=e("moneyComingWebSocketDriver",null);e("default",(()=>new Promise(((o,n)=>{console.log("[MoneyComing] Mocking WebSocket connection..."),t=e("moneyComingWebSocketDriver",{loginGame:e=>(console.log("[MoneyComing] Mock loginGame called"),{bindReceiveHandler:e=>{console.log("[MoneyComing] Mock login response"),setTimeout((()=>{e({data:{success:!0,data:{}}})}),100)},bindTimeoutHandler:e=>!0}),logoutGame:e=>{console.log("[MoneyComing] Mock logoutGame called")},filterData:(e,o)=>({data:e,error:void 0}),sktMsgListener:{add:(e,o,n)=>{console.log(`[MoneyComing] Mock sktMsgListener.add: ${e}, ${o}`)},remove:(e,o)=>{console.log(`[MoneyComing] Mock sktMsgListener.remove: ${e}, ${o}`)}}}),o(t)}))));e("moneyComingGameLogin",(()=>{t.loginGame(n.LOGIN)})),e("removeInstance",(()=>{}));o._RF.pop()}}}));

System.register("chunks:///_virtual/soundDefine21.ts",["cc","./SourceManage.ts"],(function(e){var u,n,i;return{setters:[function(e){u=e.cclegacy,n=e.AudioClip},function(e){i=e.loopFiles}],execute:function(){u._RF.push({},"61a73HYA9FA5p8MDYZOD9uS","soundDefine",void 0);let o=e("SoundPathDefine",function(e){return e.bg="audio/music/bg",e.luckyWheel="audio/sound/lucky_wheel",e.activeFeature="audio/sound/active_feature",e.wheelLock="audio/sound/wheel_lock",e.spinOver="audio/sound/spin_over",e.feature="audio/sound/feature",e.allRespin="audio/sound/all_respin",e.number="audio/sound/number",e.bigWin="audio/sound/big_win",e.scatterOver="audio/sound/scatter_over",e.allRespinScatter="audio/sound/all_respin_scatter",e.spin="audio/sound/spin",e}({}));e("default",(e=>i(e,n,o)));u._RF.pop()}}}));

System.register("chunks:///_virtual/SymbolAnimator.ts",["cc"],(function(e){var o,n,t,s,i,l,a;return{setters:[function(e){o=e.cclegacy,n=e._decorator,t=e.Component,s=e.assetManager,i=e.sp,l=e.Node,a=e.UITransform}],execute:function(){var m,r;o._RF.push({},"02413jRgrVEg7SfoDiim3WK","SymbolAnimator",void 0);const{ccclass:y}=n;e("SymbolAnimator",y("SymbolAnimator")(((r=class extends t{static playAnimationAt(e,o,n,t,m=!1,r=1){console.log(`[SymbolAnimator] playAnimationAt for ${n}`);const y=this.SPINE_PATH_MAP.get(n);if(!y)return void console.warn(`[SymbolAnimator] 元素 ${n} 没有对应的 spine 动画`);const c=s.getBundle(t);c?c.load(y,i.SkeletonData,((t,s)=>{if(t||!e||!e.isValid)return void console.error(`[SymbolAnimator] 加载 spine 资源失败或父节点已销毁: ${y}`,t);const c=new l(`spine_anim_${n}_${Date.now()}`);e.addChild(c);const _=e.getComponent(a).convertToNodeSpaceAR(o);c.setPosition(_),c.layer=e.layer;const b=c.addComponent(i.Skeleton);b.skeletonData=s,b.premultipliedAlpha=!0,b.timeScale=r;const p="animation";b.findAnimation(p)?(b.setAnimation(0,p,m),m||b.setCompleteListener((()=>{c&&c.isValid&&c.destroy()}))):(console.warn(`[SymbolAnimator] spine 资源 ${y} 中未找到名为 'animation' 的动画`),c.destroy())})):console.error(`[SymbolAnimator] 无法获取 bundle: ${t}`)}static stopAllAnimations(e){if(!e||!e.isValid)return;const o=[...e.children];for(const e of o)e.name.startsWith("spine_anim_")&&e.destroy();console.log(`[SymbolAnimator] 停止并销毁了 ${e.name} 下的所有符号动画节点`)}}).SPINE_PATH_MAP=new Map([["element_0","spine/symbol/symbol_0"],["element_00","spine/symbol/symbol_00"],["element_1","spine/symbol/symbol_1"],["element_5","spine/symbol/symbol_5"],["element_10","spine/symbol/symbol_10"],["feature_x2","spine/symbol/symbol_2x"],["feature_x5","spine/symbol/symbol_5x"],["feature_x10","spine/symbol/symbol_10x"],["feature_all_respin","spine/symbol/symbol_all"],["feature_scatter","spine/symbol/symbol_scatter"],["feature_scatter_50_100","spine/symbol/symbol_scatter_red"]]),m=r))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/type19.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"4902aWhmWpM944EXJQ2Mzp8","type",void 0),t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/moneyComingScript', 'chunks:///_virtual/moneyComingScript'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});