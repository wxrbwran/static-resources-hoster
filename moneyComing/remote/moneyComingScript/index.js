System.register("chunks:///_virtual/AnimationUtils.ts",["cc"],(function(t){var o,e,i,n,a,r,s,l,c,d;return{setters:[function(t){o=t.cclegacy,e=t._decorator,i=t.Node,n=t.Layers,a=t.UIOpacity,r=t.Sprite,s=t.assetManager,l=t.SpriteFrame,c=t.v3,d=t.tween}],execute:function(){var m;o._RF.push({},"14eccGvK+pDd40mf1YiHSFj","AnimationUtils",void 0);var u=e.ccclass;t("AnimationUtils",u("AnimationUtils")(m=function(){function t(){}return t.playImage=function(t,o,e,c,d,m){var u=this;void 0===m&&(m="up"),console.log("[AnimationUtils] playImage called with: fromNode="+o.name+", toNode="+e.name+", parentNode="+c.name+", curveType="+m);var p=new i("FlyEffectNode");p.layer=n.Enum.UI_2D;var f=p.addComponent(a),y=p.addComponent(r),v=s.getBundle(t);if(v){var _="cocos_lizi/fly/sybres_eft_str_02/spriteFrame";v.load(_,l,(function(t,i){t?console.error("[AnimationUtils] Failed to load spriteFrame: "+_,t):(y.spriteFrame=i,u._startAnimation(p,y,f,o,e,c,v,d,m))}))}else console.error("[AnimationUtils] Bundle "+t+" not found")},t._startAnimation=function(t,o,e,i,n,a,r,s,m){void 0===m&&(m="up"),t.active=!0,a.addChild(t);var u,p=i.getWorldPosition(),f=n.getWorldPosition();if("down"===m){var y=.3*(f.x-p.x);u=c(p.x+y,p.y+-200,p.z)}else u=c(p.x,p.y+500,p.z);t.setWorldPosition(p),t.setScale(2,2,1),d(t).to(1,{worldPosition:f},{onUpdate:function(o,e){var i=e,n=p,a=u,r=f,s=(1-i)*(1-i)*n.x+2*i*(1-i)*a.x+i*i*r.x,l=(1-i)*(1-i)*n.y+2*i*(1-i)*a.y+i*i*r.y;t.setWorldPosition(c(s,l,0))}}).call((function(){r.load("cocos_lizi/fly/sybres_eft_exp_04/spriteFrame",l,(function(i,n){if(i)return console.error("[AnimationUtils] Failed to load explosion sprite",i),t.destroy(),void(s&&s());o.spriteFrame=n,d(t).to(.3,{scale:c(8,8,1)}).start(),d(e).to(.1,{opacity:0}).call((function(){t.destroy(),s&&s()})).start()}))})).start()},t}())||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationViewModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewModel.ts","./index80.ts","./index83.ts","./soundDefine21.ts"],(function(e){var i,o,n,t,a,l,s,c,h,d,m,p,r,u;return{setters:[function(e){i=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,t=e.Node,a=e.UITransform,l=e.Graphics,s=e.Color,c=e.sp,h=e.assetManager},function(e){d=e.StoreInject,m=e.default},function(e){p=e.getStore},function(e){r=e.moneyComing_Audio},function(e){u=e.SoundPathDefine}],execute:function(){var k;o._RF.push({},"c8234RwiX9BV79sxen4RPgp","AnimationViewModel",void 0);var w=n.ccclass;e("AnimationViewModel",d(p())(k=w("AnimationViewModel")(k=function(e){function o(){var i;return(i=e.call(this,"MoneyComing_GameMain")||this).previousBet=10,i.isInitialized=!1,i}i(o,e);var n=o.prototype;return n.begin=function(){var e=p().getState();this.previousBet=e.betAmount},n.connect=function(e){var i=this,o=this.store.getState();console.log("[AnimationViewModel] connect: initial state",o),o&&this.onStateUpdate(o),this.store.subscribe((function(){var e=i.store.getState();i.onStateUpdate(e)}))},n.onStateUpdate=function(e){var i=e.betAmount;this.isInitialized?i!==this.previousBet&&(console.log("[AnimationViewModel] onStateUpdate: Bet changed from "+this.previousBet+" to "+i),this.handleBetChange(i)):(console.log("[AnimationViewModel] onStateUpdate: Initializing with betAmount="+i),this.isInitialized=!0,this.setInitialLockState(i),this.previousBet=i)},n.setInitialLockState=function(e){if(console.log("[AnimationViewModel] setInitialLockState: betAmount="+e),1===e){var i=this.comp.wheel3LockNode;i?(this.showWheel3ShadowMask(),this.playSpineAnimation(i,"spine/lock/wheel_lock","stand",!0)):console.warn("[AnimationViewModel] setInitialLockState: wheel3LockNode is missing");var o=this.comp.luckyWheelLockNode;o?this.playSpineAnimation(o,"spine/lock/unlock","stand",!0):console.warn("[AnimationViewModel] setInitialLockState: luckyWheelLockNode is missing")}else this.comp.wheel3LockNode&&(this.comp.wheel3LockNode.active=!1),this.comp.luckyWheelLockNode&&(this.comp.luckyWheelLockNode.active=!1),this.hideWheel3ShadowMask()},n.handleBetChange=function(e){var i=this.previousBet;console.log("[AnimationViewModel] handleBetChange: previous="+i+", new="+e),e>i&&r&&r.playOneShot(u.activeFeature),1!==i&&1===e?(console.log("[AnimationViewModel] Switching to Bet 1 -> LOCK"),this.playWheel3LockAnimation(),this.playLuckyWheelLockAnimation()):1===i&&1!==e&&(console.log("[AnimationViewModel] Switching from Bet 1 -> UNLOCK"),this.playWheel3UnlockAnimation(),this.playLuckyWheelUnlockAnimation()),this.previousBet=e},n.playWheel3LockAnimation=function(){var e=this,i=this.comp.wheel3LockNode;console.log("[AnimationViewModel] playWheel3LockAnimation: lockNode exists?",!!i),i&&(this.showWheel3ShadowMask(),r&&r.playOneShot(u.wheelLock),this.playSpineAnimation(i,"spine/lock/wheel_lock","lock",!1,(function(){e.playSpineAnimation(i,"spine/lock/wheel_lock","stand",!0)})))},n.playWheel3UnlockAnimation=function(){var e=this.comp.wheel3LockNode;e&&(this.hideWheel3ShadowMask(),this.playSpineAnimation(e,"spine/lock/wheel_lock","unlock",!1,(function(){e.active=!1})))},n.showWheel3ShadowMask=function(){var e=this.comp.wheels[2];if(e&&e.node){var i=e.node.getChildByName("wheel_shadow_mask");if(!i){i=new t("wheel_shadow_mask"),e.node.addChild(i),i.setPosition(-7,0,0),i.addComponent(a).setContentSize(200,400);var o=i.addComponent(l);o.clear(),o.fillColor=new s(0,0,0,128),o.rect(-100,-200,200,400),o.fill()}i.active=!0;var n=this.comp.wheel3LockNode;n?i.setSiblingIndex(Math.max(0,n.getSiblingIndex()-1)):i.setSiblingIndex(e.node.children.length-1)}},n.hideWheel3ShadowMask=function(){var e=this.comp.wheels[2];if(e&&e.node){var i=e.node.getChildByName("wheel_shadow_mask");i&&(i.active=!1)}},n.playLuckyWheelLockAnimation=function(){var e=this,i=this.comp.luckyWheelLockNode;i&&this.playSpineAnimation(i,"spine/lock/unlock","start",!1,(function(){e.playSpineAnimation(i,"spine/lock/unlock","stand",!0)}))},n.playLuckyWheelUnlockAnimation=function(){var e=this.comp.luckyWheelLockNode;e&&this.playSpineAnimation(e,"spine/lock/unlock","end",!1,(function(){e.active=!1}))},n.playSymbolAnimation=function(e,i,o){if(void 0===o&&(o=!1),e){var n=e.getChildByName("symbol_anim");n||(n=new t("symbol_anim"),e.addChild(n),n.setPosition(0,0,0)),n.setScale(1,1,1),this.playSpineAnimation(n,"spine/"+i+"/"+i,"animation",o)}},n.playSpineAnimation=function(e,i,o,n,t){if(e){console.log("[AnimationViewModel] playSpineAnimation: path="+i+", anim="+o+", node="+e.name+", active="+e.active),e.active=!0;var a=e.getComponent(c.Skeleton);a||(a=e.addComponent(c.Skeleton),console.log("[AnimationViewModel] Added sp.Skeleton component"));var l=h.getBundle("moneyComing");l?l.load(i,c.SkeletonData,(function(e,l){if(!e&&a){console.log("[AnimationViewModel] Spine loaded successfully: "+i),a.skeletonData=l,a.premultipliedAlpha=!0;var s=a.setAnimation(0,o,n);console.log("[AnimationViewModel] Animation set: "+o+", trackEntry="+!!s),s&&!n&&t&&a.setCompleteListener((function(){a.setCompleteListener(null),t()}))}else console.error("[AnimationViewModel] Failed to load spine: "+i,e)})):console.error("[AnimationViewModel] Failed to get bundle: moneyComing")}else console.warn("[AnimationViewModel] playSpineAnimation: node is null")},o}(m))||k)||k);o._RF.pop()}}}));

System.register("chunks:///_virtual/BetSelection.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Component}],execute:function(){var r;n._RF.push({},"12345Z4AAAAAAAAAAAAAAAA","BetSelection",void 0);var i=o.ccclass;o.property,t("BetSelection",i("BetSelection")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.start=function(){},o.update=function(t){},n}(c))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/config20.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"18850r0KmRN6qlyxOsoJpRt","config",void 0);e("default",{sktCode:"MoneyComing",name:"MoneyComing",gameId:22,isTest:!1,seatNumber:1,isReconnect:!1,memberId:"",testConfig:{wsUrl:"",token:"",uid:""},gameConfig:{autoSpin:{totalSpins:50,intervals:{normal:1,turbo:.5,superTurbo:.2}},sequentialStop:{initialStopDelay:4.5,wheelStopInterval:.2},simultaneousStop:{normal:{scrollDuration:5,stopDuration:.1},turbo:{scrollDuration:3,stopDuration:.1},superTurbo:{scrollDuration:1,stopDuration:.1}},luckyWheelPrizes:{5:[1e3,250,50,150,75,500,25,100],10:[2e3,500,100,300,150,1e3,50,200],50:[5e4,1e4,1e3,5e3,1500,25e3,500,2500],100:[1e5,2e4,2e3,1e4,3e3,5e4,1e3,5e3]},luckyWheel:{spinDuration:6,accelerationDuration:.5,decelerationDuration:1,maxRotationSpeed:720,easing:"cubicOut",anglePerPrize:45,startAngleOffset:0},gameplay:{winDisplayDuration:.1,symbolProbability:.8,bigWin:{big:1500,mega:3e3,super:5e3}},constants:{elementPrefix:"element_",featureMultiplierPrefix:"feature_x",featureScatterKeyword:"feature_scatter",featureAllRespinKeyword:"feature_all_respin",bundleName:"moneyComing"}}});t._RF.pop()}}}));

System.register("chunks:///_virtual/game37.ts",["cc","./index.mjs_cjs=&original=2.js","./index2.js"],(function(e){var t,n;return{setters:[function(e){t=e.cclegacy},null,function(e){n=e.default}],execute:function(){t._RF.push({},"4b354Q8P1pH4K0SMiEw2Kdu","game",void 0);e("updateBalance",n.createAction("UPDATE_BALANCE")),e("updateBet",n.createAction("UPDATE_BET")),e("updateWin",n.createAction("UPDATE_WIN")),e("setSpinning",n.createAction("SET_SPINNING")),e("setSpinResults",n.createAction("SET_SPIN_RESULTS")),e("setTurboMode",n.createAction("SET_TURBO_MODE")),e("setAutoSpin",n.createAction("SET_AUTO_SPIN"));t._RF.pop()}}}));

System.register("chunks:///_virtual/GameMainViewModel2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewModel.ts","./index80.ts","./MoneyComing_GameMain.ts","./socketConnect20.ts","./index81.ts","./game37.ts","./config20.ts","./index83.ts","./soundDefine21.ts"],(function(n){var e,t,o,i,a,s,r,c,u,p,l,m,h,f,g,d,M,S,v,y,A,b,C;return{setters:[function(n){e=n.inheritsLoose,t=n.createForOfIteratorHelperLoose,o=n.asyncToGenerator,i=n.regeneratorRuntime},function(n){a=n.cclegacy,s=n._decorator},function(n){r=n.StoreInject,c=n.default},function(n){u=n.getStore},function(n){p=n.MoneyComing_GameMain},function(n){l=n.moneyComingWebSocketDriver,m=n.SKT_MAG_TYPE},function(n){h=n.bundlePkgName},function(n){f=n.setAutoSpin,g=n.setTurboMode,d=n.updateBet,M=n.updateWin,S=n.updateBalance,v=n.setSpinning,y=n.setSpinResults},function(n){A=n.default},function(n){b=n.moneyComing_Audio},function(n){C=n.SoundPathDefine}],execute:function(){var _;a._RF.push({},"d5bd4ymCwtHVZf5COZPZI7Z","GameMainViewModel",void 0);var w=s.ccclass;n("GameMainViewModel",r(u())(_=w("GameMainViewModel")(_=function(n){function a(){return n.call(this,p)||this}e(a,n);var s=a.prototype;return s.begin=function(){this.listenServerMsg(),this.playBgMusic()},s.connect=function(n){var e=this;return this.inject(n,(function(n){return console.log("[GameMainViewModel] inject: state.betAmount =",n.betAmount),{balance:n.balance,betAmount:n.betAmount,winAmount:n.winAmount,spinResults:n.spinResults,isSpinning:n.isSpinning,turboMode:n.turboMode,autoSpin:n.autoSpin}})),this.setEvent({onSpin:function(){e.onSpin()},onAutoSpin:function(){e.comp.props.autoSpin?(console.log("[MoneyComing] 停止 AutoSpin"),e.dispatch(f(!1))):(console.log("[MoneyComing] 开始 AutoSpin"),e.dispatch(f(!0)),e.onSpin())},onTurbo:function(){var n=(e.comp.props.turboMode+1)%3;console.log("[MoneyComing] 切换 Turbo 模式:",0===n?"Normal":1===n?"Turbo":"Super Turbo"),e.dispatch(g(n))},onBetChange:function(n){n>e.comp.props.betAmount&&b.playOneShot(C.activeFeature),e.dispatch(d(n))},onSpinComplete:function(){var n=e.comp.props.spinResults;if("feature_all_respin"===n[3]&&e.respinViewModel)return console.log("[MoneyComing] 触发 All Respin Feature"),void e.handleAllRespinFlow(n);if(n[3]&&n[3].includes("scatter"))return console.log("[MoneyComing] 触发 Scatter Feature"),void e.handleScatterFlow(n);var t=e.calculateWinAmount(n,e.comp.props.betAmount);console.log("[MoneyComing] 轮盘停止完成，计算中奖:",n,"中奖金额:",t),e.comp.playWinAnimations(n),e.checkAndPlayBigWin(t,(function(){e.dispatch(M(t)),e.dispatch(S(e.comp.props.balance-e.comp.props.betAmount+t)),e.dispatch(v(!1)),e.handleAutoSpin()}))}}),this},s.handleAutoSpin=function(){var n=this;if(this.comp.props.autoSpin){var e=this.getAutoSpinInterval();console.log("[MoneyComing] AutoSpin 下一次延迟: "+e+"秒"),this.comp.scheduleOnce((function(){n.comp.props.autoSpin&&n.onSpin()}),e)}},s.handleAllRespinFlow=function(){var n=o(i().mark((function n(e){var t,a,s=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.calculateWinAmount(e,this.comp.props.betAmount),console.log("[MoneyComing] All Respin 初始奖励:",t),this.dispatch(M(t)),this.dispatch(S(this.comp.props.balance-this.comp.props.betAmount+t)),a=this.respinViewModel,n.next=7,a.handleAllRespin(e,o(i().mark((function n(e){var o,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=s.calculateWinAmount(e,s.comp.props.betAmount),console.log("[MoneyComing] All Respin 重转奖励:",o),a=t+o,console.log("[MoneyComing] All Respin 总奖励:",a),s.checkAndPlayBigWin(a,(function(){s.dispatch(M(a)),s.dispatch(S(s.comp.props.balance-s.comp.props.betAmount+a)),s.dispatch(v(!1)),s.handleAutoSpin()}));case 5:case"end":return n.stop()}}),n)}))));case 7:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),s.handleScatterFlow=function(){var n=o(i().mark((function n(e){var t,o,a=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=this.comp.props.betAmount,o=this.calculateWinAmount(e,t),console.log("[MoneyComing] Scatter Base Win:",o),this.comp.showFeaturePanel(o,"scatter",t),this.comp.playFeatureSymbolAnimation(e[3]),this.comp.playScatterFlyAnimation(t,(function(){console.log("[MoneyComing] Scatter Fly Complete, Spinning Wheel");var n=a.luckyWheelViewModel;if(n){var e=Math.floor(8*Math.random());n.spin(e,(function(){console.log("[MoneyComing] Lucky Wheel Spin Complete");var n=t*(e+1)*5;a.comp.updateFeatureBonus(n),b.playOneShot(C.scatterOver),setTimeout((function(){var e=o+n;a.checkAndPlayBigWin(e,(function(){a.dispatch(M(e)),a.dispatch(S(a.comp.props.balance-t+e)),a.dispatch(v(!1)),a.comp.hideFeaturePanel(),a.handleAutoSpin()}))}),2e3)}))}else console.error("[MoneyComing] LuckyWheelViewModel not found"),a.dispatch(v(!1)),a.comp.hideFeaturePanel()}));case 6:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),s.checkAndPlayBigWin=function(n,e){var t=n/this.comp.props.betAmount,o="";t>=20?o="super":t>=10?o="mega":t>=5&&(o="big"),o?(console.log("[MoneyComing] Trigger Big Win: "+o+", amount: "+n),this.comp.playBigWinEffect(o,n,e)):e()},s.getAutoSpinInterval=function(){var n=this.comp.props.turboMode;return 1===n?A.gameConfig.autoSpin.intervals.turbo:2===n?A.gameConfig.autoSpin.intervals.superTurbo:A.gameConfig.autoSpin.intervals.normal},s.generateSpinResults=function(){for(var n=["element_0","element_00","element_1","element_5","element_10"],e=this.comp.props.betAmount,t=[],o=0;o<3;o++)(1!==e||2!==o)&&Math.random()<.8?t.push(n[Math.floor(Math.random()*n.length)]):t.push("");var i=["feature_x2","feature_x5","feature_all_respin"];return 5===e?i.push("feature_scatter"):10===e?i.push("feature_x10","feature_scatter"):50!==e&&100!==e||i.push("feature_x10","feature_scatter_50_100"),Math.random()<.8?t.push(i[Math.floor(Math.random()*i.length)]):t.push(""),t},s.calculateWinAmount=function(n,e){if(n.length<4)return 0;for(var o,i=n.slice(0,3),a=n[3],s="",r=t(i);!(o=r()).done;){var c=o.value;c&&c.startsWith("element_")&&(s+=c.replace("element_",""))}if(""===s)return 0;var u=parseInt(s,10);if(isNaN(u)||0===u)return 0;var p=1;return"feature_x2"===a?p=2:"feature_x5"===a?p=5:"feature_x10"===a&&(p=10),u*p},s.onSpin=function(){var n=this;this.comp.props.isSpinning||(console.log("[MoneyComing] Spin 开始"),this.dispatch(v(!0)),setTimeout((function(){var e=n.generateSpinResults();console.log("[MoneyComing] 设置 spin 结果:",e),n.dispatch(y(e))}),500))},s.listenServerMsg=function(){var n=this;console.log("[MoneyComing] 设置 WebSocket 监听器..."),l.sktMsgListener.add(m.SPIN,h,(function(e){console.log("[MoneyComing] 收到 SPIN 响应:",e),n.dispatch(y(e.results))}))},s.playBgMusic=function(){var n=this;this.comp.scheduleOnce((function(){b.stop(),n.comp.scheduleOnce((function(){b.play(C.bg,!0)}))}))},s.unMountCallBack=function(){l.sktMsgListener.remove(m.SPIN,h)},a}(c))||_)||_);a._RF.pop()}}}));

System.register("chunks:///_virtual/index80.ts",["cc","./redux.mjs_cjs=&original=.js","./index82.ts","./redux.js"],(function(e){var t,r,n;return{setters:[function(e){t=e.cclegacy},null,function(e){r=e.rootReducer},function(e){n=e.default}],execute:function(){var o;e("store",void 0),t._RF.push({},"25c02KUwCBEBKpdOTVmCIxz","index",void 0);var u=function(t){if(!o){var u=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||n.compose;o=e("store",n.createStore(r,u(n.applyMiddleware())))}return o};e("default",{configureStore:u}),e("getStore",(function(){return o||u(),o}));t._RF.pop()}}}));

System.register("chunks:///_virtual/index81.ts",["cc","./prefabDefine21.ts","./soundDefine21.ts"],(function(e){var n,t,u;return{setters:[function(e){n=e.cclegacy},function(e){t=e.default},function(e){u=e.default}],execute:function(){n._RF.push({},"668502f67VE45lcjAlGJjuA","index",void 0);var c=e("bundlePkgName","moneyComing");e("default",[].concat(t(c),u(c)));n._RF.pop()}}}));

System.register("chunks:///_virtual/index82.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=2.js","./game37.ts","./index2.js"],(function(n){var t,e,i,u,o,r,s,c,a,l;return{setters:[function(n){t=n.extends},function(n){e=n.cclegacy},null,function(n){i=n.updateBalance,u=n.updateBet,o=n.updateWin,r=n.setSpinning,s=n.setSpinResults,c=n.setTurboMode,a=n.setAutoSpin},function(n){l=n.default}],execute:function(){var p;e._RF.push({},"6fb59NzZ7JMAbVTDMEx39UD","index",void 0);var d=l.createReducer(((p={})[i.toString()]=function(n,e){return t({},n,{balance:e})},p[u.toString()]=function(n,e){return t({},n,{betAmount:e})},p[o.toString()]=function(n,e){return t({},n,{winAmount:e})},p[r.toString()]=function(n,e){return t({},n,{isSpinning:e})},p[s.toString()]=function(n,e){return t({},n,{spinResults:e})},p[c.toString()]=function(n,e){return t({},n,{turboMode:e})},p[a.toString()]=function(n,e){return t({},n,{autoSpin:e})},p),{balance:2e4,betAmount:10,winAmount:0,spinResults:[],isSpinning:!1,turboMode:0,autoSpin:!1});n("rootReducer",d);e._RF.pop()}}}));

System.register("chunks:///_virtual/index83.ts",["cc","./LoaderPanelViewModel.ts","./AudioMgr.ts","./config20.ts","./socketConnect20.ts","./index81.ts","./prefabDefine21.ts","./index80.ts","./hallType2.ts","./WebSocketStarter.ts","./GameMainViewModel2.ts","./AnimationViewModel.ts","./listenerFactoy.ts","./UseSetOption.ts"],(function(e,o){var n,t,i,c,a,d,l,u,m,s,r,w,g,L,M,f,A,p;return{setters:[function(e){n=e.cclegacy,t=e.assetManager,i=e.Prefab},function(e){c=e.default},function(e){a=e.AudioMgr},function(e){d=e.default},function(e){l=e.default},function(e){u=e.bundlePkgName,m=e.default},function(e){s=e.PrefabPathDefine},function(e){r=e.default,w=e.getStore},function(e){g=e.SubGameRunState},function(e){L=e.default},function(e){M=e.GameMainViewModel},function(e){f=e.AnimationViewModel},function(e){A=e.listenerFactoy},function(e){p=e.setActiveAudio}],execute:function(){e({animationViewModel:void 0,gameMainViewModel:void 0,moneyComing_Audio:void 0}),n._RF.push({},"9168eZ7yHlO0IqoXiXqc0yH","index",void 0);var y,G,C,_,v=[],h=(e("bundleMoneyComing",null),e("sourceManageSeletor",(function(e){return void 0===e&&(e=u),v.find((function(o){return o.bundle.name===e}))}))),S=(e("NORMAL_MAG_TYPE",function(e){return e[e.CHANGE_GAME=0]="CHANGE_GAME",e}({})),e("msgListener",A()),0);e("startUp",(function(n){r.configureStore(),t.loadBundle(u,(function(t,u){e("bundleMoneyComing",u).load(s.LOAING_PANEL,i,(function(e,o){}),(function(t,i){window.HALL_GLOBAL.isAllowOpenSubGame(d.gameId)&&(window.HALL_GLOBAL.setSubGameRunState(g.READY),(_=(new c).mountView(i).appendTo(n).setProps({loadBarType:1}).setEvent({onLoadDone:function(t){v=t,C=e("moneyComing_Audio",new a(h())),p(C),S=window.setTimeout((function(){window.HALL_GLOBAL.closeSubGame({confirmContent:window.HALL_GLOBAL.lang.write((function(e){return e.InitGameModule.GameBoardInit})),confirmDoneBeforeFn:function(){return i(_,S)}}),window.HALL_GLOBAL.addToast(window.HALL_GLOBAL.lang.write((function(e){return e.InitGameModule.GameBoardInit}),{},{placeStr:"game init failed"}))}),1e4);var i=function(e,o){e.unMount(),window.clearTimeout(o)};_.comp.setTipContent(window.HALL_GLOBAL.lang.write((function(e){return e.WebSocketModule.GameInit}),{},{placeStr:"Game init..."})),window.HALL_GLOBAL.setSubGameRunState(g.RUN),console.log("[MoneyComing] 开始初始化 WebSocket..."),l().then((function(){console.log("[MoneyComing] WebSocket 初始化成功");var t=h().getFile(s.GAME_MAIN);if(console.log("[MoneyComing] 获取 prefab:",t?"成功":"失败",t),!t||!t.source)return console.error("[MoneyComing] 游戏主界面 prefab 未找到或无效！"),window.HALL_GLOBAL.addToast("游戏资源加载失败"),void window.HALL_GLOBAL.closeSubGame();console.log("[MoneyComing] 创建 GameMainViewModel..."),y=e("gameMainViewModel",(new M).mountView(t.source).appendTo(n).connect(w().getState())),console.log("[MoneyComing] GameMainViewModel 创建完成，节点:",y.viewNode),console.log("[MoneyComing] 创建 AnimationViewModel..."),(G=e("animationViewModel",new f)).viewNode=y.viewNode,G.comp=y.comp,G.connect(w().getState()),console.log("[MoneyComing] 根节点:",n,"子节点数量:",n.children.length);var c=y.viewNode.getChildByPath("lucky_wheel");c?(console.log("[MoneyComing] Found lucky_wheel node, attaching LuckyWheelViewModel"),o.import("./MoneyComing_LuckyWheel.ts").then((function(e){var n=e.MoneyComing_LuckyWheel,t=c.getComponent(n);t||(t=c.addComponent(n)),o.import("./LuckyWheelViewModel.ts").then((function(e){var o=new(0,e.LuckyWheelViewModel);o.viewNode=c,o.comp=t,o.connect(),y.luckyWheelViewModel=o,console.log("[MoneyComing] LuckyWheelViewModel attached and connected")}))}))):console.error("[MoneyComing] Could not find lucky_wheel node"),o.import("./MoneyComing_Respin.ts").then((function(e){var n=e.MoneyComing_Respin,t=y.viewNode.getComponent(n);t||(t=y.viewNode.addComponent(n)),o.import("./RespinViewModel.ts").then((function(e){var o=new(0,e.RespinViewModel);o.viewNode=y.viewNode,o.comp=t,o.connect(),o.setGameMain(y.comp),y.respinViewModel=o,console.log("[MoneyComing] RespinViewModel attached and connected")}))})),_.viewNode.isValid&&_.viewNode.setSiblingIndex(_.viewNode.parent.children.length),setTimeout((function(){console.log("[MoneyComing] 卸载加载面板..."),i(_,S),console.log("[MoneyComing] 游戏初始化完成！")}),100)})).catch((function(e){console.error("[MoneyComing] WebSocket 初始化失败:",e),_.comp.setTipContent(e||"WebSocket connection error"),window.HALL_GLOBAL.addToast("WebSocket 连接失败")}))}}).setProps({versionStr:"md5: "+(window.HALL_GLOBAL.getGameConfig(d.gameId)?window.HALL_GLOBAL.getGameConfig(d.gameId).md5:"")})).comp.startLoad([u],[].concat(m)))}))}))})),e("stopGame",(function(){console.log("[MoneyComing] stopGame called"),window.HALL_GLOBAL.hallDispatch({type:"SET_ACTIVE_SUBGAME",payload:{subGameInfo:null}}),window.HALL_GLOBAL.setLoading(!1,u),console.log("[MoneyComing] setLoadingAction dispatched"),S&&window.clearTimeout(S),L.Instance().eventListener.removeById(u),_&&_.unMount(),y&&y.unMount(),console.log("[MoneyComing] 游戏卸载完成！",C),C&&(C.stop(),C.longStop(),C.remove(),C=e("moneyComing_Audio",null)),console.log("[MoneyComing] stopGame completed")}));n._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelRotator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,i,e,n,r,a,s,u,c;return{setters:[function(t){o=t.applyDecoratedDescriptor,i=t.inheritsLoose,e=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Node,u=t.tween,c=t.Component}],execute:function(){var h,l,R,p,g,d,f,_,y;r._RF.push({},"49b6bvzj2NO17Z1y2g/1Pi6","LuckyWheelRotator",void 0);var v=a.ccclass,b=a.property;t("LuckyWheelRotator",(h=v("LuckyWheelRotator"),l=b({tooltip:"旋转速度（度/秒）"}),R=b({tooltip:"是否自动开始旋转"}),p=b({type:s,tooltip:"旋转的目标节点，默认为当前节点"}),h((f=o((d=function(t){function o(){for(var o,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return o=t.call.apply(t,[this].concat(r))||this,e(o,"rotationSpeed",f,n(o)),e(o,"autoStart",_,n(o)),e(o,"targetNode",y,n(o)),o._isRotating=!1,o._currentRotation=0,o.betAmount=0,o}i(o,t);var r=o.prototype;return r.onLoad=function(){this.targetNode||(this.targetNode=this.node),this._currentRotation=this.targetNode.eulerAngles.z,this.autoStart&&this.startRotation()},r.update=function(t){if(this._isRotating&&this.targetNode&&!(this.betAmount<=1)){var o=this.rotationSpeed*t;this._currentRotation+=o,this._currentRotation>=360?this._currentRotation-=360:this._currentRotation<0&&(this._currentRotation+=360),this.targetNode.setRotationFromEuler(0,0,this._currentRotation)}},r.startRotation=function(){this._isRotating=!0},r.stopRotation=function(){this._isRotating=!1},r.setRotationSpeed=function(t){this.rotationSpeed=t},r.toggleRotation=function(){this._isRotating=!this._isRotating},r.resetRotation=function(){this._currentRotation=0,this.targetNode&&this.targetNode.setRotationFromEuler(0,0,0)},r.setCurrentRotation=function(t){this._currentRotation=t,this.targetNode&&this.targetNode.setRotationFromEuler(0,0,t)},r.spinTo=function(t,o,i){var e=this;this._isRotating=!1;var n={angle:this._currentRotation},r=0;if(this.rotationSpeed<0){var a=this._currentRotation%360;a>0&&(a-=360);var s=t;s>0&&(s-=360);var c=s-a;c>0&&(c-=360),r=this._currentRotation+c-1800}else{var h=this._currentRotation%360;h<0&&(h+=360);var l=t-h;l<0&&(l+=360),r=this._currentRotation+l+1800}u(n).to(o,{angle:r},{easing:"cubicOut",onUpdate:function(){e.setCurrentRotation(n.angle)},onComplete:function(){e._isRotating=!1,i&&i()}}).start()},o}(c)).prototype,"rotationSpeed",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),_=o(d.prototype,"autoStart",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=o(d.prototype,"targetNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=d))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyWheelViewModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewModel.ts","./index80.ts"],(function(e){var n,t,o,c,i,u;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator},function(e){c=e.StoreInject,i=e.default},function(e){u=e.getStore}],execute:function(){var r;t._RF.push({},"d868bL/mA1HU6Cbby25yYM5","LuckyWheelViewModel",void 0);var l=o.ccclass;e("LuckyWheelViewModel",c(u())(r=l("LuckyWheelViewModel")(r=function(e){function t(){return e.call(this,"MoneyComing_LuckyWheel")||this}n(t,e);var o=t.prototype;return o.begin=function(){},o.connect=function(){return this.inject({},(function(e){return{betAmount:e.betAmount}})),this},o.spin=function(e,n){this.comp?this.comp.spin(e,n):(console.error("[LuckyWheelViewModel] Component not found"),n())},t}(i))||r)||r);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_GameMain.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./MoneyComing_Wheel.ts","./SymbolAnimator.ts","./AnimationUtils.ts","./index83.ts","./soundDefine21.ts"],(function(e){var t,o,n,i,a,r,s,l,p,c,d,h,u,_,m,b,g,y,f;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,i=e.Node,a=e.Button,r=e.Color,s=e.UITransform,l=e.sp,p=e.assetManager,c=e.SpriteFrame,d=e.Sprite,h=e.Label,u=e.tween},function(e){_=e.BaseComponent},function(e){m=e.MoneyComing_Wheel},function(e){b=e.SymbolAnimator},function(e){g=e.AnimationUtils},function(e){y=e.moneyComing_Audio},function(e){f=e.SoundPathDefine}],execute:function(){var v;o._RF.push({},"93351gVVfJBKKOjeFsktmEg","MoneyComing_GameMain",void 0);var w=n.ccclass;n.property,e("MoneyComing_GameMain",w("MoneyComing_GameMain")(v=function(e){function o(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).wheels=[],t.betSelectionNode=null,t.propertyNode={props_spin_btn:new a,props_bet_btn:new a,props_auto_btn:new a,props_turbo:new a,props_balance_label:new h,props_win_label:new h,props_bet_label:new h,props_unlock_1:new i,props_unlock_5:new i,props_unlock_10:new i,props_unlock_50:new i,props_brand_board:new i,props_feature_board:new i,props_lucky_wheel_1_5_10:new i,props_lucky_wheel_50_100:new i,props_lucky_wheels:new i,props_win_effect:new i,props_setting:new i,props_setting_selection:new i,props_setting_back:new i},t.wheel3LockNode=null,t.luckyWheelLockNode=null,t.props={balance:2e4,betAmount:10,winAmount:0,spinResults:[],isSpinning:!1,turboMode:0,autoSpin:!1},t.events={onSpin:function(){},onAutoSpin:function(){},onTurbo:function(){},onBetChange:function(e){},onSpinComplete:function(){}},t}t(o,e);var n=o.prototype;return n.initState=function(){return{}},n.start=function(){console.log("[GameMain] start: current props.betAmount =",this.props.betAmount),this.props.betAmount>0?(console.log("[GameMain] start: forcing UI update for betAmount:",this.props.betAmount),this.updateUnlockLevels(this.props.betAmount),this.highlightCurrentBet(this.props.betAmount),this.updateUnlockLevels(this.props.betAmount),this.highlightCurrentBet(this.props.betAmount),this.propertyNode.props_bet_label&&(this.propertyNode.props_bet_label.string=this.props.betAmount.toFixed(2))):console.warn("[GameMain] start: betAmount is 0, waiting for props update...")},n.bindEvent=function(){var e=this;this.propertyNode.props_spin_btn&&this.propertyNode.props_spin_btn.node.on(i.EventType.TOUCH_END,(function(){e.hideBetSelection(),e.hideSettingSelection(),y.playOneShot(f.spin),e.events.onSpin()})),this.propertyNode.props_auto_btn&&this.propertyNode.props_auto_btn.node.on(i.EventType.TOUCH_END,(function(){e.hideBetSelection(),e.events.onAutoSpin()})),this.propertyNode.props_turbo&&this.propertyNode.props_turbo.node.on(i.EventType.TOUCH_END,(function(){e.hideBetSelection(),e.events.onTurbo()})),this.propertyNode.props_bet_btn&&this.propertyNode.props_bet_btn.node.on(i.EventType.TOUCH_END,(function(){return e.toggleBetSelection()})),this.propertyNode.props_setting&&this.propertyNode.props_setting.on(i.EventType.TOUCH_END,(function(){e.onSettingClick()})),this.propertyNode.props_setting_back&&this.propertyNode.props_setting_back.on(i.EventType.TOUCH_END,(function(){e.onBackToHallClick()}))},n.onSettingClick=function(){this.props.isSpinning||this.props.autoSpin||this.propertyNode.props_setting_selection&&(this.propertyNode.props_setting_selection.active=!0)},n.hideSettingSelection=function(){this.propertyNode.props_setting_selection&&(this.propertyNode.props_setting_selection.active=!1)},n.onBackToHallClick=function(){window.HALL_GLOBAL&&window.HALL_GLOBAL.closeSubGame?window.HALL_GLOBAL.closeSubGame():console.error("[GameMain] window.HALL_GLOBAL.closeSubGame is not available")},n.hideBetSelection=function(){this.betSelectionNode&&this.betSelectionNode.active&&(this.betSelectionNode.active=!1)},n.toggleBetSelection=function(){this.betSelectionNode&&(this.betSelectionNode.active=!this.betSelectionNode.active,console.log("[GameMain] toggleBetSelection:",this.betSelectionNode.active),this.betSelectionNode.active&&this.highlightCurrentBet())},n.highlightCurrentBet=function(e){if(void 0===e&&(e=this.props.betAmount),this.betSelectionNode)for(var t=0,o=[1,5,10,50,100];t<o.length;t++){var n=o[t],i=this.betSelectionNode.getChildByPath("hLayout / betOptionLayout / betOption"+n+" ");if(i){var s=i.getComponentInChildren(a);s&&(s.normalColor=n===e?new r(150,150,150,255):new r(50,50,50,255))}}},n.updateUnlockLevels=function(e){var t={1:this.propertyNode.props_unlock_1,5:this.propertyNode.props_unlock_5,10:this.propertyNode.props_unlock_10,50:this.propertyNode.props_unlock_50};Object.keys(t).forEach((function(e){var o=t[e];o&&o.isValid&&(o.active=!1)}));var o=function(e,t,o){e&&e.isValid&&(e.active=t,e.setPosition(e.position.x,o,e.position.z))};switch(e){case 1:o(t[1],!0,-30),o(t[5],!0,30);break;case 5:o(t[5],!0,-30),o(t[10],!0,30);break;case 10:o(t[10],!0,-30),o(t[50],!0,30);break;case 50:case 100:o(t[10],!0,-30),o(t[50],!0,30)}-1!==[1,5,10].indexOf(e)?this.playBrandTextAnimation("down_start","down_cycle"):this.playBrandTextAnimation("up_start","up_cycle"),this.updateFeatureWheel(e)},n.updateFeatureWheel=function(e){if(!(this.wheels.length<4)){var t=this.wheels[3];if(t){var o=this.getAvailableFeatureElements(e);console.log("[GameMain] updateFeatureWheel: bet = "+e+", elements = ["+o.join(", ")+"]"),t.setVisibleElements(o)}}},n.getAvailableFeatureElements=function(e){var t=["feature_x2","feature_x5","feature_all_respin"];return 1===e?t:5===e?[].concat(t,["feature_scatter"]):10===e?[].concat(t,["feature_x10","feature_scatter"]):50===e||100===e?[].concat(t,["feature_x10","feature_scatter_50_100"]):t},n.playBrandTextAnimation=function(e,t){var o=this,n=this.propertyNode.props_brand_board;if(n&&n.isValid){var a=n.getChildByName("payboard_light_anim");a||(a=new i("payboard_light_anim"),n.addChild(a));a.setSiblingIndex(2),a.layer=n.layer;var r=a.getComponent(s);r||(r=a.addComponent(s));var c=n.getComponent(s);c&&(r.contentSize=c.contentSize);var d=a.getComponent(l.Skeleton);d||(d=a.addComponent(l.Skeleton)),d.premultipliedAlpha=!0;var h="spine/payboard_Light/payboard_Light",u=p.getBundle("moneyComing");u?d.skeletonData&&"payboard_Light"===d.skeletonData.name?this.playSkeletonAnimation(d,e,t):u.load(h,l.SkeletonData,(function(n,i){!n&&d&&d.isValid?(d.skeletonData=i,o.playSkeletonAnimation(d,e,t)):console.error("[GameMain] Failed to load skeleton data for "+h,n)})):console.error("[GameMain] Cannot find bundle: moneyComing")}},n.playSkeletonAnimation=function(e,t,o){e.animation!==o&&(e.setAnimation(0,t,!1)?e.setCompleteListener((function(){e.setAnimation(0,o,!0),e.setCompleteListener(null)})):e.setAnimation(0,o,!0))},n.onBetAmountSelected=function(e){console.log("[GameMain] onBetAmountSelected:",e),this.events.onBetChange(e),this.betSelectionNode&&(this.betSelectionNode.active=!1)},n.initBetSelection=function(){var e=this;if(this.betSelectionNode){console.log("[GameMain] 开始初始化 betSelection，节点:",this.betSelectionNode.name),console.log("[GameMain] betSelection 子节点:",this.betSelectionNode.children.map((function(e){return e.name})));for(var t=function(){var t=n[o],r="hLayout/betOptionLayout/betOption"+t,s=null;if(s=e.betSelectionNode.getChildByPath(r)){console.log("[GameMain] 找到投注按钮节点: "+t+", 路径: "+r+" ");var l=s.getComponentInChildren(a);l?(l.node.on(i.EventType.TOUCH_END,(function(){console.log("[GameMain] 投注按钮被点击: "+t+" "),e.onBetAmountSelected(t)})),console.log("[GameMain] ✅ 成功绑定投注按钮: "+t+" ")):console.warn("[GameMain] ⚠️ 节点 "+r+" 的子节点中没有 Button 组件")}else console.warn("[GameMain] ❌ 未找到投注按钮节点: "+t+"，尝试的路径: ",r)},o=0,n=[1,5,10,50,100];o<n.length;o++)t()}},n.useProps=function(e,t){var o=this;if("balance"===e&&this.propertyNode.props_balance_label&&void 0!==t.cur&&null!==t.cur&&(this.propertyNode.props_balance_label.string=t.cur.toFixed(2)),"winAmount"===e&&this.propertyNode.props_win_label&&void 0!==t.cur&&null!==t.cur&&(this.propertyNode.props_win_label.string=t.cur.toFixed(2)),"betAmount"===e&&(console.log("[GameMain] useProps: betAmount changed to:",t.cur),this.propertyNode.props_bet_label&&void 0!==t.cur&&null!==t.cur?(this.propertyNode.props_bet_label.string=t.cur.toFixed(2),console.log("[GameMain] useProps: updated props_bet_label to:",this.propertyNode.props_bet_label.string),console.log("[GameMain] useProps: updated props_bet_label to:",this.propertyNode.props_bet_label.string),this.updateUnlockLevels(t.cur),this.highlightCurrentBet(t.cur),this.wheels.forEach((function(e,t){b.stopAllAnimations(e.node),o.stopExpectAnimation(t)}))):console.warn("[GameMain] useProps: props_bet_label is missing or value is invalid")),"isSpinning"===e){var n=t.cur,i=this.props.autoSpin;if(console.log("[GameMain] useProps: isSpinning changed to "+n+", isAutoSpin = "+i+" "),this.propertyNode.props_spin_btn&&(this.propertyNode.props_spin_btn.interactable=!n&&!i,console.log("[GameMain] Updated spin_btn interactable: "+this.propertyNode.props_spin_btn.interactable+" ")),this.propertyNode.props_bet_btn&&(this.propertyNode.props_bet_btn.interactable=!n&&!i),this.propertyNode.props_setting){var r=this.propertyNode.props_setting.getComponent(a);r&&(r.interactable=!n&&!i)}this.propertyNode.props_turbo&&(this.propertyNode.props_turbo.interactable=!n&&!i),this.propertyNode.props_auto_btn&&(this.propertyNode.props_auto_btn.interactable=i||!n),n&&!t.pre&&this.startSpin()}if("spinResults"===e&&t.cur&&t.cur.length>0&&this.props.isSpinning&&this.stopSpin(t.cur),"turboMode"===e&&this.updateTurboButtonSprite(t.cur),"autoSpin"===e){var s=t.cur,l=this.props.isSpinning;if(this.propertyNode.props_spin_btn&&(this.propertyNode.props_spin_btn.interactable=!l&&!s),this.propertyNode.props_bet_btn&&(this.propertyNode.props_bet_btn.interactable=!l&&!s),this.propertyNode.props_setting){var p=this.propertyNode.props_setting.getComponent(a);p&&(p.interactable=!l&&!s)}this.propertyNode.props_turbo&&(this.propertyNode.props_turbo.interactable=!l&&!s),this.propertyNode.props_auto_btn&&(this.propertyNode.props_auto_btn.interactable=s||!l)}},n.updateTurboButtonSprite=function(e){var t=this;if(this.propertyNode.props_turbo){var o="";if(0===e?o="texture/ui/controls/normal":1===e?o="texture/ui/controls/turbo":2===e&&(o="texture/ui/controls/super_turbo"),o){console.log("[GameMain] 切换 Turbo 按钮素材:",o);var n=p.getBundle("moneyComing");n?n.load(o+"/spriteFrame",c,(function(e,n){if(!e&&n){var i=t.propertyNode.props_turbo.node.getComponent(d);i?i.spriteFrame=n:console.warn("[GameMain] Sprite component not found on turbo button")}else console.error("[GameMain] Failed to load turbo button image: "+o,e)})):console.error("[GameMain] Cannot find moneyComing bundle")}}},n.bindUI=function(){var e=this;console.log("[GameMain] bindUI: props_bet_label bound?",this.propertyNode.props_bet_label?"YES":"NO"),this.propertyNode.props_bet_label&&console.log("[GameMain] bindUI: props_bet_label string:",this.propertyNode.props_bet_label.string),this.betSelectionNode=this.node.getChildByPath("control_panel/controls/betSelection"),this.betSelectionNode?(this.betSelectionNode.active=!1,this.initBetSelection()):console.warn("[GameMain] betSelection 节点未找到，请在 Cocos Creator prefab 中创建该节点，路径：control_panel/controls/betSelection"),this.wheels=[];["wheels_container/wheels_layout/wheel_frame/wheels/wheel1","wheels_container/wheels_layout/wheel_frame/wheels/wheel2","wheels_container/wheels_layout/wheel_frame/wheels/wheel3","wheels_container/wheels_layout/wheel_frame/wheels/wheel_feature"].forEach((function(t,o){var n=e.node.getChildByPath(t);if(n){var i=n.getComponent(m);i||(i=n.addComponent(m)),i.symbolContainer||(i.symbolContainer=n.getChildByName("symbol_container")),i.wheelType=o<3?"coin":"feature",i.bundle="moneyComing",e.wheels.push(i)}else console.warn("Wheel node not found: "+t)})),this.initLockNodes();var t=this.node.getChildByPath("control_panel/controls/props_setting_selection");if(t){this.propertyNode.props_setting_selection=t,t.active=!1,console.log("[GameMain] props_setting_selection bound successfully");var o=t.getChildByPath("OptionLayout/props_setting_back");o&&(this.propertyNode.props_setting_back=o,o.on(i.EventType.TOUCH_END,(function(){e.onBackToHallClick()})),console.log("[GameMain] props_setting_back bound successfully"))}else console.warn("[GameMain] props_setting_selection node not found at control_panel/controls/props_setting_selection");var n=this.node.getChildByPath("lucky_wheel/brand/board/props_brand_board");n&&(this.propertyNode.props_brand_board=n,console.log("[GameMain] props_brand_board bound successfully"));var a=this.node.getChildByPath("lucky_wheel/brand/board/props_feature_board");a&&(this.propertyNode.props_feature_board=a,a.active=!1,console.log("[GameMain] props_feature_board bound successfully"))},n.initLockNodes=function(){var e=this.wheels[2];if(e&&e.node){var t=e.node.getChildByName("wheel_lock_node");t||(t=new i("wheel_lock_node"),e.node.addChild(t),t.setPosition(0,0,0)),t.layer=e.node.layer,t.setSiblingIndex(e.node.children.length-1),t.active=!1,this.wheel3LockNode=t,console.log("[GameMain] initLockNodes: Wheel 3 lock node created/found")}else console.error("[GameMain] initLockNodes: Wheel 3 not found");var o=this.propertyNode.props_lucky_wheel_1_5_10;if(o){var n=o.getChildByName("wheel_lock_node");n||(n=new i("wheel_lock_node"),o.addChild(n),n.setPosition(0,0,0)),n.layer=o.layer,n.setSiblingIndex(o.children.length-1),n.active=!1,this.luckyWheelLockNode=n,console.log("[GameMain] initLockNodes: Lucky Wheel lock node created/found on",o.name)}else console.error("[GameMain] initLockNodes: props_lucky_wheel_1_5_10 not bound")},n.startSpin=function(){var e=this;this.wheels.forEach((function(e){b.stopAllAnimations(e.node)})),this.hideFeaturePanel(),this.wheels.forEach((function(t,o){1===e.props.betAmount&&2===o||t.startSpin()}))},n.stopSpin=function(e){var t=this;console.log("[GameMain] stopSpin 开始, results:",e,"wheels数量:",this.wheels.length);var o=0;this.wheels.forEach((function(n,i){var a=e[i]||"";console.log("[GameMain] 停止 wheel "+i+", result:",a),t.scheduleOnce((function(){y.playOneShot(f.spinOver),n.stop(a,(function(){o++,console.log("[GameMain] wheel "+i+" 停止完成, stoppedCount:",o,"/",t.wheels.length),o===t.wheels.length&&(console.log("[GameMain] 所有 wheel 停止完成，触发 onSpinComplete"),t.events.onSpinComplete())}))}),.2*i)}))},n.startRespin=function(){var e=this;console.log("[GameMain] startRespin");for(var t=0;t<3;t++)this.wheels[t]&&b.stopAllAnimations(this.wheels[t].node);this.wheels.forEach((function(t,o){3!==o&&(1===e.props.betAmount&&2===o||(t.startSpin(),e.playExpectAnimation(o)))}))},n.stopRespin=function(e,t){var o=this;console.log("[GameMain] stopRespin, results:",e);var n=0,i=[];this.wheels.forEach((function(e,t){3!==t&&(1===o.props.betAmount&&2===t||i.push(e))})),i.forEach((function(a,r){var s=o.wheels.indexOf(a),l=e[s]||"";o.scheduleOnce((function(){a.stop(l,(function(){o.stopExpectAnimation(s),++n===i.length&&(console.log("[GameMain] stopRespin complete"),t())}))}),.2*r)}))},n.showFeaturePanel=function(e,t,o){var n,i;void 0===t&&(t="all_respin"),void 0===o&&(o=1);var a=this.propertyNode.props_brand_board,r=this.propertyNode.props_feature_board;if(a&&r){console.log("[GameMain] showFeaturePanel: baseWin="+e+", type="+t),r.parent===a?(console.log("[GameMain] featureBoard is a child of brandBoard. Keeping brandBoard active."),a.active=!0):a.active=!1,r.active=!0;var s=r.getChildByPath("right");if(s){var l=s.getChildByName("all_respin"),p=s.getChildByName("scatter"),c=s.getChildByName("scatter_50_100");l&&(l.active=!1),p&&(p.active=!1),c&&(c.active=!1),"all_respin"===t&&l?l.active=!0:"scatter"===t&&(-1!==[50,100].indexOf(o)&&c?c.active=!0:p&&(p.active=!0))}var d=null==(n=r.getChildByPath("base_value"))?void 0:n.getComponent(h);d&&(d.string=e.toString());var u=null==(i=r.getChildByPath("bonus_value"))?void 0:i.getComponent(h);u&&(u.string="0")}else console.warn("[GameMain] Brand or Feature board nodes missing")},n.updateFeatureBonus=function(e){var t,o=this.propertyNode.props_feature_board;if(o&&o.active){var n=null==(t=o.getChildByPath("bonus_value"))?void 0:t.getComponent(h);n&&(n.string=e.toString())}},n.playFeatureSymbolAnimation=function(e){if(!(this.wheels.length<4)){var t=this.wheels[3];if(t){var o=t.getDisplayedElement();if(o){console.log("[GameMain] Playing feature symbol animation: "+e+" on "+o.name);var n=o.getWorldPosition();b.playAnimationAt(t.node,n,e,"moneyComing",!0)}}}},n.playWinAnimations=function(e){console.log("[GameMain] playWinAnimations:",e),this.wheels.forEach((function(e){b.stopAllAnimations(e.node)}));for(var t=1===this.props.betAmount?2:3,o=e[3],n="",i=0;i<t;i++){var a=e[i];a&&a.startsWith("element_")&&(n+=a.replace("element_",""))}var r=n?parseInt(n,10):0;if(r>0){for(var s=-1,l=0;l<t;l++){var p=e[l];if(p&&p.startsWith("element_")){var c=p.replace("element_","");if("0"!==c&&"00"!==c){s=l;break}}}if(-1!==s)for(var d=s;d<t;d++){var h=e[d];if(h&&h.startsWith("element_")){var u=this.wheels[d],_=u.getDisplayedElement();if(_){var m=_.getWorldPosition();b.playAnimationAt(u.node,m,h,"moneyComing",!0)}}}}if(o){var g=o.includes("x"),y=o.includes("scatter");if(r>0&&g||y||"feature_all_respin"===o){var f=this.wheels[3],v=f.getDisplayedElement();if(v){var w=v.getWorldPosition();b.playAnimationAt(f.node,w,o,"moneyComing",!0)}}}},n.playExpectAnimation=function(e){var t;if(!(e<0||e>=this.wheels.length)){var o=this.wheels[e];if(o&&o.node){var n=this.node,a="expect_anim_"+e,r=n.getChildByName(a);r||(r=new i(a),n.addChild(r));var c=o.node.getWorldPosition(),d=(null==(t=n.getComponent(s))?void 0:t.convertToNodeSpaceAR(c))||c;r.setPosition(d),r.setScale(1,.95,1),r.setSiblingIndex(n.children.length-1),r.active=!0;var h=r.getComponent(l.Skeleton);h||(h=r.addComponent(l.Skeleton)),h.premultipliedAlpha=!0;var u="spine/expect/expect",_=p.getBundle("moneyComing");_&&_.load(u,l.SkeletonData,(function(e,t){!e&&h&&h.isValid?(h.skeletonData=t,h.setAnimation(0,"light01",!0)):console.error("[GameMain] Failed to load expect spine: "+u,e)}))}}},n.stopExpectAnimation=function(e){if(!(e<0||e>=this.wheels.length)){var t=this.wheels[e];if(t&&t.node){var o=t.node.parent;if(o)if(o.parent){var n="expect_anim_"+e,i=this.node.getChildByName(n);i&&i.destroy()}}}},n.playBigWinEffect=function(e,t,o){console.log("[GameMain] playBigWinEffect: type="+e+", amount="+t),y.playOneShot(f.bigWin);var n=this.propertyNode.props_win_effect;if(!n)return console.error("[GameMain] props_win_effect node not found!"),void o();n.active=!0;var i=e+"win_start",a=e+"win_cycle",r=n.getChildByName("point");if(r){var s=r.getComponent(l.Skeleton);s&&(s.setAnimation(0,"win_start",!1),s.addAnimation(0,"win_cycle",!0));var p=r.getComponentInChildren(h);if(p){u({value:0}).to(2,{value:t},{onUpdate:function(e){p.string=e.value.toFixed(2)}}).start()}}var c=n.getChildByName("win_back");if(c){var d=c.getComponent(l.Skeleton);d&&(d.setAnimation(0,i,!1),d.addAnimation(0,a,!0))}var _=n.getChildByName("win_front");if(_){var m=_.getComponent(l.Skeleton);m&&(m.setAnimation(0,i,!1),m.addAnimation(0,a,!0))}this.scheduleOnce((function(){n.active=!1,o()}),5)},n.playScatterFlyAnimation=function(e,t){if(console.log("[GameMain] playScatterFlyAnimation: betAmount="+e),this.wheels.length<4)t();else{var o=this.wheels[3].node,n="";1===e||5===e||10===e?n="props_lucky_wheel_1_5_10/money_bg":50!==e&&100!==e||(n="props_lucky_wheel_50_100/money_bg");var i=this.propertyNode.props_lucky_wheels;if(!i)return console.error("[GameMain] Lucky wheels node not found"),void t();var a=i.getChildByPath(n);if(!o||!a)return console.error("[GameMain] Start or End node not found. Start: "+(null==o?void 0:o.name)+", End: "+(null==a?void 0:a.name)),void t();var r=this.node;y.playOneShot(f.allRespinScatter),g.playImage("moneyComing",o,a,r,(function(){console.log("[GameMain] Scatter fly animation completed"),t()}),"up")}},n.hideFeaturePanel=function(){var e=this.propertyNode.props_brand_board,t=this.propertyNode.props_feature_board;e&&t&&t.active&&(console.log("[GameMain] hideFeaturePanel"),t.parent===e?(t.active=!1,e.active=!0):(e.active=!0,t.active=!1))},o}(_))||v);o._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_LuckyWheel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./LuckyWheelRotator.ts","./index83.ts","./soundDefine21.ts"],(function(e){var o,t,n,r,i,u,a,c,l;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,r=e.sp,i=e.Node},function(e){u=e.BaseComponent},function(e){a=e.LuckyWheelRotator},function(e){c=e.moneyComing_Audio},function(e){l=e.SoundPathDefine}],execute:function(){var s;t._RF.push({},"14404rPkqdIX447vdvVabHH","MoneyComing_LuckyWheel",void 0);var p=n.ccclass;n.property,e("MoneyComing_LuckyWheel",p("MoneyComing_LuckyWheel")(s=function(e){function t(){for(var o,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(o=e.call.apply(e,[this].concat(n))||this).rotators=[],o.propertyNode={props_lucky_wheel_1_5_10:new i,props_lucky_wheel_50_100:new i},o.props={betAmount:1},o.events={},o}o(t,e);var n=t.prototype;return n.bindEvent=function(){},n.initState=function(){return{}},n.bindUI=function(){this.initRotators(),console.log("[LuckyWheel] bindUI: forcing initial update with betAmount=",this.props.betAmount),this.updateWheelState(this.props.betAmount)},n.initRotators=function(){var e=this;[this.propertyNode.props_lucky_wheel_1_5_10,this.propertyNode.props_lucky_wheel_50_100].forEach((function(o){if(o&&o.isValid){["money","money_upgrade","money_bg"].forEach((function(t){var n=o.getChildByName(t);if(n){var r=n.getComponent(a);r||(r=n.addComponent(a)),r.autoStart=!0,r.rotationSpeed=-10,r.startRotation(),e.rotators.push(r)}}))}}))},n.useProps=function(e,o){console.log("[LuckyWheel] useProps: key="+e+", pre="+o.pre+", cur="+o.cur),"betAmount"===e&&this.updateWheelState(o.cur)},n.updateWheelState=function(e){console.log("[LuckyWheel] updateWheelState: betAmount="+e),this.rotators.forEach((function(o){return o.betAmount=e}));var o=this.propertyNode.props_lucky_wheel_1_5_10,t=this.propertyNode.props_lucky_wheel_50_100;console.log("[LuckyWheel] Nodes: 1_5_10="+(null==o?void 0:o.name)+", 50_100="+(null==t?void 0:t.name)),o&&t&&(-1!==[1,5,10].indexOf(e)?(console.log("[LuckyWheel] Showing 1_5_10"),o.active=!0,t.active=!1,this.updateWheelContent(o,e)):(console.log("[LuckyWheel] Showing 50_100"),o.active=!1,t.active=!0,this.updateWheelContent(t,e)))},n.updateWheelContent=function(e,o){var t=e.getChildByName("money"),n=e.getChildByName("money_upgrade"),r=e.getChildByName("money_bg"),i=!1;i=1===o||5===o||50===o;var u=0;if(r&&(u=r.eulerAngles.z),t&&(t.active=i,i&&r)){t.setRotationFromEuler(0,0,u);var c=t.getComponent(a);c&&c.setCurrentRotation(u)}if(n&&(n.active=!i,!i&&r)){n.setRotationFromEuler(0,0,u);var l=n.getComponent(a);l&&l.setCurrentRotation(u)}},n.spin=function(e,o){console.log("[LuckyWheel] spin: prizeIndex="+e),c.playOneShot(l.luckyWheel);var t=this.propertyNode.props_lucky_wheel_1_5_10.active?this.propertyNode.props_lucky_wheel_1_5_10:this.propertyNode.props_lucky_wheel_50_100;if(t){var n=t.getChildByName("wheel");if(n){var i=n.getComponent(r.Skeleton);i&&i.setAnimation(0,"common_run_start",!1)}}var u=90-45*e;if(u<0&&(u+=360),!t)return console.error("[LuckyWheel] No active wheel found"),void o();var s=[];if(["money","money_upgrade","money_bg"].forEach((function(e){var o=t.getChildByName(e);if(o&&o.active){var n=o.getComponent(a);n&&s.push(n)}})),0===s.length)return console.warn("[LuckyWheel] No active rotators found"),void o();var p=0;s.forEach((function(e){e.spinTo(u,6,(function(){++p===s.length&&o()}))}))},t}(u))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_Respin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts"],(function(e){var n,o,t,i,r,s,l,a,c,p,u,y,h,d;return{setters:[function(e){n=e.inheritsLoose},function(e){o=e.cclegacy,t=e._decorator,i=e.assetManager,r=e.SpriteFrame,s=e.Node,l=e.Layers,a=e.UIOpacity,c=e.Sprite,p=e.UITransform,u=e.Vec3,y=e.v3,h=e.tween},function(e){d=e.BaseComponent}],execute:function(){var f;o._RF.push({},"a3599MIjJJN/bQKZ+9K2205","MoneyComing_Respin",void 0);var m=t.ccclass;t.property,e("MoneyComing_Respin",m("MoneyComing_Respin")(f=function(e){function o(){for(var n,o=arguments.length,t=new Array(o),i=0;i<o;i++)t[i]=arguments[i];return(n=e.call.apply(e,[this].concat(t))||this).propertyNode={},n.props={betAmount:1},n.events={onFlyComplete:function(){}},n}n(o,e);var t=o.prototype;return t.initState=function(){return{}},t.bindEvent=function(){},t.useProps=function(e,n){},t.bindUI=function(){},t.playFlyAnimation=function(e){var n=this,o=this.node.getChildByPath("wheels_container/wheels_layout/wheel_frame/wheels/wheel_feature");if(!o)return console.error("[MoneyComing_Respin] Feature wheel node not found"),void this.events.onFlyComplete();for(var t=o,s=[],l=["wheels_container/wheels_layout/wheel_frame/wheels/wheel1","wheels_container/wheels_layout/wheel_frame/wheels/wheel2","wheels_container/wheels_layout/wheel_frame/wheels/wheel3"],a=1===e?2:3,c=0;c<a;c++){var p=this.node.getChildByPath(l[c]);p&&s.push(p)}if(0===s.length)return console.warn("[MoneyComing_Respin] No target wheels found"),void this.events.onFlyComplete();var u=0,y=s.length,h="moneyComing",d=i.getBundle(h);if(!d)return console.error("[MoneyComing_Respin] Bundle moneyComing not found"),void this.events.onFlyComplete();d.load(["cocos_lizi/fly/sybres_eft_str_02/spriteFrame","cocos_lizi/fly/sybres_eft_exp_04/spriteFrame"],r,(function(e,o){if(e)return console.error("[MoneyComing_Respin] Failed to load fly assets",e),void n.events.onFlyComplete();var i=o[0],r=o[1];s.forEach((function(e,o){n.playSingleFly(t,e,i,r,(function(){++u===y&&n.events.onFlyComplete()}))}))}))},t.playSingleFly=function(e,n,o,t,i){var r,d,f=new s("FlyEffectNode");f.layer=l.Enum.UI_2D;var m=f.addComponent(a),_=f.addComponent(c);_.spriteFrame=o,this.node.addChild(f);var v=e.getWorldPosition(),w=n.getWorldPosition(),g=(null==(r=this.node.getComponent(p))?void 0:r.convertToNodeSpaceAR(v))||new u,C=(null==(d=this.node.getComponent(p))?void 0:d.convertToNodeSpaceAR(w))||new u,F=y(g.x,g.y+500,0);f.setPosition(g),f.setScale(2,2,1),h(f).to(1,{position:C},{onUpdate:function(e,n){var o=n,t=g,i=F,r=C,s=(1-o)*(1-o)*t.x+2*o*(1-o)*i.x+o*o*r.x,l=(1-o)*(1-o)*t.y+2*o*(1-o)*i.y+o*o*r.y;f.setPosition(s,l,0)}}).call((function(){_.spriteFrame=t,h(f).to(.3,{scale:new u(8,8,1)}).start(),h(m).to(.1,{opacity:0}).call((function(){f.destroy(),i()})).start()})).start()},o}(d))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_StartUp.ts",["cc","./index83.ts"],(function(t){var n,e,c;return{setters:[function(t){n=t.cclegacy},function(t){e=t.startUp,c=t.stopGame}],execute:function(){n._RF.push({},"684abfx4RNH163jlrqRZBFm","MoneyComing_StartUp",void 0);t("default",(function(t){return e(t),function(){c()}}));n._RF.pop()}}}));

System.register("chunks:///_virtual/MoneyComing_Wheel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SymbolAnimator.ts"],(function(e){var t,i,n,o,s,l,r,a,h,m,c,p,u,y,b,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.createForOfIteratorHelperLoose,l=e.createClass},function(e){r=e.cclegacy,a=e._decorator,h=e.Node,m=e.instantiate,c=e.Layout,p=e.UITransform,u=e.Vec3,y=e.tween,b=e.Component},function(e){g=e.SymbolAnimator}],execute:function(){var C,_,d,f,S,v,E,W,w,N,I,Y,D,P,H,L,M,x,T,z,V;r._RF.push({},"f96714hkFBGA73VXVIiag4T","MoneyComing_Wheel",void 0);var F=a.ccclass,A=a.property,k=function(e){return e[e.IDLE=0]="IDLE",e[e.SPINNING=1]="SPINNING",e[e.DECELERATING=2]="DECELERATING",e[e.BOUNCING=3]="BOUNCING",e}(k||{});e("MoneyComing_Wheel",(C=F("MoneyComing_Wheel"),_=A(h),d=A({group:"Physics",tooltip:"最大速度（像素/秒）"}),f=A({group:"Physics",tooltip:"加速度（像素/秒²）"}),S=A({group:"Physics",tooltip:"减速时使用的缓动函数"}),v=A({group:"Physics",tooltip:"减速到停止的总时长"}),E=A({group:"Physics",tooltip:"回弹效果的缓动函数"}),W=A({group:"Physics",tooltip:"回弹效果的时长"}),C((I=t((N=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=e.call.apply(e,[this].concat(s))||this,n(t,"symbolContainer",I,o(t)),n(t,"symbolHeight",Y,o(t)),n(t,"wheelType",D,o(t)),n(t,"containerHeight",P,o(t)),n(t,"elementSpacing",H,o(t)),t.bundle=null,n(t,"maxSpeed",L,o(t)),n(t,"acceleration",M,o(t)),n(t,"decelerationEasing",x,o(t)),n(t,"decelerationDuration",T,o(t)),n(t,"bounceEasing",z,o(t)),n(t,"bounceDuration",V,o(t)),t._isSpinning=!1,t._onSpinComplete=null,t._targetElementName="",t._symbolCount=0,t._elementMap=new Map,t._originalSymbolCount=0,t._currentVisibleElements=[],t._spinState=k.IDLE,t._currentSpeed=0,t._targetY=0,t._stopCallback=null,t._loopHeight=0,t._startY=0,t}i(t,e);var r=t.prototype;return r.onLoad=function(){var e=this;if(this.symbolContainer||(this.symbolContainer=this.node.getChildByName("symbol_container")||this.node),this.symbolContainer){var t=[].concat(this.symbolContainer.children);if(this._originalSymbolCount=t.length,this._elementMap.clear(),t.forEach((function(t){e._elementMap.set(t.name,m(t))})),this._originalSymbolCount>1){for(var i=Math.min(3,this._originalSymbolCount),n=0;n<i;n++){var o=t[this._originalSymbolCount-1-n],s=m(o);this.symbolContainer.insertChild(s,0)}for(var l=0;l<i;l++){var r=t[l],a=m(r);this.symbolContainer.addChild(a)}}var h=this.symbolContainer.getComponent(c);h&&(h.updateLayout(),h.enabled=!1),this._symbolCount=this.symbolContainer.children.length,this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),console.log("[Wheel] 初始化完成，元素数量: "+this._symbolCount+", 原始元素数量: "+this._originalSymbolCount+", 模板数量: "+this._elementMap.size)}if(this.symbolHeight<=0&&this.symbolContainer&&this.symbolContainer.children.length>0){var u=this.symbolContainer.children[0].getComponent(p);u&&(this.symbolHeight=u.height)}this.resetToInitialPosition()},r.resetToInitialPosition=function(){if(this.symbolContainer&&0!==this.symbolContainer.children.length){var e=(this._symbolCount-this._originalSymbolCount)/2,t=this.symbolContainer.children[e];if(!t){var i=this.symbolContainer.children[0].position.y;return this.symbolContainer.position=new u(this.symbolContainer.position.x,-i,0),void console.warn("[Wheel] 无法找到第一个原始元素，已重置到第一个可用元素。")}var n=t.position.y;this._startY=-n,this.symbolContainer.position=new u(this.symbolContainer.position.x,this._startY,0)}},r.startSpin=function(e,t,i){if(void 0===e&&(e=""),y(this.symbolContainer).stop(),!this._isSpinning){if(0===this._originalSymbolCount)return console.warn("[Wheel] 滚轮中没有元素，无法启动"),void(i&&i(""));this._isSpinning=!0,this._spinState=k.SPINNING,this._currentSpeed=this.maxSpeed,this._onSpinComplete=i||null,this._targetElementName=e}},r.stop=function(e,t,i){if(console.log('[Wheel] stop called: targetElementName="'+e+'", wheelType='+this.wheelType),!this._isSpinning||this._spinState!==k.SPINNING)return console.log("[Wheel] stop: 滚轮未在滚动状态，直接回调"),void(t&&t());this._targetElementName=e,this._stopCallback=t||null;for(var n,o=null,l=[],r=this.symbolContainer.position.y,a=.2*this.maxSpeed,h=this._startY-this._loopHeight+a,m=this._startY-a,c=s(this.symbolContainer.children);!(n=c()).done;){var p=n.value;if(p.name.replace(/-clone.*$/,"")===e){var y=-p.position.y,b=y-r;b<0&&(b+=this._loopHeight),l.push({node:p,distance:b,targetY:y})}}if(l.length>0){var g=l.filter((function(e){return e.targetY>h&&e.targetY<m}));g.length>0?(g.sort((function(e,t){return e.distance-t.distance})),o=g[0].node,console.log("[Wheel] 选择安全范围内的目标: targetY="+g[0].targetY.toFixed(2)+", 安全范围: ("+h.toFixed(2)+", "+m.toFixed(2)+")")):(l.sort((function(e,t){return e.distance-t.distance})),o=l[0].node,console.warn("[Wheel] 警告：没有安全范围内的目标，选择最近的: targetY="+l[0].targetY.toFixed(2)))}if(console.log('[Wheel] stop: 从 symbolContainer.children 查找 "'+e+'": '+!!o),o)this._targetY=-o.position.y,console.log('[Wheel] stop: 找到最佳目标元素 "'+e+'" at y='+o.position.y);else{var C=this.getClosestElement();if(C){var _=C.position.y;this._targetY=-_+this.symbolHeight/2+this.elementSpacing/2,console.log("[Wheel] stop: 目标元素 '"+e+"' 未找到，将停在元素之间, targetY="+this._targetY)}else this._targetY=this.symbolContainer.position.y,console.warn("[Wheel] stop: 无法找到任何元素，使用当前位置")}this._spinState=k.IDLE,this.symbolContainer.position=new u(this.symbolContainer.position.x,this._targetY,0),this._onSpinFinished()},r.update=function(e){if(this._spinState===k.SPINNING){this._currentSpeed<this.maxSpeed&&(this._currentSpeed+=this.acceleration*e,this._currentSpeed>this.maxSpeed&&(this._currentSpeed=this.maxSpeed));var t=this.symbolContainer.position.y-this._currentSpeed*e;if(this._originalSymbolCount>1&&this._loopHeight>0)t<this._startY-this._loopHeight&&(t+=this._loopHeight);this.symbolContainer.position=new u(this.symbolContainer.position.x,t,0)}},r._onSpinFinished=function(){this._isSpinning=!1,this._spinState=k.IDLE,this.symbolContainer.position=new u(this.symbolContainer.position.x,this._targetY,0),console.log("[Wheel] _onSpinFinished: targetElementName="+this._targetElementName+", finalY="+this._targetY);var e=this.getDisplayedElement();e?console.log("[Wheel] _onSpinFinished: 实际显示的元素="+e.name+", elementY="+e.position.y+", containerY="+this.symbolContainer.position.y):console.warn("[Wheel] _onSpinFinished: 未找到显示的元素"),this._stopCallback&&(this._stopCallback(),this._stopCallback=null),this._onSpinComplete&&(this._onSpinComplete(this._targetElementName),this._onSpinComplete=null)},r.getDisplayedElement=function(){return this._targetElementName&&""!==this._targetElementName?this.findDisplayedElement(this._targetElementName):null},r.findDisplayedElement=function(e){if(!this.symbolContainer)return console.warn("[Wheel] symbolContainer 为空"),null;console.log('[Wheel] findDisplayedElement: 查找元素 "'+e+'", symbolContainer 子节点数: '+this.symbolContainer.children.length);for(var t,i=[],n=s(this.symbolContainer.children);!(t=n()).done;){var o=t.value;i.push(o.name)}console.log("[Wheel] symbolContainer 所有子节点: ["+i.join(", ")+"]");for(var l,r=null,a=1/0,h=s(this.symbolContainer.children);!(l=h()).done;){var m=l.value;if(m.name.replace(/-clone.*$/,"")===e){var c=m.position.y,p=this.symbolContainer.position.y,u=Math.abs(p+c);console.log("[Wheel] 找到匹配元素: "+m.name+", elementY="+c+", containerY="+p+", distance="+u),u<a&&(a=u,r=m)}}return r?(console.log("[Wheel] 选择最近的元素: "+r.name+", distance="+a),r):(console.warn('[Wheel] 未找到名称为 "'+e+'" 的元素节点'),null)},r.showResult=function(e){y(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=k.IDLE,this._currentSpeed=0;var t=0,i=this._elementMap.get(e);if(i)t=-i.position.y;else{var n=this.getClosestElement();if(n)t=-n.position.y+this.symbolHeight/2+this.elementSpacing/2;else t=this.symbolContainer.position.y}if(this.symbolContainer.position=new u(this.symbolContainer.position.x,t,0),this._targetElementName=e,this._targetY=t,e&&""!==e&&this.bundle){var o=this.findDisplayedElement(e);if(o){console.log("[Wheel] Turbo 模式播放动画 for "+e);var s=o.getWorldPosition();g.playAnimationAt(this.node,s,e,this.bundle)}}},r.reset=function(){y(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=k.IDLE,this.resetToInitialPosition()},r.getCurrentElementName=function(){return this.getClosestElement().name},r.getClosestElement=function(){for(var e,t=this.symbolContainer.position.y,i=null,n=1/0,o=s(this.symbolContainer.children);!(e=o()).done;){var l=e.value,r=l.position.y,a=Math.abs(t+r);a<n&&(n=a,i=l)}return i},r.setVisibleElements=function(e){var t=this;if(console.log("[Wheel setVisibleElements] 被调用. Wheel Type: "+this.wheelType),console.log("[Wheel setVisibleElements] 当前可见元素 (_currentVisibleElements): ["+this._currentVisibleElements.join(", ")+"]"),console.log("[Wheel setVisibleElements] 新的可见元素 (visibleElements): ["+e.join(", ")+"]"),this.symbolContainer)if(0!==this._elementMap.size){0===e.length&&(e=Array.from(this._elementMap.keys()));var i=this._currentVisibleElements.length===e.length&&this._currentVisibleElements.every((function(t,i){return t===e[i]}));if(console.log("[Wheel setVisibleElements] 列表是否相同 (isSameElements): "+i),i)console.log("[Wheel] 可见元素列表未变化，跳过重建");else{this._spinState,k.IDLE;var n=this.symbolContainer.position.clone();y(this.symbolContainer).stop(),this._isSpinning=!1,this._spinState=k.IDLE;var o=this.symbolContainer.active;if(this.symbolContainer.active=!1,this.symbolContainer.removeAllChildren(),e.forEach((function(e){var i=t._elementMap.get(e);if(i){var n=m(i);t.symbolContainer.addChild(n)}else console.error('[Wheel] setVisibleElements: 无法找到元素 "'+e+'"。请确保场景/Prefab中的 symbol_container 包含名为 "'+e+'" 的子节点！')})),this._originalSymbolCount=this.symbolContainer.children.length,0!==this._originalSymbolCount){if(this._originalSymbolCount>1){for(var s=[].concat(this.symbolContainer.children),l=Math.min(3,this._originalSymbolCount),r=0;r<l;r++){var a=s[this._originalSymbolCount-1-r],h=m(a);this.symbolContainer.insertChild(h,0)}for(var p=0;p<l;p++){var u=s[p],b=m(u);this.symbolContainer.addChild(b)}}this._symbolCount=this.symbolContainer.children.length;var g=this.symbolContainer.getComponent(c);g&&(g.enabled=!1),this._manuallyLayoutChildren(),this._finalizePositionAfterRebuild(n,o),this._originalSymbolCount>0&&(this._loopHeight=this.elementSpacing*(this._originalSymbolCount-1)+this.symbolHeight),this._currentVisibleElements=[].concat(e),console.log("[Wheel] 设置可见元素: ["+e.join(", ")+"]，总计 "+this._symbolCount+" 个节点")}else console.warn("[Wheel] 设置可见元素后没有任何元素，visibleElements: ["+e.join(", ")+"]")}}else console.warn("[Wheel] _elementMap 为空，等待 onLoad 完成后再调用");else console.warn("[Wheel] symbolContainer 未初始化")},r._manuallyLayoutChildren=function(){if(this.symbolContainer&&0!==this.symbolContainer.children.length){for(var e=0,t=0;t<this.symbolContainer.children.length;t++){var i=this.symbolContainer.children[t];0===t?e=0:e-=this.symbolHeight+this.elementSpacing,i.setPosition(0,e,0)}console.log("[Wheel] 手动布局完成，共 "+this.symbolContainer.children.length+" 个子节点")}},r._finalizePositionAfterRebuild=function(e,t){if(void 0===t&&(t=!0),e&&this._currentVisibleElements.length>0){var i=(this._symbolCount-this._originalSymbolCount)/2,n=this.symbolContainer.children[i];if(n){var o=n.position.y;this._startY=-o,console.log("[Wheel] 重建后重新计算 _startY = "+this._startY),this.resetToInitialPosition(),console.log("[Wheel] 切换投注金额后重置到初始位置，确保不抖动")}else this.resetToInitialPosition()}else this.resetToInitialPosition();this.symbolContainer.active=t},l(t,[{key:"isSpinning",get:function(){return this._isSpinning}}]),t}(b)).prototype,"symbolContainer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(N.prototype,"symbolHeight",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 166}}),D=t(N.prototype,"wheelType",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"coin"}}),P=t(N.prototype,"containerHeight",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 316}}),H=t(N.prototype,"elementSpacing",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),L=t(N.prototype,"maxSpeed",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4e3}}),M=t(N.prototype,"acceleration",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3e3}}),x=t(N.prototype,"decelerationEasing",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"quadOut"}}),T=t(N.prototype,"decelerationDuration",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),z=t(N.prototype,"bounceEasing",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),V=t(N.prototype,"bounceDuration",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),w=N))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/moneyComingScript",["./MoneyComing_StartUp.ts","./Standalone.ts","./BetSelection.ts","./LuckyWheelRotator.ts","./MoneyComing_GameMain.ts","./MoneyComing_LuckyWheel.ts","./MoneyComing_Respin.ts","./MoneyComing_Wheel.ts","./config20.ts","./index83.ts","./socketConnect20.ts","./index81.ts","./prefabDefine21.ts","./soundDefine21.ts","./game37.ts","./index80.ts","./index82.ts","./type19.ts","./AnimationUtils.ts","./SymbolAnimator.ts","./AnimationViewModel.ts","./GameMainViewModel2.ts","./LuckyWheelViewModel.ts","./RespinViewModel.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/prefabDefine21.ts",["cc","./SourceManage.ts"],(function(e){var n,r,t;return{setters:[function(e){n=e.cclegacy,r=e.Prefab},function(e){t=e.loopFiles}],execute:function(){n._RF.push({},"cdbe4QsFEVMwrlG434WG6Xp","prefabDefine",void 0);var f=e("PrefabPathDefine",function(e){return e.LOAING_PANEL="prefabs/prefab_moneyComing_loading",e.GAME_MAIN="prefabs/MoneyComingView",e}({}));e("default",(function(e){return t(e,r,f)}));n._RF.pop()}}}));

System.register("chunks:///_virtual/RespinViewModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewModel.ts","./index80.ts","./index83.ts","./soundDefine21.ts"],(function(e){var n,t,i,o,a,s,r,p,u,l;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){o=e.cclegacy,a=e._decorator},function(e){s=e.StoreInject,r=e.default},function(e){p=e.getStore},function(e){u=e.moneyComing_Audio},function(e){l=e.SoundPathDefine}],execute:function(){var m;o._RF.push({},"f8dcdnlnTtEgYLs8Y177lIp","RespinViewModel",void 0);var c=a.ccclass;e("RespinViewModel",s(p())(m=c("RespinViewModel")(m=function(e){function o(){var n;return(n=e.call(this,"MoneyComing_Respin")||this).gameMainComp=null,n}n(o,e);var a=o.prototype;return a.begin=function(){},a.connect=function(){return this.inject({},(function(e){return{betAmount:e.betAmount}})),this},a.setGameMain=function(e){this.gameMainComp=e},a.handleAllRespin=function(){var e=t(i().mark((function e(n,t){var o,a,s,r,p,m,c,h,f,g,d=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log("[RespinViewModel] handleAllRespin started"),o="",a=1===this.comp.props.betAmount?2:3,s=0;s<a;s++)(r=n[s])&&r.startsWith("element_")&&(o+=r.replace("element_",""));if(p=""===o||isNaN(parseInt(o,10))?0:parseInt(o,10),this.gameMainComp&&(this.gameMainComp.showFeaturePanel(p,"all_respin",this.comp.props.betAmount),u.playOneShot(l.activeFeature)),this.gameMainComp&&this.gameMainComp.playFeatureSymbolAnimation("feature_all_respin"),u.playOneShot(l.allRespin),u.playOneShot(l.allRespinScatter),!this.comp){e.next=12;break}return e.next=12,new Promise((function(e){d.comp.playFlyAnimation(d.comp.props.betAmount),setTimeout(e,1500)}));case 12:return this.gameMainComp&&(u.playOneShot(l.spin),this.gameMainComp.startRespin()),e.next=15,new Promise((function(e){return setTimeout(e,2e3)}));case 15:if(m=this.generateRespinResults(this.comp.props.betAmount),!this.gameMainComp){e.next=19;break}return e.next=19,new Promise((function(e){d.gameMainComp.stopRespin(m,e)}));case 19:for(c="",h=0;h<a;h++)(f=m[h])&&f.startsWith("element_")&&(c+=f.replace("element_",""));return g=""===c||isNaN(parseInt(c,10))?0:parseInt(c,10),this.gameMainComp&&this.gameMainComp.updateFeatureBonus(g),e.next=25,new Promise((function(e){return setTimeout(e,1e3)}));case 25:this.gameMainComp&&this.gameMainComp.hideFeaturePanel(),console.log("[RespinViewModel] handleAllRespin completed"),t(m);case 28:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),a.generateRespinResults=function(e){var n=["element_0","element_00","element_1","element_5","element_10"],t=function(){return n[Math.floor(Math.random()*n.length)]};return[t(),t(),1===e?"":t(),"feature_all_respin"]},o}(r))||m)||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/socketConnect20.ts",["cc"],(function(n){var o;return{setters:[function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"2f393RnampFrJaP9qGy4476","socketConnect",void 0);var e=n("SKT_MAG_TYPE",function(n){return n.LOGIN="1",n.JOIN_ROOM="2",n.SPIN="3",n.EXIT_GAME="15",n}({})),t=n("moneyComingWebSocketDriver",null);n("default",(function(){return new Promise((function(o,e){console.log("[MoneyComing] Mocking WebSocket connection..."),o(t=n("moneyComingWebSocketDriver",{loginGame:function(n){return console.log("[MoneyComing] Mock loginGame called"),{bindReceiveHandler:function(n){console.log("[MoneyComing] Mock login response"),setTimeout((function(){n({data:{success:!0,data:{}}})}),100)},bindTimeoutHandler:function(n){return!0}}},logoutGame:function(n){console.log("[MoneyComing] Mock logoutGame called")},filterData:function(n,o){return{data:n,error:void 0}},sktMsgListener:{add:function(n,o,e){console.log("[MoneyComing] Mock sktMsgListener.add: "+n+", "+o)},remove:function(n,o){console.log("[MoneyComing] Mock sktMsgListener.remove: "+n+", "+o)}}}))}))})),n("moneyComingGameLogin",(function(){t.loginGame(e.LOGIN)})),n("removeInstance",(function(){}));o._RF.pop()}}}));

System.register("chunks:///_virtual/soundDefine21.ts",["cc","./SourceManage.ts"],(function(e){var u,n,i;return{setters:[function(e){u=e.cclegacy,n=e.AudioClip},function(e){i=e.loopFiles}],execute:function(){u._RF.push({},"61a73HYA9FA5p8MDYZOD9uS","soundDefine",void 0);var o=e("SoundPathDefine",function(e){return e.bg="audio/music/bg",e.luckyWheel="audio/sound/lucky_wheel",e.activeFeature="audio/sound/active_feature",e.wheelLock="audio/sound/wheel_lock",e.spinOver="audio/sound/spin_over",e.feature="audio/sound/feature",e.allRespin="audio/sound/all_respin",e.number="audio/sound/number",e.bigWin="audio/sound/big_win",e.scatterOver="audio/sound/scatter_over",e.allRespinScatter="audio/sound/all_respin_scatter",e.spin="audio/sound/spin",e}({}));e("default",(function(e){return i(e,n,o)}));u._RF.pop()}}}));

System.register("chunks:///_virtual/Standalone.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index83.ts"],(function(n){var o,t,e,c,r;return{setters:[function(n){o=n.inheritsLoose},function(n){t=n.cclegacy,e=n._decorator,c=n.Component},function(n){r=n.startUp}],execute:function(){var a;t._RF.push({},"88f01wTsydB14SNKO9+WU5c","Standalone",void 0);var i=e.ccclass;e.property,n("Standalone",i("Standalone")(a=function(n){function t(){return n.apply(this,arguments)||this}return o(t,n),t.prototype.start=function(){window.HALL_GLOBAL||(window.HALL_GLOBAL={hallDispatch:function(n){return console.log("Mock Dispatch:",n)},addToast:function(n){return console.log("Mock Toast:",n)},setLoading:function(n){return console.log("Mock Loading:",n)},setSubGameRunState:function(n){return console.log("Mock State:",n)},isAllowOpenSubGame:function(){return!0},closeSubGame:function(){return console.log("Mock Close SubGame")},lang:{write:function(n,o,t){return"Mock String"}},getGameConfig:function(n){return{md5:"DEV_VERSION"}},wsInstance:{}}),console.log("Standalone mode: Starting MoneyComing..."),r(this.node)},t}(c))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/SymbolAnimator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,n,t,s,i,l,a,r,m;return{setters:[function(e){o=e.inheritsLoose,n=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy,s=e._decorator,i=e.assetManager,l=e.sp,a=e.Node,r=e.UITransform,m=e.Component}],execute:function(){var y,_;t._RF.push({},"02413jRgrVEg7SfoDiim3WK","SymbolAnimator",void 0);var c=s.ccclass;e("SymbolAnimator",c("SymbolAnimator")(((_=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.playAnimationAt=function(e,o,n,t,s,m){void 0===s&&(s=!1),void 0===m&&(m=1),console.log("[SymbolAnimator] playAnimationAt for "+n);var y=this.SPINE_PATH_MAP.get(n);if(y){var _=i.getBundle(t);_?_.load(y,l.SkeletonData,(function(t,i){if(!t&&e&&e.isValid){var _=new a("spine_anim_"+n+"_"+Date.now());e.addChild(_);var c=e.getComponent(r).convertToNodeSpaceAR(o);_.setPosition(c),_.layer=e.layer;var p=_.addComponent(l.Skeleton);p.skeletonData=i,p.premultipliedAlpha=!0,p.timeScale=m;var b="animation";p.findAnimation(b)?(p.setAnimation(0,b,s),s||p.setCompleteListener((function(){_&&_.isValid&&_.destroy()}))):(console.warn("[SymbolAnimator] spine 资源 "+y+" 中未找到名为 'animation' 的动画"),_.destroy())}else console.error("[SymbolAnimator] 加载 spine 资源失败或父节点已销毁: "+y,t)})):console.error("[SymbolAnimator] 无法获取 bundle: "+t)}else console.warn("[SymbolAnimator] 元素 "+n+" 没有对应的 spine 动画")},t.stopAllAnimations=function(e){if(e&&e.isValid){for(var o,t=[].concat(e.children),s=n(t);!(o=s()).done;){var i=o.value;i.name.startsWith("spine_anim_")&&i.destroy()}console.log("[SymbolAnimator] 停止并销毁了 "+e.name+" 下的所有符号动画节点")}},t}(m)).SPINE_PATH_MAP=new Map([["element_0","spine/symbol/symbol_0"],["element_00","spine/symbol/symbol_00"],["element_1","spine/symbol/symbol_1"],["element_5","spine/symbol/symbol_5"],["element_10","spine/symbol/symbol_10"],["feature_x2","spine/symbol/symbol_2x"],["feature_x5","spine/symbol/symbol_5x"],["feature_x10","spine/symbol/symbol_10x"],["feature_all_respin","spine/symbol/symbol_all"],["feature_scatter","spine/symbol/symbol_scatter"],["feature_scatter_50_100","spine/symbol/symbol_scatter_red"]]),y=_))||y);t._RF.pop()}}}));

System.register("chunks:///_virtual/type19.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"4902aWhmWpM944EXJQ2Mzp8","type",void 0),t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/moneyComingScript', 'chunks:///_virtual/moneyComingScript'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});